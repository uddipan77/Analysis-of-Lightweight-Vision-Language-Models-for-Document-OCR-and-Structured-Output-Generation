### Starting TaskPrologue of job 1521500 on tg097 at Sun Feb  1 06:52:12 AM CET 2026
Running on cores 96-127 with governor ondemand
Sun Feb  1 06:52:12 2026       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 580.126.09             Driver Version: 580.126.09     CUDA Version: 13.0     |
+-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-40GB          On  |   00000000:C1:00.0 Off |                    0 |
| N/A   37C    P0             55W /  400W |       0MiB /  40960MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
### Finished TaskPrologue

ðŸ¦¥ Unsloth: Will patch your computer to enable 2x faster free finetuning.
ðŸ¦¥ Unsloth Zoo will now patch everything to make training faster!
Created run directory: /home/vault/iwi5/iwi5298h/models_image_text/gemma/inventory_dataset/run_A100_genCER_20260201_065249

============================================================
GEMMA-3 INVENTORY - BEST BY AUTOREGRESSIVE GEN-CER (SAVE ONLY ONE)
============================================================
Loading Gemma-3 vision model with Unsloth for INVENTORY...
Temporary directory for augmented images: /tmp/1521500.tinygpu/inventory_gemma_aug_q30e5gb_
Augmentation factor (per original image): 1
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Gemma3 patching. Transformers: 4.51.3.
   \\   /|    NVIDIA A100-SXM4-40GB. Num GPUs = 1. Max memory: 39.493 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 8.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Gemma3 does not support SDPA - switching to eager!
Model loaded - Unsloth auto-configured dtype and attention
Unsloth: Making `base_model.model.vision_tower.vision_model` require gradients
Gemma-3 vision model loaded with A100-optimized LoRA config

============================================================
STARTING TRAINING (A100-OPTIMIZED, INVENTORY)
============================================================
Preparing training and validation datasets for INVENTORY...
Preparing INVENTORY TRAIN data with augmentation factor = 1
Training: 426 samples (original: 213, augmented: 213)
Validation/Test: 47 valid samples out of 47 total (no augmentation)
Training: 426 samples, Validation: 47 samples
[GenCER Callback] Fixed val subset size = 47
GPU = NVIDIA A100-SXM4-40GB. Max memory = 39.493 GB.
4.809 GB of memory reserved.
Starting training (best checkpoint selected by autoregressive gen-CER)...
{'loss': 79.1492, 'grad_norm': 712.9851684570312, 'learning_rate': 0.0, 'epoch': 0.04}
{'loss': 79.7022, 'grad_norm': 873.4603881835938, 'learning_rate': 1.2000000000000002e-06, 'epoch': 0.19}
{'loss': 78.6275, 'grad_norm': 4130.453125, 'learning_rate': 2.7e-06, 'epoch': 0.38}
{'loss': 70.5314, 'grad_norm': 1025.081787109375, 'learning_rate': 4.2000000000000004e-06, 'epoch': 0.56}
{'loss': 60.7146, 'grad_norm': 239.41468811035156, 'learning_rate': 5.7000000000000005e-06, 'epoch': 0.75}
{'loss': 52.6775, 'grad_norm': 190.1066131591797, 'learning_rate': 7.2e-06, 'epoch': 0.94}
{'eval_loss': 2.9102418422698975, 'eval_runtime': 23.7584, 'eval_samples_per_second': 1.978, 'eval_steps_per_second': 1.978, 'epoch': 1.0}

[GenCER Callback] Epoch 1.00 gen_cer = 0.6191 (61.91%)
{'loss': 42.966, 'grad_norm': 116.05229949951172, 'learning_rate': 8.7e-06, 'epoch': 1.11}
{'loss': 41.2547, 'grad_norm': 117.06674194335938, 'learning_rate': 1.02e-05, 'epoch': 1.3}
{'loss': 36.5342, 'grad_norm': 99.87944030761719, 'learning_rate': 1.1700000000000001e-05, 'epoch': 1.49}
{'loss': 32.4621, 'grad_norm': 77.3304214477539, 'learning_rate': 1.32e-05, 'epoch': 1.68}
{'loss': 28.0756, 'grad_norm': 141.78875732421875, 'learning_rate': 1.47e-05, 'epoch': 1.86}
{'eval_loss': 1.6569639444351196, 'eval_runtime': 23.3129, 'eval_samples_per_second': 2.016, 'eval_steps_per_second': 2.016, 'epoch': 2.0}

[GenCER Callback] Epoch 2.00 gen_cer = 0.3361 (33.61%)
{'loss': 24.4382, 'grad_norm': 44.319026947021484, 'learning_rate': 1.62e-05, 'epoch': 2.04}
{'loss': 25.6785, 'grad_norm': 37.23885726928711, 'learning_rate': 1.77e-05, 'epoch': 2.23}
{'loss': 25.1164, 'grad_norm': 31.4205322265625, 'learning_rate': 1.9200000000000003e-05, 'epoch': 2.41}
{'loss': 23.5905, 'grad_norm': 36.34217834472656, 'learning_rate': 2.07e-05, 'epoch': 2.6}
{'loss': 24.3519, 'grad_norm': 36.292152404785156, 'learning_rate': 2.22e-05, 'epoch': 2.79}
{'loss': 23.1473, 'grad_norm': 33.01783752441406, 'learning_rate': 2.37e-05, 'epoch': 2.98}
{'eval_loss': 1.4756791591644287, 'eval_runtime': 23.3429, 'eval_samples_per_second': 2.013, 'eval_steps_per_second': 2.013, 'epoch': 3.0}

[GenCER Callback] Epoch 3.00 gen_cer = 0.2490 (24.90%)
{'loss': 20.4546, 'grad_norm': 25.529972076416016, 'learning_rate': 2.52e-05, 'epoch': 3.15}
{'loss': 21.9564, 'grad_norm': 28.932119369506836, 'learning_rate': 2.6700000000000002e-05, 'epoch': 3.34}
{'loss': 22.4316, 'grad_norm': 30.811071395874023, 'learning_rate': 2.8199999999999998e-05, 'epoch': 3.53}
{'loss': 21.138, 'grad_norm': 30.40481185913086, 'learning_rate': 2.97e-05, 'epoch': 3.71}
{'loss': 21.1216, 'grad_norm': 30.483644485473633, 'learning_rate': 2.9985919533659653e-05, 'epoch': 3.9}
{'eval_loss': 1.4395374059677124, 'eval_runtime': 23.1247, 'eval_samples_per_second': 2.032, 'eval_steps_per_second': 2.032, 'epoch': 4.0}

[GenCER Callback] Epoch 4.00 gen_cer = 0.2161 (21.61%)
{'loss': 19.3817, 'grad_norm': 31.041465759277344, 'learning_rate': 2.992876294154013e-05, 'epoch': 4.08}
{'loss': 20.0656, 'grad_norm': 33.94532012939453, 'learning_rate': 2.9827817715520775e-05, 'epoch': 4.26}
{'loss': 19.9563, 'grad_norm': 25.717775344848633, 'learning_rate': 2.968337994534213e-05, 'epoch': 4.45}
{'loss': 18.9953, 'grad_norm': 36.5102424621582, 'learning_rate': 2.9495873291870436e-05, 'epoch': 4.64}
{'loss': 19.0505, 'grad_norm': 27.553415298461914, 'learning_rate': 2.9265847744427305e-05, 'epoch': 4.83}
{'loss': 17.5886, 'grad_norm': 27.36890411376953, 'learning_rate': 2.8993978007576263e-05, 'epoch': 5.0}
{'eval_loss': 1.4576932191848755, 'eval_runtime': 23.1524, 'eval_samples_per_second': 2.03, 'eval_steps_per_second': 2.03, 'epoch': 5.0}

[GenCER Callback] Epoch 5.00 gen_cer = 0.2361 (23.61%)
{'loss': 18.3855, 'grad_norm': 29.14501190185547, 'learning_rate': 2.868106152209805e-05, 'epoch': 5.19}
{'loss': 17.5887, 'grad_norm': 37.250492095947266, 'learning_rate': 2.832801612595937e-05, 'epoch': 5.38}
{'loss': 17.4629, 'grad_norm': 28.10629653930664, 'learning_rate': 2.793587736213603e-05, 'epoch': 5.56}
{'loss': 17.028, 'grad_norm': 43.41387176513672, 'learning_rate': 2.7505795441186953e-05, 'epoch': 5.75}
{'loss': 17.061, 'grad_norm': 33.915496826171875, 'learning_rate': 2.703903186748843e-05, 'epoch': 5.94}
{'eval_loss': 1.5197927951812744, 'eval_runtime': 23.0979, 'eval_samples_per_second': 2.035, 'eval_steps_per_second': 2.035, 'epoch': 6.0}

[GenCER Callback] Epoch 6.00 gen_cer = 0.2494 (24.94%)
{'loss': 15.5015, 'grad_norm': 33.558143615722656, 'learning_rate': 2.6536955739024436e-05, 'epoch': 6.11}
{'loss': 16.3041, 'grad_norm': 43.924034118652344, 'learning_rate': 2.6001039731586335e-05, 'epoch': 6.3}
{'loss': 15.9351, 'grad_norm': 38.73147964477539, 'learning_rate': 2.543285577916108e-05, 'epoch': 6.49}
{'loss': 15.7726, 'grad_norm': 44.484073638916016, 'learning_rate': 2.4834070463177942e-05, 'epoch': 6.68}
{'loss': 15.4798, 'grad_norm': 34.016563415527344, 'learning_rate': 2.4206440124138064e-05, 'epoch': 6.86}
{'eval_loss': 1.5824651718139648, 'eval_runtime': 23.2646, 'eval_samples_per_second': 2.02, 'eval_steps_per_second': 2.02, 'epoch': 7.0}

[GenCER Callback] Epoch 7.00 gen_cer = 0.2592 (25.92%)
{'train_runtime': 18987.3088, 'train_samples_per_second': 0.337, 'train_steps_per_second': 0.021, 'train_loss': 28.304974207802424, 'epoch': 7.0}

=== BEST CHECKPOINT INFO ===
Best checkpoint: /home/vault/iwi5/iwi5298h/models_image_text/gemma/inventory_dataset/run_A100_genCER_20260201_065249/checkpoint-108
Best metric (gen_cer): 0.21611233561162715

Saving ONLY best model to: /home/vault/iwi5/iwi5298h/models_image_text/gemma/inventory_dataset/run_A100_genCER_20260201_065249/best_model_gen_cer

Cleaning up: removing checkpoint-* folders (keeping only best_model_gen_cer)...
18987.3088 seconds used for training.
Peak reserved memory = 9.291 GB (23.526%).

Best model already saved (ONLY ONE) at: /home/vault/iwi5/iwi5298h/models_image_text/gemma/inventory_dataset/run_A100_genCER_20260201_065249/best_model_gen_cer

============================================================
STARTING EVALUATION ON INVENTORY TEST.JSONL
============================================================
Starting evaluation on INVENTORY test.jsonl with aggressive chunking...
Loaded 48 test samples

============================================================
Chunk 1/10 (5 images)
============================================================

[1/48] Processing: inventarbuch-022.jpg
  âœ… CER: 0.2480 (24.80%)

[2/48] Processing: inventarbuch-099.jpg
  âœ… CER: 0.1406 (14.06%)

[3/48] Processing: inventarbuch-245.jpg
  âœ… CER: 0.2104 (21.04%)

[4/48] Processing: inventarbuch-263.jpg
  âœ… CER: 0.1431 (14.31%)

[5/48] Processing: inventarbuch-033.jpg
  âœ… CER: 0.2976 (29.76%)

Chunk 1 completed. Cleaning memory...

============================================================
Chunk 2/10 (5 images)
============================================================

[6/48] Processing: inventarbuch-143.jpg
  âœ… CER: 0.1778 (17.78%)

[7/48] Processing: inventarbuch-244.jpg
  âœ… CER: 0.3576 (35.76%)

[8/48] Processing: inventarbuch-024.jpg
  âœ… CER: 0.0956 (9.56%)

[9/48] Processing: inventarbuch-141.jpg
  âœ… CER: 0.1545 (15.45%)

[10/48] Processing: inventarbuch-183.jpg
  âœ… CER: 0.4368 (43.68%)

Chunk 2 completed. Cleaning memory...

============================================================
Chunk 3/10 (5 images)
============================================================

[11/48] Processing: inventarbuch-191.jpg
  âœ… CER: 0.2086 (20.86%)

[12/48] Processing: inventarbuch-051.jpg
  âœ… CER: 0.0880 (8.80%)

[13/48] Processing: inventarbuch-203.jpg
  âœ… CER: 0.1778 (17.78%)

[14/48] Processing: inventarbuch-296.jpg
  âœ… CER: 0.2164 (21.64%)

[15/48] Processing: inventarbuch-302.jpg
  âœ… CER: 0.0839 (8.39%)

Chunk 3 completed. Cleaning memory...
Saved intermediate results to: /home/vault/iwi5/iwi5298h/models_image_text/gemma/inventory_dataset/run_A100_genCER_20260201_065249/test_predictions_chunk_3.jsonl

============================================================
Chunk 4/10 (5 images)
============================================================

[16/48] Processing: inventarbuch-179.jpg
  âœ… CER: 0.2045 (20.45%)

[17/48] Processing: inventarbuch-114.jpg
  âœ… CER: 0.2846 (28.46%)

[18/48] Processing: inventarbuch-082.jpg
  âœ… CER: 0.3554 (35.54%)

[19/48] Processing: inventarbuch-287.jpg
  âœ… CER: 0.3048 (30.48%)

[20/48] Processing: inventarbuch-181.jpg
  âœ… CER: 0.2237 (22.37%)

Chunk 4 completed. Cleaning memory...

============================================================
Chunk 5/10 (5 images)
============================================================

[21/48] Processing: inventarbuch-299.jpg
  âœ… CER: 0.2967 (29.67%)

[22/48] Processing: inventarbuch-084.jpg
  âœ… CER: 0.3607 (36.07%)

[23/48] Processing: inventarbuch-004.jpg
  âœ… CER: 0.1721 (17.21%)

[24/48] Processing: inventarbuch-148.jpg
  âœ… CER: 0.1048 (10.48%)

[25/48] Processing: inventarbuch-238.jpg
  âœ… CER: 0.2500 (25.00%)

Chunk 5 completed. Cleaning memory...

============================================================
Chunk 6/10 (5 images)
============================================================

[26/48] Processing: inventarbuch-116.jpg
  âœ… CER: 0.1315 (13.15%)

[27/48] Processing: inventarbuch-223.jpg
  âœ… CER: 0.1974 (19.74%)

[28/48] Processing: inventarbuch-104.jpg
  âœ… CER: 0.2792 (27.92%)

[29/48] Processing: inventarbuch-015.jpg
  âœ… CER: 0.2355 (23.55%)

[30/48] Processing: inventarbuch-272.jpg
  âœ… CER: 0.2474 (24.74%)

Chunk 6 completed. Cleaning memory...
Saved intermediate results to: /home/vault/iwi5/iwi5298h/models_image_text/gemma/inventory_dataset/run_A100_genCER_20260201_065249/test_predictions_chunk_6.jsonl

============================================================
Chunk 7/10 (5 images)
============================================================

[31/48] Processing: inventarbuch-124.jpg
  âœ… CER: 0.1598 (15.98%)

[32/48] Processing: inventarbuch-115.jpg
  âœ… CER: 1.0000 (100.00%)

[33/48] Processing: inventarbuch-049.jpg
  âœ… CER: 0.0303 (3.03%)

[34/48] Processing: inventarbuch-017.jpg
  âœ… CER: 0.0380 (3.80%)

[35/48] Processing: inventarbuch-018.jpg
  âœ… CER: 0.2995 (29.95%)

Chunk 7 completed. Cleaning memory...

============================================================
Chunk 8/10 (5 images)
============================================================

[36/48] Processing: inventarbuch-225.jpg
  âœ… CER: 0.3135 (31.35%)

[37/48] Processing: inventarbuch-046.jpg
  âœ… CER: 0.2465 (24.65%)

[38/48] Processing: inventarbuch-294.jpg
  âœ… CER: 0.1282 (12.82%)

[39/48] Processing: inventarbuch-054.jpg
  âœ… CER: 0.3465 (34.65%)

[40/48] Processing: inventarbuch-073.jpg
  âœ… CER: 1.0000 (100.00%)

Chunk 8 completed. Cleaning memory...

============================================================
Chunk 9/10 (5 images)
============================================================

[41/48] Processing: inventarbuch-118.jpg
  âœ… CER: 0.2020 (20.20%)

[42/48] Processing: inventarbuch-130.jpg
  âœ… CER: 0.1888 (18.88%)

[43/48] Processing: inventarbuch-146.jpg
  âœ… CER: 0.2500 (25.00%)

[44/48] Processing: inventarbuch-014.jpg
  âœ… CER: 0.3352 (33.52%)

[45/48] Processing: inventarbuch-059.jpg
  âœ… CER: 0.1955 (19.55%)

Chunk 9 completed. Cleaning memory...
Saved intermediate results to: /home/vault/iwi5/iwi5298h/models_image_text/gemma/inventory_dataset/run_A100_genCER_20260201_065249/test_predictions_chunk_9.jsonl

============================================================
Chunk 10/10 (3 images)
============================================================

[46/48] Processing: inventarbuch-256.jpg
  âœ… CER: 0.1659 (16.59%)

[47/48] Processing: inventarbuch-260.jpg
  âœ… CER: 0.1662 (16.62%)

[48/48] Processing: inventarbuch-279.jpg
  âœ… CER: 0.2952 (29.52%)

Chunk 10 completed. Cleaning memory...
Saved intermediate results to: /home/vault/iwi5/iwi5298h/models_image_text/gemma/inventory_dataset/run_A100_genCER_20260201_065249/test_predictions_chunk_10.jsonl

CER evaluation results saved to: /home/vault/iwi5/iwi5298h/models_image_text/gemma/inventory_dataset/run_A100_genCER_20260201_065249/cer_evaluation_results.txt

ðŸŽ‰ Gemma-3 Inventory training completed!
All outputs saved to: /home/vault/iwi5/iwi5298h/models_image_text/gemma/inventory_dataset/run_A100_genCER_20260201_065249

Final CER: 0.2510 (25.10%)
Best VALIDATION gen-CER (autoregressive): 0.2161 (21.61%)
ONLY saved best model at: /home/vault/iwi5/iwi5298h/models_image_text/gemma/inventory_dataset/run_A100_genCER_20260201_065249/best_model_gen_cer
Cleaned up temporary directory: /tmp/1521500.tinygpu/inventory_gemma_aug_q30e5gb_
Gemma-3 training completed at: Sun Feb  1 12:42:34 PM CET 2026
=== JOB_STATISTICS ===
=== current date     : Sun Feb  1 12:42:34 PM CET 2026
= Job-ID             : 1521500 on tinygpu
= Job-Name           : inven_preprocess
= Job-Command        : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles/job_gemma.sh
= Initial workdir    : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles
= Queue/Partition    : a100
= Slurm account      : iwi5 with QOS=normal
= Requested resources:  for 1-00:00:00
= Elapsed runtime    : 05:50:30
= Total RAM usage    : 9.7 GiB of requested  GiB (%)   
= Node list          : tg097
= Subm/Elig/Start/End: 2026-02-01T00:44:26 / 2026-02-01T00:44:26 / 2026-02-01T06:52:04 / 2026-02-01T12:42:34
======================
=== Quota infos ======
    Path                 Used     SoftQ    HardQ    Gracetime  Filec    FileQ    FiHaQ    FileGrace    
    /home/hpc              88.1G   104.9G   209.7G        N/A  29,344      500K   1,000K        N/A    
    /home/woody           408.0G  1000.0G  1500.0G        N/A   1,017K   5,000K   7,500K        N/A    
    /home/vault           751.6G  1048.6G  2097.2G        N/A   8,501      200K     400K        N/A    
======================
=== GPU utilization ==
gpu_name, gpu_bus_id, pid, gpu_utilization [%], mem_utilization [%], max_memory_usage [MiB], time [ms]
NVIDIA A100-SXM4-40GB, 00000000:C1:00.0, 3219059, 24 %, 4 %, 10056 MiB, 21013205 ms
