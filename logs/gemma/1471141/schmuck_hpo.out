### Starting TaskPrologue of job 1471141 on tg091 at Sat Dec 20 06:05:00 AM CET 2025
Running on cores 96-127 with governor ondemand
Sat Dec 20 06:05:00 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 580.105.08             Driver Version: 580.105.08     CUDA Version: 13.0     |
+-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-40GB          On  |   00000000:C1:00.0 Off |                    0 |
| N/A   38C    P0             52W /  400W |       0MiB /  40960MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
### Finished TaskPrologue

ü¶• Unsloth: Will patch your computer to enable 2x faster free finetuning.
ü¶• Unsloth Zoo will now patch everything to make training faster!

================================================================================
GEMMA-3 SCHMUCK HPO (Optuna + A100)
================================================================================
[HPO] Storage: sqlite:////home/hpc/iwi5/iwi5298h/Uddipan-Thesis/vlmmodels.db
[HPO] Study name: gemma3_schmuck
[HPO] HPO run folder: /home/vault/iwi5/iwi5298h/models_image_text/gemma/HPO/schmuck/hpo_run_20251220_060531
[HPO] Target COMPLETE trials: 30
[HPO] Completed trials so far: 0
[HPO] Remaining trials to run: 30

================================================================================
[HPO] GEMMA-3 SCHMUCK TRIAL
================================================================================
[HPO] Trial #0
[HPO] Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/gemma/HPO/schmuck/hpo_run_20251220_060531/trial_000
[HPO]   ‚Ä¢ num_epochs: 9
[HPO]   ‚Ä¢ batch_size: 2
[HPO]   ‚Ä¢ grad_accum: 16
[HPO]   ‚Ä¢ learning_rate: 2.8057582076672495e-05
[HPO]   ‚Ä¢ weight_decay: 0.09507143064099162
[HPO]   ‚Ä¢ lora_r: 8
[HPO]   ‚Ä¢ lora_alpha: 64
[HPO]   ‚Ä¢ lora_dropout: 0.0902
Loading Gemma-3 vision model with Unsloth for SCHMUCK...
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Gemma3 patching. Transformers: 4.51.3.
   \\   /|    NVIDIA A100-SXM4-40GB. Num GPUs = 1. Max memory: 39.494 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 8.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Gemma3 does not support SDPA - switching to eager!
Model loaded - Unsloth auto-configured dtype and attention
Unsloth: Making `base_model.model.vision_tower.vision_model` require gradients
Gemma-3 vision model loaded with LoRA (r=8, alpha=64, dropout=0.0902)
Prepared 413 samples (valid images) out of 413 total
[HPO] Training samples: 413
[HPO] GPU = NVIDIA A100-SXM4-40GB. Max memory = 39.494 GB.
[HPO] 4.809 GB of memory reserved before training.
[HPO] Starting Gemma-3 training for this trial...

{'loss': 19.4047, 'grad_norm': 243.46981811523438, 'learning_rate': 2.29562035172775e-05, 'epoch': 0.77}
{'loss': 3.5239, 'grad_norm': 35.37240219116211, 'learning_rate': 2.7589312960670772e-05, 'epoch': 1.62}
{'loss': 0.7007, 'grad_norm': 21.990901947021484, 'learning_rate': 2.5740419347224982e-05, 'epoch': 2.46}
{'loss': 0.2088, 'grad_norm': 9.750298500061035, 'learning_rate': 2.2673731414126233e-05, 'epoch': 3.31}
{'loss': 0.1488, 'grad_norm': 8.614890098571777, 'learning_rate': 1.8708128402294546e-05, 'epoch': 4.15}
{'loss': 0.0954, 'grad_norm': 30.008939743041992, 'learning_rate': 1.4255960216835945e-05, 'epoch': 4.93}
{'loss': 0.0843, 'grad_norm': 7.601662635803223, 'learning_rate': 9.780170607619626e-06, 'epoch': 5.77}
{'loss': 0.0669, 'grad_norm': 6.721758842468262, 'learning_rate': 5.74615951889831e-06, 'epoch': 6.62}
{'loss': 0.0416, 'grad_norm': 3.8514645099639893, 'learning_rate': 2.573390039808226e-06, 'epoch': 7.46}
{'loss': 0.0426, 'grad_norm': 7.459411144256592, 'learning_rate': 5.917719444046106e-07, 'epoch': 8.31}
{'train_runtime': 3886.4484, 'train_samples_per_second': 0.956, 'train_steps_per_second': 0.028, 'train_loss': 2.253620824466149, 'epoch': 8.93}
[HPO] Training runtime: 3886.45 s (64.77 min)
[HPO] Peak reserved memory: 11.084 GB

[HPO] === Running validation CER (Gemma-3 SCHMUCK) ===
[HPO] Using 30 validation samples
[HPO]   Val sample 1/30: SCH_1941.jpg
[HPO]   ‚ùå Validation error on SCH_1941.jpg: name 're' is not defined
[HPO]   Val sample 2/30: SCH_3097.jpg
[HPO]   ‚ùå Validation error on SCH_3097.jpg: name 're' is not defined
[HPO]   Val sample 3/30: SCH_3217.jpg
[HPO]   ‚ùå Validation error on SCH_3217.jpg: name 're' is not defined
[HPO]   Val sample 4/30: SCH_2891_185.jpg
[HPO]   ‚ùå Validation error on SCH_2891_185.jpg: name 're' is not defined
[HPO]   Val sample 5/30: SCH_1931.jpg
[HPO]   ‚ùå Validation error on SCH_1931.jpg: name 're' is not defined
[HPO]   Val sample 6/30: SCH_2891_139.jpg
[HPO]   ‚ùå Validation error on SCH_2891_139.jpg: name 're' is not defined
[HPO]   Val sample 7/30: SCH_2891_303.jpg
[HPO]   ‚ùå Validation error on SCH_2891_303.jpg: name 're' is not defined
[HPO]   Val sample 8/30: SCH_3082_recto.jpg
[HPO]   ‚ùå Validation error on SCH_3082_recto.jpg: name 're' is not defined
[HPO]   Val sample 9/30: SCH_3192_15.jpg
[HPO]   ‚ùå Validation error on SCH_3192_15.jpg: name 're' is not defined
[HPO]   Val sample 10/30: SCH_2969.jpg
[HPO]   ‚ùå Validation error on SCH_2969.jpg: name 're' is not defined
[HPO]   Val sample 11/30: SCH_2891_24_a.jpg
[HPO]   ‚ùå Validation error on SCH_2891_24_a.jpg: name 're' is not defined
[HPO]   Val sample 12/30: SCH_3028.jpg
[HPO]   ‚ùå Validation error on SCH_3028.jpg: name 're' is not defined
[HPO]   Val sample 13/30: SCH_3192_34.jpg
[HPO]   ‚ùå Validation error on SCH_3192_34.jpg: name 're' is not defined
[HPO]   Val sample 14/30: SCH_2891_194_195.jpg
[HPO]   ‚ùå Validation error on SCH_2891_194_195.jpg: name 're' is not defined
[HPO]   Val sample 15/30: SCH_3138.jpg
[HPO]   ‚ùå Validation error on SCH_3138.jpg: name 're' is not defined
[HPO]   Val sample 16/30: SCH_2891_216.jpg
[HPO]   ‚ùå Validation error on SCH_2891_216.jpg: name 're' is not defined
[HPO]   Val sample 17/30: SCH_3201.jpg
[HPO]   ‚ùå Validation error on SCH_3201.jpg: name 're' is not defined
[HPO]   Val sample 18/30: SCH_2891_208.jpg
[HPO]   ‚ùå Validation error on SCH_2891_208.jpg: name 're' is not defined
[HPO]   Val sample 19/30: SCH_2079.jpg
[HPO]   ‚ùå Validation error on SCH_2079.jpg: name 're' is not defined
[HPO]   Val sample 20/30: SCH_2891_122.jpg
[HPO]   ‚ùå Validation error on SCH_2891_122.jpg: name 're' is not defined
[HPO]   Val sample 21/30: SCH_3192_24.jpg
[HPO]   ‚ùå Validation error on SCH_3192_24.jpg: name 're' is not defined
[HPO]   Val sample 22/30: SCH_2891_294.jpg
[HPO]   ‚ùå Validation error on SCH_2891_294.jpg: name 're' is not defined
[HPO]   Val sample 23/30: SCH_2891_119.jpg
[HPO]   ‚ùå Validation error on SCH_2891_119.jpg: name 're' is not defined
[HPO]   Val sample 24/30: SCH_3049.jpg
[HPO]   ‚ùå Validation error on SCH_3049.jpg: name 're' is not defined
[HPO]   Val sample 25/30: SCH_2891_269.jpg
[HPO]   ‚ùå Validation error on SCH_2891_269.jpg: name 're' is not defined
[HPO]   Val sample 26/30: SCH_2990.jpg
[HPO]   ‚ùå Validation error on SCH_2990.jpg: name 're' is not defined
[HPO]   Val sample 27/30: SCH_1933.jpg
[HPO]   ‚ùå Validation error on SCH_1933.jpg: name 're' is not defined
[HPO]   Val sample 28/30: SCH_2891_71.jpg
[HPO]   ‚ùå Validation error on SCH_2891_71.jpg: name 're' is not defined
[HPO]   Val sample 29/30: SCH_3121.jpg
[HPO]   ‚ùå Validation error on SCH_3121.jpg: name 're' is not defined
[HPO]   Val sample 30/30: SCH_2891_61.jpg
[HPO]   ‚ùå Validation error on SCH_2891_61.jpg: name 're' is not defined

[HPO]   ‚úÖ Validation CER: 1.0000 (100.00%)


================================================================================
[HPO] GEMMA-3 SCHMUCK TRIAL
================================================================================
[HPO] Trial #1
[HPO] Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/gemma/HPO/schmuck/hpo_run_20251220_060531/trial_001
[HPO]   ‚Ä¢ num_epochs: 9
[HPO]   ‚Ä¢ batch_size: 2
[HPO]   ‚Ä¢ grad_accum: 16
[HPO]   ‚Ä¢ learning_rate: 1.3293771991636346e-05
[HPO]   ‚Ä¢ weight_decay: 0.018182496720710064
[HPO]   ‚Ä¢ lora_r: 32
[HPO]   ‚Ä¢ lora_alpha: 64
[HPO]   ‚Ä¢ lora_dropout: 0.0209
Loading Gemma-3 vision model with Unsloth for SCHMUCK...
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Gemma3 patching. Transformers: 4.51.3.
   \\   /|    NVIDIA A100-SXM4-40GB. Num GPUs = 1. Max memory: 39.494 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 8.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Gemma3 does not support SDPA - switching to eager!
Model loaded - Unsloth auto-configured dtype and attention
Unsloth: Making `base_model.model.vision_tower.vision_model` require gradients
Gemma-3 vision model loaded with LoRA (r=32, alpha=64, dropout=0.0209)
Prepared 413 samples (valid images) out of 413 total
[HPO] Training samples: 413
[HPO] GPU = NVIDIA A100-SXM4-40GB. Max memory = 39.494 GB.
[HPO] 11.084 GB of memory reserved before training.
[HPO] Starting Gemma-3 training for this trial...

{'loss': 20.1544, 'grad_norm': 193.94247436523438, 'learning_rate': 1.0876722538611557e-05, 'epoch': 0.77}
{'loss': 4.0961, 'grad_norm': 36.118682861328125, 'learning_rate': 1.3071904589026924e-05, 'epoch': 1.62}
{'loss': 0.8397, 'grad_norm': 13.259956359863281, 'learning_rate': 1.2195892890414586e-05, 'epoch': 2.46}
{'loss': 0.294, 'grad_norm': 11.801925659179688, 'learning_rate': 1.0742886354045498e-05, 'epoch': 3.31}
{'loss': 0.1664, 'grad_norm': 5.839956283569336, 'learning_rate': 8.863970982629112e-06, 'epoch': 4.15}
{'loss': 0.0987, 'grad_norm': 23.533849716186523, 'learning_rate': 6.754519478070841e-06, 'epoch': 4.93}
{'loss': 0.0799, 'grad_norm': 7.867602348327637, 'learning_rate': 4.633876067499614e-06, 'epoch': 5.77}
{'loss': 0.0678, 'grad_norm': 5.467947483062744, 'learning_rate': 2.72254873078729e-06, 'epoch': 6.62}
{'loss': 0.0418, 'grad_norm': 2.7920682430267334, 'learning_rate': 1.2192804191492075e-06, 'epoch': 7.46}
{'loss': 0.0439, 'grad_norm': 13.127619743347168, 'learning_rate': 2.803834371210069e-07, 'epoch': 8.31}
{'train_runtime': 3870.4518, 'train_samples_per_second': 0.96, 'train_steps_per_second': 0.028, 'train_loss': 2.398759836813918, 'epoch': 8.93}
[HPO] Training runtime: 3870.45 s (64.51 min)
[HPO] Peak reserved memory: 11.863 GB

[HPO] === Running validation CER (Gemma-3 SCHMUCK) ===
[HPO] Using 30 validation samples
[HPO]   Val sample 1/30: SCH_1941.jpg
[HPO]   ‚ùå Validation error on SCH_1941.jpg: name 're' is not defined
[HPO]   Val sample 2/30: SCH_3097.jpg
[HPO]   ‚ùå Validation error on SCH_3097.jpg: name 're' is not defined
[HPO]   Val sample 3/30: SCH_3217.jpg
[HPO]   ‚ùå Validation error on SCH_3217.jpg: name 're' is not defined
[HPO]   Val sample 4/30: SCH_2891_185.jpg
[HPO]   ‚ùå Validation error on SCH_2891_185.jpg: name 're' is not defined
[HPO]   Val sample 5/30: SCH_1931.jpg
[HPO]   ‚ùå Validation error on SCH_1931.jpg: name 're' is not defined
[HPO]   Val sample 6/30: SCH_2891_139.jpg
[HPO]   ‚ùå Validation error on SCH_2891_139.jpg: name 're' is not defined
[HPO]   Val sample 7/30: SCH_2891_303.jpg
[HPO]   ‚ùå Validation error on SCH_2891_303.jpg: name 're' is not defined
[HPO]   Val sample 8/30: SCH_3082_recto.jpg
[HPO]   ‚ùå Validation error on SCH_3082_recto.jpg: name 're' is not defined
[HPO]   Val sample 9/30: SCH_3192_15.jpg
[HPO]   ‚ùå Validation error on SCH_3192_15.jpg: name 're' is not defined
[HPO]   Val sample 10/30: SCH_2969.jpg
[HPO]   ‚ùå Validation error on SCH_2969.jpg: name 're' is not defined
[HPO]   Val sample 11/30: SCH_2891_24_a.jpg
[HPO]   ‚ùå Validation error on SCH_2891_24_a.jpg: name 're' is not defined
[HPO]   Val sample 12/30: SCH_3028.jpg
[HPO]   ‚ùå Validation error on SCH_3028.jpg: name 're' is not defined
[HPO]   Val sample 13/30: SCH_3192_34.jpg
[HPO]   ‚ùå Validation error on SCH_3192_34.jpg: name 're' is not defined
[HPO]   Val sample 14/30: SCH_2891_194_195.jpg
[HPO]   ‚ùå Validation error on SCH_2891_194_195.jpg: name 're' is not defined
[HPO]   Val sample 15/30: SCH_3138.jpg
[HPO]   ‚ùå Validation error on SCH_3138.jpg: name 're' is not defined
[HPO]   Val sample 16/30: SCH_2891_216.jpg
[HPO]   ‚ùå Validation error on SCH_2891_216.jpg: name 're' is not defined
[HPO]   Val sample 17/30: SCH_3201.jpg
[HPO]   ‚ùå Validation error on SCH_3201.jpg: name 're' is not defined
[HPO]   Val sample 18/30: SCH_2891_208.jpg
[HPO]   ‚ùå Validation error on SCH_2891_208.jpg: name 're' is not defined
[HPO]   Val sample 19/30: SCH_2079.jpg
[HPO]   ‚ùå Validation error on SCH_2079.jpg: name 're' is not defined
[HPO]   Val sample 20/30: SCH_2891_122.jpg
[HPO]   ‚ùå Validation error on SCH_2891_122.jpg: name 're' is not defined
[HPO]   Val sample 21/30: SCH_3192_24.jpg
[HPO]   ‚ùå Validation error on SCH_3192_24.jpg: name 're' is not defined
[HPO]   Val sample 22/30: SCH_2891_294.jpg
[HPO]   ‚ùå Validation error on SCH_2891_294.jpg: name 're' is not defined
[HPO]   Val sample 23/30: SCH_2891_119.jpg
[HPO]   ‚ùå Validation error on SCH_2891_119.jpg: name 're' is not defined
[HPO]   Val sample 24/30: SCH_3049.jpg
[HPO]   ‚ùå Validation error on SCH_3049.jpg: name 're' is not defined
[HPO]   Val sample 25/30: SCH_2891_269.jpg
[HPO]   ‚ùå Validation error on SCH_2891_269.jpg: name 're' is not defined
[HPO]   Val sample 26/30: SCH_2990.jpg
[HPO]   ‚ùå Validation error on SCH_2990.jpg: name 're' is not defined
[HPO]   Val sample 27/30: SCH_1933.jpg
[HPO]   ‚ùå Validation error on SCH_1933.jpg: name 're' is not defined
[HPO]   Val sample 28/30: SCH_2891_71.jpg
[HPO]   ‚ùå Validation error on SCH_2891_71.jpg: name 're' is not defined
[HPO]   Val sample 29/30: SCH_3121.jpg
[HPO]   ‚ùå Validation error on SCH_3121.jpg: name 're' is not defined
[HPO]   Val sample 30/30: SCH_2891_61.jpg
[HPO]   ‚ùå Validation error on SCH_2891_61.jpg: name 're' is not defined

[HPO]   ‚úÖ Validation CER: 1.0000 (100.00%)


================================================================================
[HPO] GEMMA-3 SCHMUCK TRIAL
================================================================================
[HPO] Trial #2
[HPO] Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/gemma/HPO/schmuck/hpo_run_20251220_060531/trial_002
[HPO]   ‚Ä¢ num_epochs: 9
[HPO]   ‚Ä¢ batch_size: 2
[HPO]   ‚Ä¢ grad_accum: 4
[HPO]   ‚Ä¢ learning_rate: 1.2540578430226153e-05
[HPO]   ‚Ä¢ weight_decay: 0.05142344384136116
[HPO]   ‚Ä¢ lora_r: 32
[HPO]   ‚Ä¢ lora_alpha: 64
[HPO]   ‚Ä¢ lora_dropout: 0.1448
Loading Gemma-3 vision model with Unsloth for SCHMUCK...
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Gemma3 patching. Transformers: 4.51.3.
   \\   /|    NVIDIA A100-SXM4-40GB. Num GPUs = 1. Max memory: 39.494 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 8.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Gemma3 does not support SDPA - switching to eager!
Model loaded - Unsloth auto-configured dtype and attention
Unsloth: Making `base_model.model.vision_tower.vision_model` require gradients
Gemma-3 vision model loaded with LoRA (r=32, alpha=64, dropout=0.1448)
Prepared 413 samples (valid images) out of 413 total
[HPO] Training samples: 413
[HPO] GPU = NVIDIA A100-SXM4-40GB. Max memory = 39.494 GB.
[HPO] 11.863 GB of memory reserved before training.
[HPO] Starting Gemma-3 training for this trial...

{'loss': 6.5564, 'grad_norm': 724.6650390625, 'learning_rate': 2.453591432000769e-06, 'epoch': 0.19}
{'loss': 3.4547, 'grad_norm': 116.06632232666016, 'learning_rate': 5.179804134223846e-06, 'epoch': 0.39}
{'loss': 1.3335, 'grad_norm': 41.96729278564453, 'learning_rate': 7.906016836446923e-06, 'epoch': 0.58}
{'loss': 0.3159, 'grad_norm': 36.43791198730469, 'learning_rate': 1.0632229538669999e-05, 'epoch': 0.77}
{'loss': 0.1875, 'grad_norm': 21.108381271362305, 'learning_rate': 1.2538945826130631e-05, 'epoch': 0.97}
{'loss': 0.0925, 'grad_norm': 8.714944839477539, 'learning_rate': 1.250994539798833e-05, 'epoch': 1.17}
{'loss': 0.0545, 'grad_norm': 6.4465155601501465, 'learning_rate': 1.2444857961561864e-05, 'epoch': 1.37}
{'loss': 0.0689, 'grad_norm': 6.38704776763916, 'learning_rate': 1.2344059949588658e-05, 'epoch': 1.56}
{'loss': 0.0546, 'grad_norm': 5.564523220062256, 'learning_rate': 1.2208134326672289e-05, 'epoch': 1.75}
{'loss': 0.0476, 'grad_norm': 20.294788360595703, 'learning_rate': 1.203786721771074e-05, 'epoch': 1.95}
{'loss': 0.0277, 'grad_norm': 5.803022861480713, 'learning_rate': 1.1834243361348506e-05, 'epoch': 2.15}
{'loss': 0.0314, 'grad_norm': 5.348069667816162, 'learning_rate': 1.1598440414747458e-05, 'epoch': 2.35}
{'loss': 0.0212, 'grad_norm': 6.4573187828063965, 'learning_rate': 1.1331822142614823e-05, 'epoch': 2.54}
{'loss': 0.035, 'grad_norm': 4.383556365966797, 'learning_rate': 1.103593052987944e-05, 'epoch': 2.73}
{'loss': 0.034, 'grad_norm': 1.025250792503357, 'learning_rate': 1.0712476863632627e-05, 'epoch': 2.93}
{'loss': 0.0251, 'grad_norm': 1.5061272382736206, 'learning_rate': 1.036333183591114e-05, 'epoch': 3.14}
{'loss': 0.0192, 'grad_norm': 2.720447063446045, 'learning_rate': 9.990514724562744e-06, 'epoch': 3.33}
{'loss': 0.0186, 'grad_norm': 2.3925654888153076, 'learning_rate': 9.596181714766782e-06, 'epoch': 3.52}
{'loss': 0.0175, 'grad_norm': 7.131371974945068, 'learning_rate': 9.182613428752133e-06, 'epoch': 3.71}
{'loss': 0.0168, 'grad_norm': 6.077700614929199, 'learning_rate': 8.752201735834359e-06, 'epoch': 3.91}
{'loss': 0.022, 'grad_norm': 27.317420959472656, 'learning_rate': 8.307435919056098e-06, 'epoch': 4.12}
{'loss': 0.0103, 'grad_norm': 1.4240936040878296, 'learning_rate': 7.850888278435842e-06, 'epoch': 4.31}
{'loss': 0.0116, 'grad_norm': 3.4757585525512695, 'learning_rate': 7.385199254088608e-06, 'epoch': 4.5}
{'loss': 0.0113, 'grad_norm': 2.770162582397461, 'learning_rate': 6.913062155258837e-06, 'epoch': 4.7}
{'loss': 0.0086, 'grad_norm': 11.848640441894531, 'learning_rate': 6.437207583585042e-06, 'epoch': 4.89}
{'loss': 0.0126, 'grad_norm': 2.3012566566467285, 'learning_rate': 5.960387640684166e-06, 'epoch': 5.1}
{'loss': 0.0049, 'grad_norm': 1.0850794315338135, 'learning_rate': 5.485360011390953e-06, 'epoch': 5.29}
{'loss': 0.0088, 'grad_norm': 7.177745342254639, 'learning_rate': 5.014872014706813e-06, 'epoch': 5.48}
{'loss': 0.0075, 'grad_norm': 5.7613372802734375, 'learning_rate': 4.5516447146994366e-06, 'epoch': 5.68}
{'loss': 0.0078, 'grad_norm': 4.469360828399658, 'learning_rate': 4.098357183247608e-06, 'epoch': 5.87}
{'loss': 0.0048, 'grad_norm': 0.41238367557525635, 'learning_rate': 3.657631005647563e-06, 'epoch': 6.08}
{'loss': 0.0051, 'grad_norm': 1.3721482753753662, 'learning_rate': 3.232015118692606e-06, 'epoch': 6.27}
{'loss': 0.0026, 'grad_norm': 0.8456566333770752, 'learning_rate': 2.8239710689148325e-06, 'epoch': 6.46}
{'loss': 0.003, 'grad_norm': 1.6048359870910645, 'learning_rate': 2.4358587762478217e-06, 'epoch': 6.66}
{'loss': 0.0034, 'grad_norm': 3.1344363689422607, 'learning_rate': 2.069922885446051e-06, 'epoch': 6.85}
{'loss': 0.002, 'grad_norm': 0.4062259793281555, 'learning_rate': 1.7282797841975304e-06, 'epoch': 7.06}
{'loss': 0.0015, 'grad_norm': 0.9392058253288269, 'learning_rate': 1.4129053630102704e-06, 'epoch': 7.25}
{'loss': 0.0009, 'grad_norm': 2.956634759902954, 'learning_rate': 1.1256235876632204e-06, 'epoch': 7.44}
{'loss': 0.0044, 'grad_norm': 0.8050276637077332, 'learning_rate': 8.680959503128399e-07, 'epoch': 7.64}
{'loss': 0.001, 'grad_norm': 0.5628554224967957, 'learning_rate': 6.418118602647216e-07, 'epoch': 7.83}
{'loss': 0.0014, 'grad_norm': 0.5148006081581116, 'learning_rate': 4.4808002998519373e-07, 'epoch': 8.04}
{'loss': 0.0006, 'grad_norm': 0.1844496726989746, 'learning_rate': 2.8802090617184627e-07, 'epoch': 8.23}
{'loss': 0.002, 'grad_norm': 0.3140481412410736, 'learning_rate': 1.6256018965782261e-07, 'epoch': 8.43}
{'loss': 0.0004, 'grad_norm': 0.78253573179245, 'learning_rate': 7.242348162746397e-08, 'epoch': 8.62}
{'loss': 0.0014, 'grad_norm': 10.491607666015625, 'learning_rate': 1.8132087106891976e-08, 'epoch': 8.81}
{'train_runtime': 3906.5565, 'train_samples_per_second': 0.951, 'train_steps_per_second': 0.117, 'train_loss': 0.273488735182572, 'epoch': 8.99}
[HPO] Training runtime: 3906.56 s (65.11 min)
[HPO] Peak reserved memory: 12.02 GB

[HPO] === Running validation CER (Gemma-3 SCHMUCK) ===
[HPO] Using 30 validation samples
[HPO]   Val sample 1/30: SCH_1941.jpg
[HPO]   ‚ùå Validation error on SCH_1941.jpg: name 're' is not defined
[HPO]   Val sample 2/30: SCH_3097.jpg
[HPO]   ‚ùå Validation error on SCH_3097.jpg: name 're' is not defined
[HPO]   Val sample 3/30: SCH_3217.jpg
[HPO]   ‚ùå Validation error on SCH_3217.jpg: name 're' is not defined
[HPO]   Val sample 4/30: SCH_2891_185.jpg
[HPO]   ‚ùå Validation error on SCH_2891_185.jpg: name 're' is not defined
[HPO]   Val sample 5/30: SCH_1931.jpg
[HPO]   ‚ùå Validation error on SCH_1931.jpg: name 're' is not defined
[HPO]   Val sample 6/30: SCH_2891_139.jpg
[HPO]   ‚ùå Validation error on SCH_2891_139.jpg: name 're' is not defined
[HPO]   Val sample 7/30: SCH_2891_303.jpg
[HPO]   ‚ùå Validation error on SCH_2891_303.jpg: name 're' is not defined
[HPO]   Val sample 8/30: SCH_3082_recto.jpg
[HPO]   ‚ùå Validation error on SCH_3082_recto.jpg: name 're' is not defined
[HPO]   Val sample 9/30: SCH_3192_15.jpg
[HPO]   ‚ùå Validation error on SCH_3192_15.jpg: name 're' is not defined
[HPO]   Val sample 10/30: SCH_2969.jpg
[HPO]   ‚ùå Validation error on SCH_2969.jpg: name 're' is not defined
[HPO]   Val sample 11/30: SCH_2891_24_a.jpg
[HPO]   ‚ùå Validation error on SCH_2891_24_a.jpg: name 're' is not defined
[HPO]   Val sample 12/30: SCH_3028.jpg
[HPO]   ‚ùå Validation error on SCH_3028.jpg: name 're' is not defined
[HPO]   Val sample 13/30: SCH_3192_34.jpg
[HPO]   ‚ùå Validation error on SCH_3192_34.jpg: name 're' is not defined
[HPO]   Val sample 14/30: SCH_2891_194_195.jpg
[HPO]   ‚ùå Validation error on SCH_2891_194_195.jpg: name 're' is not defined
[HPO]   Val sample 15/30: SCH_3138.jpg
[HPO]   ‚ùå Validation error on SCH_3138.jpg: name 're' is not defined
[HPO]   Val sample 16/30: SCH_2891_216.jpg
[HPO]   ‚ùå Validation error on SCH_2891_216.jpg: name 're' is not defined
[HPO]   Val sample 17/30: SCH_3201.jpg
[HPO]   ‚ùå Validation error on SCH_3201.jpg: name 're' is not defined
[HPO]   Val sample 18/30: SCH_2891_208.jpg
[HPO]   ‚ùå Validation error on SCH_2891_208.jpg: name 're' is not defined
[HPO]   Val sample 19/30: SCH_2079.jpg
[HPO]   ‚ùå Validation error on SCH_2079.jpg: name 're' is not defined
[HPO]   Val sample 20/30: SCH_2891_122.jpg
[HPO]   ‚ùå Validation error on SCH_2891_122.jpg: name 're' is not defined
[HPO]   Val sample 21/30: SCH_3192_24.jpg
[HPO]   ‚ùå Validation error on SCH_3192_24.jpg: name 're' is not defined
[HPO]   Val sample 22/30: SCH_2891_294.jpg
[HPO]   ‚ùå Validation error on SCH_2891_294.jpg: name 're' is not defined
[HPO]   Val sample 23/30: SCH_2891_119.jpg
[HPO]   ‚ùå Validation error on SCH_2891_119.jpg: name 're' is not defined
[HPO]   Val sample 24/30: SCH_3049.jpg
[HPO]   ‚ùå Validation error on SCH_3049.jpg: name 're' is not defined
[HPO]   Val sample 25/30: SCH_2891_269.jpg
[HPO]   ‚ùå Validation error on SCH_2891_269.jpg: name 're' is not defined
[HPO]   Val sample 26/30: SCH_2990.jpg
[HPO]   ‚ùå Validation error on SCH_2990.jpg: name 're' is not defined
[HPO]   Val sample 27/30: SCH_1933.jpg
[HPO]   ‚ùå Validation error on SCH_1933.jpg: name 're' is not defined
[HPO]   Val sample 28/30: SCH_2891_71.jpg
[HPO]   ‚ùå Validation error on SCH_2891_71.jpg: name 're' is not defined
[HPO]   Val sample 29/30: SCH_3121.jpg
[HPO]   ‚ùå Validation error on SCH_3121.jpg: name 're' is not defined
[HPO]   Val sample 30/30: SCH_2891_61.jpg
[HPO]   ‚ùå Validation error on SCH_2891_61.jpg: name 're' is not defined

[HPO]   ‚úÖ Validation CER: 1.0000 (100.00%)


================================================================================
[HPO] GEMMA-3 SCHMUCK TRIAL
================================================================================
[HPO] Trial #3
[HPO] Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/gemma/HPO/schmuck/hpo_run_20251220_060531/trial_003
[HPO]   ‚Ä¢ num_epochs: 9
[HPO]   ‚Ä¢ batch_size: 2
[HPO]   ‚Ä¢ grad_accum: 16
[HPO]   ‚Ä¢ learning_rate: 3.7955524026413494e-05
[HPO]   ‚Ä¢ weight_decay: 0.012203823484477884
[HPO]   ‚Ä¢ lora_r: 32
[HPO]   ‚Ä¢ lora_alpha: 32
[HPO]   ‚Ä¢ lora_dropout: 0.0780
Loading Gemma-3 vision model with Unsloth for SCHMUCK...
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Gemma3 patching. Transformers: 4.51.3.
   \\   /|    NVIDIA A100-SXM4-40GB. Num GPUs = 1. Max memory: 39.494 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 8.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Gemma3 does not support SDPA - switching to eager!
Model loaded - Unsloth auto-configured dtype and attention
Unsloth: Making `base_model.model.vision_tower.vision_model` require gradients
Gemma-3 vision model loaded with LoRA (r=32, alpha=32, dropout=0.0780)
Prepared 413 samples (valid images) out of 413 total
[HPO] Training samples: 413
[HPO] GPU = NVIDIA A100-SXM4-40GB. Max memory = 39.494 GB.
[HPO] 12.02 GB of memory reserved before training.
[HPO] Starting Gemma-3 training for this trial...

{'loss': 18.3697, 'grad_norm': 80.21356201171875, 'learning_rate': 3.1054519657974676e-05, 'epoch': 0.77}
{'loss': 2.3368, 'grad_norm': 16.362747192382812, 'learning_rate': 3.732206246744303e-05, 'epoch': 1.62}
{'loss': 0.506, 'grad_norm': 7.55324649810791, 'learning_rate': 3.4820930125544993e-05, 'epoch': 2.46}
{'loss': 0.1847, 'grad_norm': 4.342374801635742, 'learning_rate': 3.067239917914471e-05, 'epoch': 3.31}
{'loss': 0.1302, 'grad_norm': 4.307797431945801, 'learning_rate': 2.5307840680002432e-05, 'epoch': 4.15}
{'loss': 0.0738, 'grad_norm': 5.795135974884033, 'learning_rate': 1.9285070219204104e-05, 'epoch': 4.93}
{'loss': 0.0622, 'grad_norm': 2.9535059928894043, 'learning_rate': 1.3230345347133842e-05, 'epoch': 5.77}
{'loss': 0.0508, 'grad_norm': 3.6932244300842285, 'learning_rate': 7.773246286267833e-06, 'epoch': 6.62}
{'loss': 0.0284, 'grad_norm': 1.3302373886108398, 'learning_rate': 3.4812111470746534e-06, 'epoch': 7.46}
{'loss': 0.0303, 'grad_norm': 3.1268484592437744, 'learning_rate': 8.005327826406346e-07, 'epoch': 8.31}
{'train_runtime': 3875.1431, 'train_samples_per_second': 0.959, 'train_steps_per_second': 0.028, 'train_loss': 2.0172620828228967, 'epoch': 8.93}
[HPO] Training runtime: 3875.14 s (64.59 min)
[HPO] Peak reserved memory: 12.02 GB

[HPO] === Running validation CER (Gemma-3 SCHMUCK) ===
[HPO] Using 30 validation samples
[HPO]   Val sample 1/30: SCH_1941.jpg
[HPO]   ‚ùå Validation error on SCH_1941.jpg: name 're' is not defined
[HPO]   Val sample 2/30: SCH_3097.jpg
[HPO]   ‚ùå Validation error on SCH_3097.jpg: name 're' is not defined
[HPO]   Val sample 3/30: SCH_3217.jpg
[HPO]   ‚ùå Validation error on SCH_3217.jpg: name 're' is not defined
[HPO]   Val sample 4/30: SCH_2891_185.jpg
[HPO]   ‚ùå Validation error on SCH_2891_185.jpg: name 're' is not defined
[HPO]   Val sample 5/30: SCH_1931.jpg
[HPO]   ‚ùå Validation error on SCH_1931.jpg: name 're' is not defined
[HPO]   Val sample 6/30: SCH_2891_139.jpg
[HPO]   ‚ùå Validation error on SCH_2891_139.jpg: name 're' is not defined
[HPO]   Val sample 7/30: SCH_2891_303.jpg
[HPO]   ‚ùå Validation error on SCH_2891_303.jpg: name 're' is not defined
[HPO]   Val sample 8/30: SCH_3082_recto.jpg
[HPO]   ‚ùå Validation error on SCH_3082_recto.jpg: name 're' is not defined
[HPO]   Val sample 9/30: SCH_3192_15.jpg
[HPO]   ‚ùå Validation error on SCH_3192_15.jpg: name 're' is not defined
[HPO]   Val sample 10/30: SCH_2969.jpg
[HPO]   ‚ùå Validation error on SCH_2969.jpg: name 're' is not defined
[HPO]   Val sample 11/30: SCH_2891_24_a.jpg
[HPO]   ‚ùå Validation error on SCH_2891_24_a.jpg: name 're' is not defined
[HPO]   Val sample 12/30: SCH_3028.jpg
[HPO]   ‚ùå Validation error on SCH_3028.jpg: name 're' is not defined
[HPO]   Val sample 13/30: SCH_3192_34.jpg
[HPO]   ‚ùå Validation error on SCH_3192_34.jpg: name 're' is not defined
[HPO]   Val sample 14/30: SCH_2891_194_195.jpg
[HPO]   ‚ùå Validation error on SCH_2891_194_195.jpg: name 're' is not defined
[HPO]   Val sample 15/30: SCH_3138.jpg
[HPO]   ‚ùå Validation error on SCH_3138.jpg: name 're' is not defined
[HPO]   Val sample 16/30: SCH_2891_216.jpg
[HPO]   ‚ùå Validation error on SCH_2891_216.jpg: name 're' is not defined
[HPO]   Val sample 17/30: SCH_3201.jpg
[HPO]   ‚ùå Validation error on SCH_3201.jpg: name 're' is not defined
[HPO]   Val sample 18/30: SCH_2891_208.jpg
[HPO]   ‚ùå Validation error on SCH_2891_208.jpg: name 're' is not defined
[HPO]   Val sample 19/30: SCH_2079.jpg
[HPO]   ‚ùå Validation error on SCH_2079.jpg: name 're' is not defined
[HPO]   Val sample 20/30: SCH_2891_122.jpg
[HPO]   ‚ùå Validation error on SCH_2891_122.jpg: name 're' is not defined
[HPO]   Val sample 21/30: SCH_3192_24.jpg
[HPO]   ‚ùå Validation error on SCH_3192_24.jpg: name 're' is not defined
[HPO]   Val sample 22/30: SCH_2891_294.jpg
[HPO]   ‚ùå Validation error on SCH_2891_294.jpg: name 're' is not defined
[HPO]   Val sample 23/30: SCH_2891_119.jpg
[HPO]   ‚ùå Validation error on SCH_2891_119.jpg: name 're' is not defined
[HPO]   Val sample 24/30: SCH_3049.jpg
[HPO]   ‚ùå Validation error on SCH_3049.jpg: name 're' is not defined
[HPO]   Val sample 25/30: SCH_2891_269.jpg
[HPO]   ‚ùå Validation error on SCH_2891_269.jpg: name 're' is not defined
[HPO]   Val sample 26/30: SCH_2990.jpg
[HPO]   ‚ùå Validation error on SCH_2990.jpg: name 're' is not defined
[HPO]   Val sample 27/30: SCH_1933.jpg
[HPO]   ‚ùå Validation error on SCH_1933.jpg: name 're' is not defined
[HPO]   Val sample 28/30: SCH_2891_71.jpg
[HPO]   ‚ùå Validation error on SCH_2891_71.jpg: name 're' is not defined
[HPO]   Val sample 29/30: SCH_3121.jpg
[HPO]   ‚ùå Validation error on SCH_3121.jpg: name 're' is not defined
[HPO]   Val sample 30/30: SCH_2891_61.jpg
[HPO]   ‚ùå Validation error on SCH_2891_61.jpg: name 're' is not defined

[HPO]   ‚úÖ Validation CER: 1.0000 (100.00%)


================================================================================
[HPO] GEMMA-3 SCHMUCK TRIAL
================================================================================
[HPO] Trial #4
[HPO] Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/gemma/HPO/schmuck/hpo_run_20251220_060531/trial_004
[HPO]   ‚Ä¢ num_epochs: 6
[HPO]   ‚Ä¢ batch_size: 2
[HPO]   ‚Ä¢ grad_accum: 8
[HPO]   ‚Ä¢ learning_rate: 0.0003784146030083808
[HPO]   ‚Ä¢ weight_decay: 0.08948273504276488
[HPO]   ‚Ä¢ lora_r: 16
[HPO]   ‚Ä¢ lora_alpha: 64
[HPO]   ‚Ä¢ lora_dropout: 0.0583
Loading Gemma-3 vision model with Unsloth for SCHMUCK...
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Gemma3 patching. Transformers: 4.51.3.
   \\   /|    NVIDIA A100-SXM4-40GB. Num GPUs = 1. Max memory: 39.494 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 8.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Gemma3 does not support SDPA - switching to eager!
Model loaded - Unsloth auto-configured dtype and attention
Unsloth: Making `base_model.model.vision_tower.vision_model` require gradients
Gemma-3 vision model loaded with LoRA (r=16, alpha=64, dropout=0.0583)
Prepared 413 samples (valid images) out of 413 total
[HPO] Training samples: 413
[HPO] GPU = NVIDIA A100-SXM4-40GB. Max memory = 39.494 GB.
[HPO] 12.02 GB of memory reserved before training.
[HPO] Starting Gemma-3 training for this trial...

{'loss': 4.8869, 'grad_norm': 86.01602172851562, 'learning_rate': 0.00022704876180502847, 'epoch': 0.39}
{'loss': 0.3408, 'grad_norm': 16.054630279541016, 'learning_rate': 0.0003775954849895836, 'epoch': 0.77}
{'loss': 0.3452, 'grad_norm': 45.18350601196289, 'learning_rate': 0.0003684616636884568, 'epoch': 1.19}
{'loss': 0.2592, 'grad_norm': 8.129338264465332, 'learning_rate': 0.0003496641933237139, 'epoch': 1.58}
{'loss': 0.2163, 'grad_norm': 15.41353988647461, 'learning_rate': 0.0003222164503882622, 'epoch': 1.97}
{'loss': 0.1903, 'grad_norm': 10.291662216186523, 'learning_rate': 0.0002875981498083351, 'epoch': 2.39}
{'loss': 0.1577, 'grad_norm': 10.517406463623047, 'learning_rate': 0.0002476755731288098, 'epoch': 2.77}
{'loss': 0.1478, 'grad_norm': 9.457389831542969, 'learning_rate': 0.0002046009567920532, 'epoch': 3.19}
{'loss': 0.1115, 'grad_norm': 7.828854560852051, 'learning_rate': 0.00016069646451422875, 'epoch': 3.58}
{'loss': 0.0821, 'grad_norm': 5.033825397491455, 'learning_rate': 0.00011832899883828825, 'epoch': 3.97}
{'loss': 0.0648, 'grad_norm': 1.9130607843399048, 'learning_rate': 7.978260080523137e-05, 'epoch': 4.39}
{'loss': 0.0529, 'grad_norm': 6.890939235687256, 'learning_rate': 4.713531671038345e-05, 'epoch': 4.77}
{'loss': 0.0491, 'grad_norm': 2.9304025173187256, 'learning_rate': 2.214717008973225e-05, 'epoch': 5.19}
{'loss': 0.0286, 'grad_norm': 1.6677701473236084, 'learning_rate': 6.165278395537805e-06, 'epoch': 5.58}
{'loss': 0.0224, 'grad_norm': 10.656201362609863, 'learning_rate': 5.1229545792506465e-08, 'epoch': 5.97}
{'train_runtime': 2596.1968, 'train_samples_per_second': 0.954, 'train_steps_per_second': 0.058, 'train_loss': 0.4637060637275378, 'epoch': 5.97}
[HPO] Training runtime: 2596.20 s (43.27 min)
[HPO] Peak reserved memory: 12.02 GB

[HPO] === Running validation CER (Gemma-3 SCHMUCK) ===
[HPO] Using 30 validation samples
[HPO]   Val sample 1/30: SCH_1941.jpg
[HPO]   ‚ùå Validation error on SCH_1941.jpg: name 're' is not defined
[HPO]   Val sample 2/30: SCH_3097.jpg
[HPO]   ‚ùå Validation error on SCH_3097.jpg: name 're' is not defined
[HPO]   Val sample 3/30: SCH_3217.jpg
[HPO]   ‚ùå Validation error on SCH_3217.jpg: name 're' is not defined
[HPO]   Val sample 4/30: SCH_2891_185.jpg
[HPO]   ‚ùå Validation error on SCH_2891_185.jpg: name 're' is not defined
[HPO]   Val sample 5/30: SCH_1931.jpg
[HPO]   ‚ùå Validation error on SCH_1931.jpg: name 're' is not defined
[HPO]   Val sample 6/30: SCH_2891_139.jpg
[HPO]   ‚ùå Validation error on SCH_2891_139.jpg: name 're' is not defined
[HPO]   Val sample 7/30: SCH_2891_303.jpg
[HPO]   ‚ùå Validation error on SCH_2891_303.jpg: name 're' is not defined
[HPO]   Val sample 8/30: SCH_3082_recto.jpg
[HPO]   ‚ùå Validation error on SCH_3082_recto.jpg: name 're' is not defined
[HPO]   Val sample 9/30: SCH_3192_15.jpg
[HPO]   ‚ùå Validation error on SCH_3192_15.jpg: name 're' is not defined
[HPO]   Val sample 10/30: SCH_2969.jpg
[HPO]   ‚ùå Validation error on SCH_2969.jpg: name 're' is not defined
[HPO]   Val sample 11/30: SCH_2891_24_a.jpg
[HPO]   ‚ùå Validation error on SCH_2891_24_a.jpg: name 're' is not defined
[HPO]   Val sample 12/30: SCH_3028.jpg
[HPO]   ‚ùå Validation error on SCH_3028.jpg: name 're' is not defined
[HPO]   Val sample 13/30: SCH_3192_34.jpg
[HPO]   ‚ùå Validation error on SCH_3192_34.jpg: name 're' is not defined
[HPO]   Val sample 14/30: SCH_2891_194_195.jpg
[HPO]   ‚ùå Validation error on SCH_2891_194_195.jpg: name 're' is not defined
[HPO]   Val sample 15/30: SCH_3138.jpg
[HPO]   ‚ùå Validation error on SCH_3138.jpg: name 're' is not defined
[HPO]   Val sample 16/30: SCH_2891_216.jpg
[HPO]   ‚ùå Validation error on SCH_2891_216.jpg: name 're' is not defined
[HPO]   Val sample 17/30: SCH_3201.jpg
[HPO]   ‚ùå Validation error on SCH_3201.jpg: name 're' is not defined
[HPO]   Val sample 18/30: SCH_2891_208.jpg
[HPO]   ‚ùå Validation error on SCH_2891_208.jpg: name 're' is not defined
[HPO]   Val sample 19/30: SCH_2079.jpg
[HPO]   ‚ùå Validation error on SCH_2079.jpg: name 're' is not defined
[HPO]   Val sample 20/30: SCH_2891_122.jpg
[HPO]   ‚ùå Validation error on SCH_2891_122.jpg: name 're' is not defined
[HPO]   Val sample 21/30: SCH_3192_24.jpg
[HPO]   ‚ùå Validation error on SCH_3192_24.jpg: name 're' is not defined
[HPO]   Val sample 22/30: SCH_2891_294.jpg
[HPO]   ‚ùå Validation error on SCH_2891_294.jpg: name 're' is not defined
[HPO]   Val sample 23/30: SCH_2891_119.jpg
[HPO]   ‚ùå Validation error on SCH_2891_119.jpg: name 're' is not defined
[HPO]   Val sample 24/30: SCH_3049.jpg
[HPO]   ‚ùå Validation error on SCH_3049.jpg: name 're' is not defined
[HPO]   Val sample 25/30: SCH_2891_269.jpg
[HPO]   ‚ùå Validation error on SCH_2891_269.jpg: name 're' is not defined
[HPO]   Val sample 26/30: SCH_2990.jpg
[HPO]   ‚ùå Validation error on SCH_2990.jpg: name 're' is not defined
[HPO]   Val sample 27/30: SCH_1933.jpg
[HPO]   ‚ùå Validation error on SCH_1933.jpg: name 're' is not defined
[HPO]   Val sample 28/30: SCH_2891_71.jpg
[HPO]   ‚ùå Validation error on SCH_2891_71.jpg: name 're' is not defined
[HPO]   Val sample 29/30: SCH_3121.jpg
[HPO]   ‚ùå Validation error on SCH_3121.jpg: name 're' is not defined
[HPO]   Val sample 30/30: SCH_2891_61.jpg
[HPO]   ‚ùå Validation error on SCH_2891_61.jpg: name 're' is not defined

[HPO]   ‚úÖ Validation CER: 1.0000 (100.00%)


================================================================================
[HPO] GEMMA-3 SCHMUCK TRIAL
================================================================================
[HPO] Trial #5
[HPO] Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/gemma/HPO/schmuck/hpo_run_20251220_060531/trial_005
[HPO]   ‚Ä¢ num_epochs: 5
[HPO]   ‚Ä¢ batch_size: 2
[HPO]   ‚Ä¢ grad_accum: 16
[HPO]   ‚Ä¢ learning_rate: 6.086423540561219e-05
[HPO]   ‚Ä¢ weight_decay: 0.014092422497476265
[HPO]   ‚Ä¢ lora_r: 32
[HPO]   ‚Ä¢ lora_alpha: 16
[HPO]   ‚Ä¢ lora_dropout: 0.1223
Loading Gemma-3 vision model with Unsloth for SCHMUCK...
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Gemma3 patching. Transformers: 4.51.3.
   \\   /|    NVIDIA A100-SXM4-40GB. Num GPUs = 1. Max memory: 39.494 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 8.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Gemma3 does not support SDPA - switching to eager!
Model loaded - Unsloth auto-configured dtype and attention
Unsloth: Making `base_model.model.vision_tower.vision_model` require gradients
Gemma-3 vision model loaded with LoRA (r=32, alpha=16, dropout=0.1223)
Prepared 413 samples (valid images) out of 413 total
[HPO] Training samples: 413
[HPO] GPU = NVIDIA A100-SXM4-40GB. Max memory = 39.494 GB.
[HPO] 12.02 GB of memory reserved before training.
[HPO] Starting Gemma-3 training for this trial...

{'loss': 16.4992, 'grad_norm': 39.79246520996094, 'learning_rate': 6.0401903157109606e-05, 'epoch': 0.77}
{'loss': 1.5336, 'grad_norm': 6.128716945648193, 'learning_rate': 5.256763797707581e-05, 'epoch': 1.62}
{'loss': 0.4301, 'grad_norm': 5.496595859527588, 'learning_rate': 3.7450247025375153e-05, 'epoch': 2.46}
{'loss': 0.2068, 'grad_norm': 1.5417016744613647, 'learning_rate': 2.0023720444388735e-05, 'epoch': 3.31}
{'loss': 0.1614, 'grad_norm': 2.479924201965332, 'learning_rate': 6.02181028873398e-06, 'epoch': 4.15}
{'loss': 0.1134, 'grad_norm': 4.310638904571533, 'learning_rate': 5.148632662328582e-08, 'epoch': 4.93}
{'train_runtime': 2140.4636, 'train_samples_per_second': 0.965, 'train_steps_per_second': 0.028, 'train_loss': 3.1574138681093853, 'epoch': 4.93}
[HPO] Training runtime: 2140.46 s (35.67 min)
[HPO] Peak reserved memory: 12.02 GB

[HPO] === Running validation CER (Gemma-3 SCHMUCK) ===
[HPO] Using 30 validation samples
[HPO]   Val sample 1/30: SCH_1941.jpg
[HPO]   ‚ùå Validation error on SCH_1941.jpg: name 're' is not defined
[HPO]   Val sample 2/30: SCH_3097.jpg
[HPO]   ‚ùå Validation error on SCH_3097.jpg: name 're' is not defined
[HPO]   Val sample 3/30: SCH_3217.jpg
[HPO]   ‚ùå Validation error on SCH_3217.jpg: name 're' is not defined
[HPO]   Val sample 4/30: SCH_2891_185.jpg
[HPO]   ‚ùå Validation error on SCH_2891_185.jpg: name 're' is not defined
[HPO]   Val sample 5/30: SCH_1931.jpg
[HPO]   ‚ùå Validation error on SCH_1931.jpg: name 're' is not defined
[HPO]   Val sample 6/30: SCH_2891_139.jpg
[HPO]   ‚ùå Validation error on SCH_2891_139.jpg: name 're' is not defined
[HPO]   Val sample 7/30: SCH_2891_303.jpg
[HPO]   ‚ùå Validation error on SCH_2891_303.jpg: name 're' is not defined
[HPO]   Val sample 8/30: SCH_3082_recto.jpg
[HPO]   ‚ùå Validation error on SCH_3082_recto.jpg: name 're' is not defined
[HPO]   Val sample 9/30: SCH_3192_15.jpg
[HPO]   ‚ùå Validation error on SCH_3192_15.jpg: name 're' is not defined
[HPO]   Val sample 10/30: SCH_2969.jpg
[HPO]   ‚ùå Validation error on SCH_2969.jpg: name 're' is not defined
[HPO]   Val sample 11/30: SCH_2891_24_a.jpg
[HPO]   ‚ùå Validation error on SCH_2891_24_a.jpg: name 're' is not defined
[HPO]   Val sample 12/30: SCH_3028.jpg
[HPO]   ‚ùå Validation error on SCH_3028.jpg: name 're' is not defined
[HPO]   Val sample 13/30: SCH_3192_34.jpg
[HPO]   ‚ùå Validation error on SCH_3192_34.jpg: name 're' is not defined
[HPO]   Val sample 14/30: SCH_2891_194_195.jpg
[HPO]   ‚ùå Validation error on SCH_2891_194_195.jpg: name 're' is not defined
[HPO]   Val sample 15/30: SCH_3138.jpg
[HPO]   ‚ùå Validation error on SCH_3138.jpg: name 're' is not defined
[HPO]   Val sample 16/30: SCH_2891_216.jpg
[HPO]   ‚ùå Validation error on SCH_2891_216.jpg: name 're' is not defined
[HPO]   Val sample 17/30: SCH_3201.jpg
[HPO]   ‚ùå Validation error on SCH_3201.jpg: name 're' is not defined
[HPO]   Val sample 18/30: SCH_2891_208.jpg
[HPO]   ‚ùå Validation error on SCH_2891_208.jpg: name 're' is not defined
[HPO]   Val sample 19/30: SCH_2079.jpg
[HPO]   ‚ùå Validation error on SCH_2079.jpg: name 're' is not defined
[HPO]   Val sample 20/30: SCH_2891_122.jpg
[HPO]   ‚ùå Validation error on SCH_2891_122.jpg: name 're' is not defined
[HPO]   Val sample 21/30: SCH_3192_24.jpg
[HPO]   ‚ùå Validation error on SCH_3192_24.jpg: name 're' is not defined
[HPO]   Val sample 22/30: SCH_2891_294.jpg
[HPO]   ‚ùå Validation error on SCH_2891_294.jpg: name 're' is not defined
[HPO]   Val sample 23/30: SCH_2891_119.jpg
[HPO]   ‚ùå Validation error on SCH_2891_119.jpg: name 're' is not defined
[HPO]   Val sample 24/30: SCH_3049.jpg
[HPO]   ‚ùå Validation error on SCH_3049.jpg: name 're' is not defined
[HPO]   Val sample 25/30: SCH_2891_269.jpg
[HPO]   ‚ùå Validation error on SCH_2891_269.jpg: name 're' is not defined
[HPO]   Val sample 26/30: SCH_2990.jpg
[HPO]   ‚ùå Validation error on SCH_2990.jpg: name 're' is not defined
[HPO]   Val sample 27/30: SCH_1933.jpg
[HPO]   ‚ùå Validation error on SCH_1933.jpg: name 're' is not defined
[HPO]   Val sample 28/30: SCH_2891_71.jpg
[HPO]   ‚ùå Validation error on SCH_2891_71.jpg: name 're' is not defined
[HPO]   Val sample 29/30: SCH_3121.jpg
[HPO]   ‚ùå Validation error on SCH_3121.jpg: name 're' is not defined
[HPO]   Val sample 30/30: SCH_2891_61.jpg
[HPO]   ‚ùå Validation error on SCH_2891_61.jpg: name 're' is not defined

[HPO]   ‚úÖ Validation CER: 1.0000 (100.00%)


================================================================================
[HPO] GEMMA-3 SCHMUCK TRIAL
================================================================================
[HPO] Trial #6
[HPO] Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/gemma/HPO/schmuck/hpo_run_20251220_060531/trial_006
[HPO]   ‚Ä¢ num_epochs: 5
[HPO]   ‚Ä¢ batch_size: 2
[HPO]   ‚Ä¢ grad_accum: 8
[HPO]   ‚Ä¢ learning_rate: 2.6055622978941292e-05
[HPO]   ‚Ä¢ weight_decay: 0.011586905952512973
[HPO]   ‚Ä¢ lora_r: 8
[HPO]   ‚Ä¢ lora_alpha: 64
[HPO]   ‚Ä¢ lora_dropout: 0.1094
Loading Gemma-3 vision model with Unsloth for SCHMUCK...
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Gemma3 patching. Transformers: 4.51.3.
   \\   /|    NVIDIA A100-SXM4-40GB. Num GPUs = 1. Max memory: 39.494 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 8.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Gemma3 does not support SDPA - switching to eager!
Model loaded - Unsloth auto-configured dtype and attention
Unsloth: Making `base_model.model.vision_tower.vision_model` require gradients
Gemma-3 vision model loaded with LoRA (r=8, alpha=64, dropout=0.1094)
Prepared 413 samples (valid images) out of 413 total
[HPO] Training samples: 413
[HPO] GPU = NVIDIA A100-SXM4-40GB. Max memory = 39.494 GB.
[HPO] 12.02 GB of memory reserved before training.
[HPO] Starting Gemma-3 training for this trial...

{'loss': 10.3956, 'grad_norm': 158.28897094726562, 'learning_rate': 1.8038508216190125e-05, 'epoch': 0.39}
{'loss': 2.1689, 'grad_norm': 53.27191162109375, 'learning_rate': 2.5871553271658645e-05, 'epoch': 0.77}
{'loss': 0.4494, 'grad_norm': 16.360210418701172, 'learning_rate': 2.476546405838514e-05, 'epoch': 1.19}
{'loss': 0.169, 'grad_norm': 10.169885635375977, 'learning_rate': 2.2741897052169317e-05, 'epoch': 1.58}
{'loss': 0.1185, 'grad_norm': 8.045066833496094, 'learning_rate': 1.9959025088664073e-05, 'epoch': 1.97}
{'loss': 0.0783, 'grad_norm': 3.7809605598449707, 'learning_rate': 1.663437234590478e-05, 'epoch': 2.39}
{'loss': 0.0647, 'grad_norm': 14.591705322265625, 'learning_rate': 1.3027811489470646e-05, 'epoch': 2.77}
{'loss': 0.0612, 'grad_norm': 2.7933356761932373, 'learning_rate': 9.421250633036511e-06, 'epoch': 3.19}
{'loss': 0.0367, 'grad_norm': 4.370744228363037, 'learning_rate': 6.0965978902772195e-06, 'epoch': 3.58}
{'loss': 0.035, 'grad_norm': 6.808794975280762, 'learning_rate': 3.3137259267719756e-06, 'epoch': 3.97}
{'loss': 0.0392, 'grad_norm': 2.5720555782318115, 'learning_rate': 1.2901589205561506e-06, 'epoch': 4.39}
{'loss': 0.0278, 'grad_norm': 3.812389612197876, 'learning_rate': 1.8406970728264452e-07, 'epoch': 4.77}
{'train_runtime': 2152.4801, 'train_samples_per_second': 0.959, 'train_steps_per_second': 0.058, 'train_loss': 1.0924054716825484, 'epoch': 4.97}
[HPO] Training runtime: 2152.48 s (35.87 min)
[HPO] Peak reserved memory: 12.02 GB

[HPO] === Running validation CER (Gemma-3 SCHMUCK) ===
[HPO] Using 30 validation samples
[HPO]   Val sample 1/30: SCH_1941.jpg
[HPO]   ‚ùå Validation error on SCH_1941.jpg: name 're' is not defined
[HPO]   Val sample 2/30: SCH_3097.jpg
[HPO]   ‚ùå Validation error on SCH_3097.jpg: name 're' is not defined
[HPO]   Val sample 3/30: SCH_3217.jpg
[HPO]   ‚ùå Validation error on SCH_3217.jpg: name 're' is not defined
[HPO]   Val sample 4/30: SCH_2891_185.jpg
[HPO]   ‚ùå Validation error on SCH_2891_185.jpg: name 're' is not defined
[HPO]   Val sample 5/30: SCH_1931.jpg
[HPO]   ‚ùå Validation error on SCH_1931.jpg: name 're' is not defined
[HPO]   Val sample 6/30: SCH_2891_139.jpg
[HPO]   ‚ùå Validation error on SCH_2891_139.jpg: name 're' is not defined
[HPO]   Val sample 7/30: SCH_2891_303.jpg
[HPO]   ‚ùå Validation error on SCH_2891_303.jpg: name 're' is not defined
[HPO]   Val sample 8/30: SCH_3082_recto.jpg
[HPO]   ‚ùå Validation error on SCH_3082_recto.jpg: name 're' is not defined
[HPO]   Val sample 9/30: SCH_3192_15.jpg
[HPO]   ‚ùå Validation error on SCH_3192_15.jpg: name 're' is not defined
[HPO]   Val sample 10/30: SCH_2969.jpg
[HPO]   ‚ùå Validation error on SCH_2969.jpg: name 're' is not defined
[HPO]   Val sample 11/30: SCH_2891_24_a.jpg
[HPO]   ‚ùå Validation error on SCH_2891_24_a.jpg: name 're' is not defined
[HPO]   Val sample 12/30: SCH_3028.jpg
[HPO]   ‚ùå Validation error on SCH_3028.jpg: name 're' is not defined
[HPO]   Val sample 13/30: SCH_3192_34.jpg
[HPO]   ‚ùå Validation error on SCH_3192_34.jpg: name 're' is not defined
[HPO]   Val sample 14/30: SCH_2891_194_195.jpg
[HPO]   ‚ùå Validation error on SCH_2891_194_195.jpg: name 're' is not defined
[HPO]   Val sample 15/30: SCH_3138.jpg
[HPO]   ‚ùå Validation error on SCH_3138.jpg: name 're' is not defined
[HPO]   Val sample 16/30: SCH_2891_216.jpg
[HPO]   ‚ùå Validation error on SCH_2891_216.jpg: name 're' is not defined
[HPO]   Val sample 17/30: SCH_3201.jpg
[HPO]   ‚ùå Validation error on SCH_3201.jpg: name 're' is not defined
[HPO]   Val sample 18/30: SCH_2891_208.jpg
[HPO]   ‚ùå Validation error on SCH_2891_208.jpg: name 're' is not defined
[HPO]   Val sample 19/30: SCH_2079.jpg
[HPO]   ‚ùå Validation error on SCH_2079.jpg: name 're' is not defined
[HPO]   Val sample 20/30: SCH_2891_122.jpg
[HPO]   ‚ùå Validation error on SCH_2891_122.jpg: name 're' is not defined
[HPO]   Val sample 21/30: SCH_3192_24.jpg
[HPO]   ‚ùå Validation error on SCH_3192_24.jpg: name 're' is not defined
[HPO]   Val sample 22/30: SCH_2891_294.jpg
[HPO]   ‚ùå Validation error on SCH_2891_294.jpg: name 're' is not defined
[HPO]   Val sample 23/30: SCH_2891_119.jpg
[HPO]   ‚ùå Validation error on SCH_2891_119.jpg: name 're' is not defined
[HPO]   Val sample 24/30: SCH_3049.jpg
[HPO]   ‚ùå Validation error on SCH_3049.jpg: name 're' is not defined
[HPO]   Val sample 25/30: SCH_2891_269.jpg
[HPO]   ‚ùå Validation error on SCH_2891_269.jpg: name 're' is not defined
[HPO]   Val sample 26/30: SCH_2990.jpg
[HPO]   ‚ùå Validation error on SCH_2990.jpg: name 're' is not defined
[HPO]   Val sample 27/30: SCH_1933.jpg
[HPO]   ‚ùå Validation error on SCH_1933.jpg: name 're' is not defined
[HPO]   Val sample 28/30: SCH_2891_71.jpg
[HPO]   ‚ùå Validation error on SCH_2891_71.jpg: name 're' is not defined
[HPO]   Val sample 29/30: SCH_3121.jpg
[HPO]   ‚ùå Validation error on SCH_3121.jpg: name 're' is not defined
[HPO]   Val sample 30/30: SCH_2891_61.jpg
[HPO]   ‚ùå Validation error on SCH_2891_61.jpg: name 're' is not defined

[HPO]   ‚úÖ Validation CER: 1.0000 (100.00%)


================================================================================
[HPO] GEMMA-3 SCHMUCK TRIAL
================================================================================
[HPO] Trial #7
[HPO] Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/gemma/HPO/schmuck/hpo_run_20251220_060531/trial_007
[HPO]   ‚Ä¢ num_epochs: 8
[HPO]   ‚Ä¢ batch_size: 2
[HPO]   ‚Ä¢ grad_accum: 8
[HPO]   ‚Ä¢ learning_rate: 0.0001334933337137229
[HPO]   ‚Ä¢ weight_decay: 0.07607850486168975
[HPO]   ‚Ä¢ lora_r: 16
[HPO]   ‚Ä¢ lora_alpha: 16
[HPO]   ‚Ä¢ lora_dropout: 0.0162
Loading Gemma-3 vision model with Unsloth for SCHMUCK...
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Gemma3 patching. Transformers: 4.51.3.
   \\   /|    NVIDIA A100-SXM4-40GB. Num GPUs = 1. Max memory: 39.494 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 8.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Gemma3 does not support SDPA - switching to eager!
Model loaded - Unsloth auto-configured dtype and attention
Unsloth: Making `base_model.model.vision_tower.vision_model` require gradients
Gemma-3 vision model loaded with LoRA (r=16, alpha=16, dropout=0.0162)
Prepared 413 samples (valid images) out of 413 total
[HPO] Training samples: 413
[HPO] GPU = NVIDIA A100-SXM4-40GB. Max memory = 39.494 GB.
[HPO] 12.02 GB of memory reserved before training.
[HPO] Starting Gemma-3 training for this trial...

{'loss': 9.9764, 'grad_norm': 38.16315841674805, 'learning_rate': 6.0072000171175306e-05, 'epoch': 0.39}
{'loss': 1.508, 'grad_norm': 22.22700309753418, 'learning_rate': 0.00012681866702803676, 'epoch': 0.77}
{'loss': 0.2451, 'grad_norm': 27.102985382080078, 'learning_rate': 0.0001326715714849714, 'epoch': 1.19}
{'loss': 0.1168, 'grad_norm': 1.3666754961013794, 'learning_rate': 0.00012985688022936322, 'epoch': 1.58}
{'loss': 0.0952, 'grad_norm': 1.3685669898986816, 'learning_rate': 0.00012512461707574042, 'epoch': 1.97}
{'loss': 0.0555, 'grad_norm': 1.0592806339263916, 'learning_rate': 0.00011861856944538518, 'epoch': 2.39}
{'loss': 0.0524, 'grad_norm': 1.1238905191421509, 'learning_rate': 0.00011053642030332685, 'epoch': 2.77}
{'loss': 0.0486, 'grad_norm': 0.7363443374633789, 'learning_rate': 0.0001011237416614821, 'epoch': 3.19}
{'loss': 0.0293, 'grad_norm': 1.4947806596755981, 'learning_rate': 9.066653299733813e-05, 'epoch': 3.58}
{'loss': 0.0294, 'grad_norm': 1.7065423727035522, 'learning_rate': 7.948253130455211e-05, 'epoch': 3.97}
{'loss': 0.0261, 'grad_norm': 0.6426127552986145, 'learning_rate': 6.791155681518137e-05, 'epoch': 4.39}
{'loss': 0.018, 'grad_norm': 0.47374245524406433, 'learning_rate': 5.630518773388981e-05, 'epoch': 4.77}
{'loss': 0.0159, 'grad_norm': 0.9308696985244751, 'learning_rate': 4.5016077712106414e-05, 'epoch': 5.19}
{'loss': 0.0109, 'grad_norm': 0.7444566488265991, 'learning_rate': 3.4387240645277686e-05, 'epoch': 5.58}
{'loss': 0.0078, 'grad_norm': 0.048086442053318024, 'learning_rate': 2.474162836922819e-05, 'epoch': 5.97}
{'loss': 0.0065, 'grad_norm': 0.35978278517723083, 'learning_rate': 1.6372317932050338e-05, 'epoch': 6.39}
{'loss': 0.004, 'grad_norm': 0.24809123575687408, 'learning_rate': 9.533606596302383e-06, 'epoch': 6.77}
{'loss': 0.003, 'grad_norm': 0.2023967206478119, 'learning_rate': 4.433285145366105e-06, 'epoch': 7.19}
{'loss': 0.0031, 'grad_norm': 0.6246968507766724, 'learning_rate': 1.2263242656410024e-06, 'epoch': 7.58}
{'loss': 0.0025, 'grad_norm': 0.3774314820766449, 'learning_rate': 1.0165840657038314e-08, 'epoch': 7.97}
{'train_runtime': 3450.9947, 'train_samples_per_second': 0.957, 'train_steps_per_second': 0.058, 'train_loss': 0.6127231298107654, 'epoch': 7.97}
[HPO] Training runtime: 3450.99 s (57.52 min)
[HPO] Peak reserved memory: 12.02 GB

[HPO] === Running validation CER (Gemma-3 SCHMUCK) ===
[HPO] Using 30 validation samples
[HPO]   Val sample 1/30: SCH_1941.jpg
[HPO]   ‚ùå Validation error on SCH_1941.jpg: name 're' is not defined
[HPO]   Val sample 2/30: SCH_3097.jpg
[HPO]   ‚ùå Validation error on SCH_3097.jpg: name 're' is not defined
[HPO]   Val sample 3/30: SCH_3217.jpg
[HPO]   ‚ùå Validation error on SCH_3217.jpg: name 're' is not defined
[HPO]   Val sample 4/30: SCH_2891_185.jpg
[HPO]   ‚ùå Validation error on SCH_2891_185.jpg: name 're' is not defined
[HPO]   Val sample 5/30: SCH_1931.jpg
[HPO]   ‚ùå Validation error on SCH_1931.jpg: name 're' is not defined
[HPO]   Val sample 6/30: SCH_2891_139.jpg
[HPO]   ‚ùå Validation error on SCH_2891_139.jpg: name 're' is not defined
[HPO]   Val sample 7/30: SCH_2891_303.jpg
[HPO]   ‚ùå Validation error on SCH_2891_303.jpg: name 're' is not defined
[HPO]   Val sample 8/30: SCH_3082_recto.jpg
[HPO]   ‚ùå Validation error on SCH_3082_recto.jpg: name 're' is not defined
[HPO]   Val sample 9/30: SCH_3192_15.jpg
[HPO]   ‚ùå Validation error on SCH_3192_15.jpg: name 're' is not defined
[HPO]   Val sample 10/30: SCH_2969.jpg
[HPO]   ‚ùå Validation error on SCH_2969.jpg: name 're' is not defined
[HPO]   Val sample 11/30: SCH_2891_24_a.jpg
[HPO]   ‚ùå Validation error on SCH_2891_24_a.jpg: name 're' is not defined
[HPO]   Val sample 12/30: SCH_3028.jpg
[HPO]   ‚ùå Validation error on SCH_3028.jpg: name 're' is not defined
[HPO]   Val sample 13/30: SCH_3192_34.jpg
[HPO]   ‚ùå Validation error on SCH_3192_34.jpg: name 're' is not defined
[HPO]   Val sample 14/30: SCH_2891_194_195.jpg
[HPO]   ‚ùå Validation error on SCH_2891_194_195.jpg: name 're' is not defined
[HPO]   Val sample 15/30: SCH_3138.jpg
[HPO]   ‚ùå Validation error on SCH_3138.jpg: name 're' is not defined
[HPO]   Val sample 16/30: SCH_2891_216.jpg
[HPO]   ‚ùå Validation error on SCH_2891_216.jpg: name 're' is not defined
[HPO]   Val sample 17/30: SCH_3201.jpg
[HPO]   ‚ùå Validation error on SCH_3201.jpg: name 're' is not defined
[HPO]   Val sample 18/30: SCH_2891_208.jpg
[HPO]   ‚ùå Validation error on SCH_2891_208.jpg: name 're' is not defined
[HPO]   Val sample 19/30: SCH_2079.jpg
[HPO]   ‚ùå Validation error on SCH_2079.jpg: name 're' is not defined
[HPO]   Val sample 20/30: SCH_2891_122.jpg
[HPO]   ‚ùå Validation error on SCH_2891_122.jpg: name 're' is not defined
[HPO]   Val sample 21/30: SCH_3192_24.jpg
[HPO]   ‚ùå Validation error on SCH_3192_24.jpg: name 're' is not defined
[HPO]   Val sample 22/30: SCH_2891_294.jpg
[HPO]   ‚ùå Validation error on SCH_2891_294.jpg: name 're' is not defined
[HPO]   Val sample 23/30: SCH_2891_119.jpg
[HPO]   ‚ùå Validation error on SCH_2891_119.jpg: name 're' is not defined
[HPO]   Val sample 24/30: SCH_3049.jpg
[HPO]   ‚ùå Validation error on SCH_3049.jpg: name 're' is not defined
[HPO]   Val sample 25/30: SCH_2891_269.jpg
[HPO]   ‚ùå Validation error on SCH_2891_269.jpg: name 're' is not defined
[HPO]   Val sample 26/30: SCH_2990.jpg
[HPO]   ‚ùå Validation error on SCH_2990.jpg: name 're' is not defined
[HPO]   Val sample 27/30: SCH_1933.jpg
[HPO]   ‚ùå Validation error on SCH_1933.jpg: name 're' is not defined
[HPO]   Val sample 28/30: SCH_2891_71.jpg
[HPO]   ‚ùå Validation error on SCH_2891_71.jpg: name 're' is not defined
[HPO]   Val sample 29/30: SCH_3121.jpg
[HPO]   ‚ùå Validation error on SCH_3121.jpg: name 're' is not defined
[HPO]   Val sample 30/30: SCH_2891_61.jpg
[HPO]   ‚ùå Validation error on SCH_2891_61.jpg: name 're' is not defined

[HPO]   ‚úÖ Validation CER: 1.0000 (100.00%)


================================================================================
[HPO] GEMMA-3 SCHMUCK TRIAL
================================================================================
[HPO] Trial #8
[HPO] Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/gemma/HPO/schmuck/hpo_run_20251220_060531/trial_008
[HPO]   ‚Ä¢ num_epochs: 9
[HPO]   ‚Ä¢ batch_size: 2
[HPO]   ‚Ä¢ grad_accum: 16
[HPO]   ‚Ä¢ learning_rate: 0.00032666526101138684
[HPO]   ‚Ä¢ weight_decay: 0.024929222914887497
[HPO]   ‚Ä¢ lora_r: 16
[HPO]   ‚Ä¢ lora_alpha: 32
[HPO]   ‚Ä¢ lora_dropout: 0.1395
Loading Gemma-3 vision model with Unsloth for SCHMUCK...
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Gemma3 patching. Transformers: 4.51.3.
   \\   /|    NVIDIA A100-SXM4-40GB. Num GPUs = 1. Max memory: 39.494 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 8.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Gemma3 does not support SDPA - switching to eager!
Model loaded - Unsloth auto-configured dtype and attention
Unsloth: Making `base_model.model.vision_tower.vision_model` require gradients
Gemma-3 vision model loaded with LoRA (r=16, alpha=32, dropout=0.1395)
Prepared 413 samples (valid images) out of 413 total
[HPO] Training samples: 413
[HPO] GPU = NVIDIA A100-SXM4-40GB. Max memory = 39.494 GB.
[HPO] 12.02 GB of memory reserved before training.
[HPO] Starting Gemma-3 training for this trial...

{'loss': 10.5855, 'grad_norm': 17.077186584472656, 'learning_rate': 0.0002672715771911347, 'epoch': 0.77}
{'loss': 0.8629, 'grad_norm': 18.18297576904297, 'learning_rate': 0.00032121335668890236, 'epoch': 1.62}
{'loss': 0.5136, 'grad_norm': 26.749658584594727, 'learning_rate': 0.0002996872924269108, 'epoch': 2.46}
{'loss': 0.2211, 'grad_norm': 5.47510290145874, 'learning_rate': 0.0002639828467847801, 'epoch': 3.31}
{'loss': 0.1716, 'grad_norm': 3.376516103744507, 'learning_rate': 0.00021781262657879247, 'epoch': 4.15}
{'loss': 0.1096, 'grad_norm': 3.3546388149261475, 'learning_rate': 0.00016597748702916568, 'epoch': 4.93}
{'loss': 0.0841, 'grad_norm': 2.7135226726531982, 'learning_rate': 0.00011386733096043225, 'epoch': 5.77}
{'loss': 0.0689, 'grad_norm': 2.4657301902770996, 'learning_rate': 6.690065786583252e-05, 'epoch': 6.62}
{'loss': 0.0366, 'grad_norm': 3.287907361984253, 'learning_rate': 2.9961139443194425e-05, 'epoch': 7.46}
{'loss': 0.0303, 'grad_norm': 0.886073648929596, 'learning_rate': 6.889807402144964e-06, 'epoch': 8.31}
{'train_runtime': 3873.6758, 'train_samples_per_second': 0.96, 'train_steps_per_second': 0.028, 'train_loss': 1.175946920144337, 'epoch': 8.93}
[HPO] Training runtime: 3873.68 s (64.56 min)
[HPO] Peak reserved memory: 12.02 GB

[HPO] === Running validation CER (Gemma-3 SCHMUCK) ===
[HPO] Using 30 validation samples
[HPO]   Val sample 1/30: SCH_1941.jpg
[HPO]   ‚ùå Validation error on SCH_1941.jpg: name 're' is not defined
[HPO]   Val sample 2/30: SCH_3097.jpg
[HPO]   ‚ùå Validation error on SCH_3097.jpg: name 're' is not defined
[HPO]   Val sample 3/30: SCH_3217.jpg
[HPO]   ‚ùå Validation error on SCH_3217.jpg: name 're' is not defined
[HPO]   Val sample 4/30: SCH_2891_185.jpg
[HPO]   ‚ùå Validation error on SCH_2891_185.jpg: name 're' is not defined
[HPO]   Val sample 5/30: SCH_1931.jpg
[HPO]   ‚ùå Validation error on SCH_1931.jpg: name 're' is not defined
[HPO]   Val sample 6/30: SCH_2891_139.jpg
[HPO]   ‚ùå Validation error on SCH_2891_139.jpg: name 're' is not defined
[HPO]   Val sample 7/30: SCH_2891_303.jpg
[HPO]   ‚ùå Validation error on SCH_2891_303.jpg: name 're' is not defined
[HPO]   Val sample 8/30: SCH_3082_recto.jpg
[HPO]   ‚ùå Validation error on SCH_3082_recto.jpg: name 're' is not defined
[HPO]   Val sample 9/30: SCH_3192_15.jpg
[HPO]   ‚ùå Validation error on SCH_3192_15.jpg: name 're' is not defined
[HPO]   Val sample 10/30: SCH_2969.jpg
[HPO]   ‚ùå Validation error on SCH_2969.jpg: name 're' is not defined
[HPO]   Val sample 11/30: SCH_2891_24_a.jpg
[HPO]   ‚ùå Validation error on SCH_2891_24_a.jpg: name 're' is not defined
[HPO]   Val sample 12/30: SCH_3028.jpg
[HPO]   ‚ùå Validation error on SCH_3028.jpg: name 're' is not defined
[HPO]   Val sample 13/30: SCH_3192_34.jpg
[HPO]   ‚ùå Validation error on SCH_3192_34.jpg: name 're' is not defined
[HPO]   Val sample 14/30: SCH_2891_194_195.jpg
[HPO]   ‚ùå Validation error on SCH_2891_194_195.jpg: name 're' is not defined
[HPO]   Val sample 15/30: SCH_3138.jpg
[HPO]   ‚ùå Validation error on SCH_3138.jpg: name 're' is not defined
[HPO]   Val sample 16/30: SCH_2891_216.jpg
[HPO]   ‚ùå Validation error on SCH_2891_216.jpg: name 're' is not defined
[HPO]   Val sample 17/30: SCH_3201.jpg
[HPO]   ‚ùå Validation error on SCH_3201.jpg: name 're' is not defined
[HPO]   Val sample 18/30: SCH_2891_208.jpg
[HPO]   ‚ùå Validation error on SCH_2891_208.jpg: name 're' is not defined
[HPO]   Val sample 19/30: SCH_2079.jpg
[HPO]   ‚ùå Validation error on SCH_2079.jpg: name 're' is not defined
[HPO]   Val sample 20/30: SCH_2891_122.jpg
[HPO]   ‚ùå Validation error on SCH_2891_122.jpg: name 're' is not defined
[HPO]   Val sample 21/30: SCH_3192_24.jpg
[HPO]   ‚ùå Validation error on SCH_3192_24.jpg: name 're' is not defined
[HPO]   Val sample 22/30: SCH_2891_294.jpg
[HPO]   ‚ùå Validation error on SCH_2891_294.jpg: name 're' is not defined
[HPO]   Val sample 23/30: SCH_2891_119.jpg
[HPO]   ‚ùå Validation error on SCH_2891_119.jpg: name 're' is not defined
[HPO]   Val sample 24/30: SCH_3049.jpg
[HPO]   ‚ùå Validation error on SCH_3049.jpg: name 're' is not defined
[HPO]   Val sample 25/30: SCH_2891_269.jpg
[HPO]   ‚ùå Validation error on SCH_2891_269.jpg: name 're' is not defined
[HPO]   Val sample 26/30: SCH_2990.jpg
[HPO]   ‚ùå Validation error on SCH_2990.jpg: name 're' is not defined
[HPO]   Val sample 27/30: SCH_1933.jpg
[HPO]   ‚ùå Validation error on SCH_1933.jpg: name 're' is not defined
[HPO]   Val sample 28/30: SCH_2891_71.jpg
[HPO]   ‚ùå Validation error on SCH_2891_71.jpg: name 're' is not defined
[HPO]   Val sample 29/30: SCH_3121.jpg
[HPO]   ‚ùå Validation error on SCH_3121.jpg: name 're' is not defined
[HPO]   Val sample 30/30: SCH_2891_61.jpg
[HPO]   ‚ùå Validation error on SCH_2891_61.jpg: name 're' is not defined

[HPO]   ‚úÖ Validation CER: 1.0000 (100.00%)


================================================================================
[HPO] GEMMA-3 SCHMUCK TRIAL
================================================================================
[HPO] Trial #9
[HPO] Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/gemma/HPO/schmuck/hpo_run_20251220_060531/trial_009
[HPO]   ‚Ä¢ num_epochs: 8
[HPO]   ‚Ä¢ batch_size: 2
[HPO]   ‚Ä¢ grad_accum: 8
[HPO]   ‚Ä¢ learning_rate: 1.1806199622206298e-05
[HPO]   ‚Ä¢ weight_decay: 0.08925589984899779
[HPO]   ‚Ä¢ lora_r: 32
[HPO]   ‚Ä¢ lora_alpha: 16
[HPO]   ‚Ä¢ lora_dropout: 0.0641
Loading Gemma-3 vision model with Unsloth for SCHMUCK...
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Gemma3 patching. Transformers: 4.51.3.
   \\   /|    NVIDIA A100-SXM4-40GB. Num GPUs = 1. Max memory: 39.494 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 8.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Gemma3 does not support SDPA - switching to eager!
Model loaded - Unsloth auto-configured dtype and attention
Unsloth: Making `base_model.model.vision_tower.vision_model` require gradients
Gemma-3 vision model loaded with LoRA (r=32, alpha=16, dropout=0.0641)
Prepared 413 samples (valid images) out of 413 total
[HPO] Training samples: 413
[HPO] GPU = NVIDIA A100-SXM4-40GB. Max memory = 39.494 GB.
[HPO] 12.02 GB of memory reserved before training.
[HPO] Starting Gemma-3 training for this trial...

{'loss': 13.617, 'grad_norm': 120.44698333740234, 'learning_rate': 5.312789829992834e-06, 'epoch': 0.39}
{'loss': 8.8915, 'grad_norm': 42.52619171142578, 'learning_rate': 1.1215889641095982e-05, 'epoch': 0.77}
{'loss': 4.5523, 'grad_norm': 35.34374237060547, 'learning_rate': 1.173352266789909e-05, 'epoch': 1.19}
{'loss': 1.8328, 'grad_norm': 15.806589126586914, 'learning_rate': 1.1484590336117996e-05, 'epoch': 1.58}
{'loss': 0.611, 'grad_norm': 14.325182914733887, 'learning_rate': 1.1066067239104808e-05, 'epoch': 1.97}
{'loss': 0.4848, 'grad_norm': 3.3866841793060303, 'learning_rate': 1.0490669989379368e-05, 'epoch': 2.39}
{'loss': 0.3662, 'grad_norm': 3.016387462615967, 'learning_rate': 9.775881741209527e-06, 'epoch': 2.77}
{'loss': 0.2555, 'grad_norm': 3.073770761489868, 'learning_rate': 8.94342097381562e-06, 'epoch': 3.19}
{'loss': 0.12, 'grad_norm': 2.9042036533355713, 'learning_rate': 8.018581586369433e-06, 'epoch': 3.58}
{'loss': 0.1055, 'grad_norm': 6.5086798667907715, 'learning_rate': 7.029464355667212e-06, 'epoch': 3.97}
{'loss': 0.1241, 'grad_norm': 1.7743462324142456, 'learning_rate': 6.0061231082463735e-06, 'epoch': 4.39}
{'loss': 0.0836, 'grad_norm': 2.3003957271575928, 'learning_rate': 4.979651550074139e-06, 'epoch': 4.77}
{'loss': 0.085, 'grad_norm': 2.3197858333587646, 'learning_rate': 3.981238500025908e-06, 'epoch': 5.19}
{'loss': 0.0827, 'grad_norm': 3.9687228202819824, 'learning_rate': 3.0412202334060077e-06, 'epoch': 5.58}
{'loss': 0.0606, 'grad_norm': 1.5958727598190308, 'learning_rate': 2.1881587295734944e-06, 'epoch': 5.97}
{'loss': 0.0688, 'grad_norm': 1.8203351497650146, 'learning_rate': 1.4479738306523667e-06, 'epoch': 6.39}
{'loss': 0.0635, 'grad_norm': 1.432412028312683, 'learning_rate': 8.431556802447142e-07, 'epoch': 6.77}
{'loss': 0.0683, 'grad_norm': 5.884757995605469, 'learning_rate': 3.9208137179792076e-07, 'epoch': 7.19}
{'loss': 0.0615, 'grad_norm': 2.2861008644104004, 'learning_rate': 1.0845656991952759e-07, 'epoch': 7.58}
{'loss': 0.0538, 'grad_norm': 2.7282521724700928, 'learning_rate': 8.990706935367912e-10, 'epoch': 7.97}
{'train_runtime': 3459.1295, 'train_samples_per_second': 0.955, 'train_steps_per_second': 0.058, 'train_loss': 1.5794295832514762, 'epoch': 7.97}
[HPO] Training runtime: 3459.13 s (57.65 min)
[HPO] Peak reserved memory: 12.02 GB

[HPO] === Running validation CER (Gemma-3 SCHMUCK) ===
[HPO] Using 30 validation samples
[HPO]   Val sample 1/30: SCH_1941.jpg
[HPO]   ‚ùå Validation error on SCH_1941.jpg: name 're' is not defined
[HPO]   Val sample 2/30: SCH_3097.jpg
[HPO]   ‚ùå Validation error on SCH_3097.jpg: name 're' is not defined
[HPO]   Val sample 3/30: SCH_3217.jpg
[HPO]   ‚ùå Validation error on SCH_3217.jpg: name 're' is not defined
[HPO]   Val sample 4/30: SCH_2891_185.jpg
[HPO]   ‚ùå Validation error on SCH_2891_185.jpg: name 're' is not defined
[HPO]   Val sample 5/30: SCH_1931.jpg
[HPO]   ‚ùå Validation error on SCH_1931.jpg: name 're' is not defined
[HPO]   Val sample 6/30: SCH_2891_139.jpg
[HPO]   ‚ùå Validation error on SCH_2891_139.jpg: name 're' is not defined
[HPO]   Val sample 7/30: SCH_2891_303.jpg
[HPO]   ‚ùå Validation error on SCH_2891_303.jpg: name 're' is not defined
[HPO]   Val sample 8/30: SCH_3082_recto.jpg
[HPO]   ‚ùå Validation error on SCH_3082_recto.jpg: name 're' is not defined
[HPO]   Val sample 9/30: SCH_3192_15.jpg
[HPO]   ‚ùå Validation error on SCH_3192_15.jpg: name 're' is not defined
[HPO]   Val sample 10/30: SCH_2969.jpg
[HPO]   ‚ùå Validation error on SCH_2969.jpg: name 're' is not defined
[HPO]   Val sample 11/30: SCH_2891_24_a.jpg
[HPO]   ‚ùå Validation error on SCH_2891_24_a.jpg: name 're' is not defined
[HPO]   Val sample 12/30: SCH_3028.jpg
[HPO]   ‚ùå Validation error on SCH_3028.jpg: name 're' is not defined
[HPO]   Val sample 13/30: SCH_3192_34.jpg
[HPO]   ‚ùå Validation error on SCH_3192_34.jpg: name 're' is not defined
[HPO]   Val sample 14/30: SCH_2891_194_195.jpg
[HPO]   ‚ùå Validation error on SCH_2891_194_195.jpg: name 're' is not defined
[HPO]   Val sample 15/30: SCH_3138.jpg
[HPO]   ‚ùå Validation error on SCH_3138.jpg: name 're' is not defined
[HPO]   Val sample 16/30: SCH_2891_216.jpg
[HPO]   ‚ùå Validation error on SCH_2891_216.jpg: name 're' is not defined
[HPO]   Val sample 17/30: SCH_3201.jpg
[HPO]   ‚ùå Validation error on SCH_3201.jpg: name 're' is not defined
[HPO]   Val sample 18/30: SCH_2891_208.jpg
[HPO]   ‚ùå Validation error on SCH_2891_208.jpg: name 're' is not defined
[HPO]   Val sample 19/30: SCH_2079.jpg
[HPO]   ‚ùå Validation error on SCH_2079.jpg: name 're' is not defined
[HPO]   Val sample 20/30: SCH_2891_122.jpg
[HPO]   ‚ùå Validation error on SCH_2891_122.jpg: name 're' is not defined
[HPO]   Val sample 21/30: SCH_3192_24.jpg
[HPO]   ‚ùå Validation error on SCH_3192_24.jpg: name 're' is not defined
[HPO]   Val sample 22/30: SCH_2891_294.jpg
[HPO]   ‚ùå Validation error on SCH_2891_294.jpg: name 're' is not defined
[HPO]   Val sample 23/30: SCH_2891_119.jpg
[HPO]   ‚ùå Validation error on SCH_2891_119.jpg: name 're' is not defined
[HPO]   Val sample 24/30: SCH_3049.jpg
[HPO]   ‚ùå Validation error on SCH_3049.jpg: name 're' is not defined
[HPO]   Val sample 25/30: SCH_2891_269.jpg
[HPO]   ‚ùå Validation error on SCH_2891_269.jpg: name 're' is not defined
[HPO]   Val sample 26/30: SCH_2990.jpg
[HPO]   ‚ùå Validation error on SCH_2990.jpg: name 're' is not defined
[HPO]   Val sample 27/30: SCH_1933.jpg
[HPO]   ‚ùå Validation error on SCH_1933.jpg: name 're' is not defined
[HPO]   Val sample 28/30: SCH_2891_71.jpg
[HPO]   ‚ùå Validation error on SCH_2891_71.jpg: name 're' is not defined
[HPO]   Val sample 29/30: SCH_3121.jpg
[HPO]   ‚ùå Validation error on SCH_3121.jpg: name 're' is not defined
[HPO]   Val sample 30/30: SCH_2891_61.jpg
[HPO]   ‚ùå Validation error on SCH_2891_61.jpg: name 're' is not defined

[HPO]   ‚úÖ Validation CER: 1.0000 (100.00%)


================================================================================
[HPO] GEMMA-3 SCHMUCK TRIAL
================================================================================
[HPO] Trial #10
[HPO] Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/gemma/HPO/schmuck/hpo_run_20251220_060531/trial_010
[HPO]   ‚Ä¢ num_epochs: 10
[HPO]   ‚Ä¢ batch_size: 2
[HPO]   ‚Ä¢ grad_accum: 16
[HPO]   ‚Ä¢ learning_rate: 1.8595726446578386e-05
[HPO]   ‚Ä¢ weight_decay: 0.08323634113100391
[HPO]   ‚Ä¢ lora_r: 8
[HPO]   ‚Ä¢ lora_alpha: 64
[HPO]   ‚Ä¢ lora_dropout: 0.1208
Loading Gemma-3 vision model with Unsloth for SCHMUCK...
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Gemma3 patching. Transformers: 4.51.3.
   \\   /|    NVIDIA A100-SXM4-40GB. Num GPUs = 1. Max memory: 39.494 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 8.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Gemma3 does not support SDPA - switching to eager!
Model loaded - Unsloth auto-configured dtype and attention
Unsloth: Making `base_model.model.vision_tower.vision_model` require gradients
Gemma-3 vision model loaded with LoRA (r=8, alpha=64, dropout=0.1208)
Prepared 413 samples (valid images) out of 413 total
[HPO] Training samples: 413
[HPO] GPU = NVIDIA A100-SXM4-40GB. Max memory = 39.494 GB.
[HPO] 12.02 GB of memory reserved before training.
[HPO] Starting Gemma-3 training for this trial...

{'loss': 21.7594, 'grad_norm': 232.19122314453125, 'learning_rate': 1.394679483493379e-05, 'epoch': 0.77}
{'loss': 6.1145, 'grad_norm': 185.98634338378906, 'learning_rate': 1.8403638373476286e-05, 'epoch': 1.62}
{'loss': 1.088, 'grad_norm': 18.14091682434082, 'learning_rate': 1.7481855367430732e-05, 'epoch': 2.46}
{'loss': 0.5706, 'grad_norm': 12.400635719299316, 'learning_rate': 1.587244535902199e-05, 'epoch': 3.31}
{'loss': 0.2267, 'grad_norm': 8.153617858886719, 'learning_rate': 1.3710632546925232e-05, 'epoch': 4.15}
{'loss': 0.1407, 'grad_norm': 12.811385154724121, 'learning_rate': 1.1178054552178073e-05, 'epoch': 4.93}
{'loss': 0.1251, 'grad_norm': 8.630033493041992, 'learning_rate': 8.487501048097288e-06, 'epoch': 5.77}
{'loss': 0.0977, 'grad_norm': 8.011404991149902, 'learning_rate': 5.865034964378293e-06, 'epoch': 6.62}
{'loss': 0.0692, 'grad_norm': 4.351057529449463, 'learning_rate': 3.5309984592473334e-06, 'epoch': 7.46}
{'loss': 0.0685, 'grad_norm': 16.930635452270508, 'learning_rate': 1.6814995564124148e-06, 'epoch': 8.31}
{'loss': 0.0605, 'grad_norm': 11.509991645812988, 'learning_rate': 4.719349576336695e-07, 'epoch': 9.15}
{'loss': 0.0507, 'grad_norm': 9.417415618896484, 'learning_rate': 3.933460272322564e-09, 'epoch': 9.93}
{'train_runtime': 4313.2592, 'train_samples_per_second': 0.958, 'train_steps_per_second': 0.028, 'train_loss': 2.5309726357460023, 'epoch': 9.93}
[HPO] Training runtime: 4313.26 s (71.89 min)
[HPO] Peak reserved memory: 12.02 GB

[HPO] === Running validation CER (Gemma-3 SCHMUCK) ===
[HPO] Using 30 validation samples
[HPO]   Val sample 1/30: SCH_1941.jpg
[HPO]   ‚ùå Validation error on SCH_1941.jpg: name 're' is not defined
[HPO]   Val sample 2/30: SCH_3097.jpg
[HPO]   ‚ùå Validation error on SCH_3097.jpg: name 're' is not defined
[HPO]   Val sample 3/30: SCH_3217.jpg
[HPO]   ‚ùå Validation error on SCH_3217.jpg: name 're' is not defined
[HPO]   Val sample 4/30: SCH_2891_185.jpg
[HPO]   ‚ùå Validation error on SCH_2891_185.jpg: name 're' is not defined
[HPO]   Val sample 5/30: SCH_1931.jpg
[HPO]   ‚ùå Validation error on SCH_1931.jpg: name 're' is not defined
[HPO]   Val sample 6/30: SCH_2891_139.jpg
[HPO]   ‚ùå Validation error on SCH_2891_139.jpg: name 're' is not defined
[HPO]   Val sample 7/30: SCH_2891_303.jpg
[HPO]   ‚ùå Validation error on SCH_2891_303.jpg: name 're' is not defined
[HPO]   Val sample 8/30: SCH_3082_recto.jpg
[HPO]   ‚ùå Validation error on SCH_3082_recto.jpg: name 're' is not defined
[HPO]   Val sample 9/30: SCH_3192_15.jpg
[HPO]   ‚ùå Validation error on SCH_3192_15.jpg: name 're' is not defined
[HPO]   Val sample 10/30: SCH_2969.jpg
[HPO]   ‚ùå Validation error on SCH_2969.jpg: name 're' is not defined
[HPO]   Val sample 11/30: SCH_2891_24_a.jpg
[HPO]   ‚ùå Validation error on SCH_2891_24_a.jpg: name 're' is not defined
[HPO]   Val sample 12/30: SCH_3028.jpg
[HPO]   ‚ùå Validation error on SCH_3028.jpg: name 're' is not defined
[HPO]   Val sample 13/30: SCH_3192_34.jpg
[HPO]   ‚ùå Validation error on SCH_3192_34.jpg: name 're' is not defined
[HPO]   Val sample 14/30: SCH_2891_194_195.jpg
[HPO]   ‚ùå Validation error on SCH_2891_194_195.jpg: name 're' is not defined
[HPO]   Val sample 15/30: SCH_3138.jpg
[HPO]   ‚ùå Validation error on SCH_3138.jpg: name 're' is not defined
[HPO]   Val sample 16/30: SCH_2891_216.jpg
[HPO]   ‚ùå Validation error on SCH_2891_216.jpg: name 're' is not defined
[HPO]   Val sample 17/30: SCH_3201.jpg
[HPO]   ‚ùå Validation error on SCH_3201.jpg: name 're' is not defined
[HPO]   Val sample 18/30: SCH_2891_208.jpg
[HPO]   ‚ùå Validation error on SCH_2891_208.jpg: name 're' is not defined
[HPO]   Val sample 19/30: SCH_2079.jpg
[HPO]   ‚ùå Validation error on SCH_2079.jpg: name 're' is not defined
[HPO]   Val sample 20/30: SCH_2891_122.jpg
[HPO]   ‚ùå Validation error on SCH_2891_122.jpg: name 're' is not defined
[HPO]   Val sample 21/30: SCH_3192_24.jpg
[HPO]   ‚ùå Validation error on SCH_3192_24.jpg: name 're' is not defined
[HPO]   Val sample 22/30: SCH_2891_294.jpg
[HPO]   ‚ùå Validation error on SCH_2891_294.jpg: name 're' is not defined
[HPO]   Val sample 23/30: SCH_2891_119.jpg
[HPO]   ‚ùå Validation error on SCH_2891_119.jpg: name 're' is not defined
[HPO]   Val sample 24/30: SCH_3049.jpg
[HPO]   ‚ùå Validation error on SCH_3049.jpg: name 're' is not defined
[HPO]   Val sample 25/30: SCH_2891_269.jpg
[HPO]   ‚ùå Validation error on SCH_2891_269.jpg: name 're' is not defined
[HPO]   Val sample 26/30: SCH_2990.jpg
[HPO]   ‚ùå Validation error on SCH_2990.jpg: name 're' is not defined
[HPO]   Val sample 27/30: SCH_1933.jpg
[HPO]   ‚ùå Validation error on SCH_1933.jpg: name 're' is not defined
[HPO]   Val sample 28/30: SCH_2891_71.jpg
[HPO]   ‚ùå Validation error on SCH_2891_71.jpg: name 're' is not defined
[HPO]   Val sample 29/30: SCH_3121.jpg
[HPO]   ‚ùå Validation error on SCH_3121.jpg: name 're' is not defined
[HPO]   Val sample 30/30: SCH_2891_61.jpg
[HPO]   ‚ùå Validation error on SCH_2891_61.jpg: name 're' is not defined

[HPO]   ‚úÖ Validation CER: 1.0000 (100.00%)


================================================================================
[HPO] GEMMA-3 SCHMUCK TRIAL
================================================================================
[HPO] Trial #11
[HPO] Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/gemma/HPO/schmuck/hpo_run_20251220_060531/trial_011
[HPO]   ‚Ä¢ num_epochs: 7
[HPO]   ‚Ä¢ batch_size: 2
[HPO]   ‚Ä¢ grad_accum: 16
[HPO]   ‚Ä¢ learning_rate: 5.630450526188074e-06
[HPO]   ‚Ä¢ weight_decay: 0.02791238625098081
[HPO]   ‚Ä¢ lora_r: 32
[HPO]   ‚Ä¢ lora_alpha: 64
[HPO]   ‚Ä¢ lora_dropout: 0.0503
Loading Gemma-3 vision model with Unsloth for SCHMUCK...
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Gemma3 patching. Transformers: 4.51.3.
   \\   /|    NVIDIA A100-SXM4-40GB. Num GPUs = 1. Max memory: 39.494 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 8.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Gemma3 does not support SDPA - switching to eager!
Model loaded - Unsloth auto-configured dtype and attention
Unsloth: Making `base_model.model.vision_tower.vision_model` require gradients
Gemma-3 vision model loaded with LoRA (r=32, alpha=64, dropout=0.0503)
Prepared 413 samples (valid images) out of 413 total
[HPO] Training samples: 413
[HPO] GPU = NVIDIA A100-SXM4-40GB. Max memory = 39.494 GB.
[HPO] 12.02 GB of memory reserved before training.
[HPO] Starting Gemma-3 training for this trial...

{'loss': 23.0602, 'grad_norm': 381.29742431640625, 'learning_rate': 5.630450526188074e-06, 'epoch': 0.77}
{'loss': 8.65, 'grad_norm': 148.01568603515625, 'learning_rate': 5.38706151443429e-06, 'epoch': 1.62}
{'loss': 2.3091, 'grad_norm': 47.27677917480469, 'learning_rate': 4.6989786504249264e-06, 'epoch': 2.46}
{'loss': 0.9838, 'grad_norm': 19.21666145324707, 'learning_rate': 3.6851777123837774e-06, 'epoch': 3.31}
{'loss': 0.8474, 'grad_norm': 44.6356315612793, 'learning_rate': 2.5209540925905425e-06, 'epoch': 4.15}
{'loss': 0.6471, 'grad_norm': 48.548213958740234, 'learning_rate': 1.4076126315470192e-06, 'epoch': 4.93}
{'loss': 0.5939, 'grad_norm': 15.949860572814941, 'learning_rate': 5.376601822572789e-07, 'epoch': 5.77}
{'loss': 0.5182, 'grad_norm': 13.064311027526855, 'learning_rate': 6.151942647340782e-08, 'epoch': 6.62}
{'train_runtime': 2995.2927, 'train_samples_per_second': 0.965, 'train_steps_per_second': 0.028, 'train_loss': 4.498906088726861, 'epoch': 6.93}
[HPO] Training runtime: 2995.29 s (49.92 min)
[HPO] Peak reserved memory: 12.02 GB

[HPO] === Running validation CER (Gemma-3 SCHMUCK) ===
[HPO] Using 30 validation samples
[HPO]   Val sample 1/30: SCH_1941.jpg
[HPO]   ‚ùå Validation error on SCH_1941.jpg: name 're' is not defined
[HPO]   Val sample 2/30: SCH_3097.jpg
[HPO]   ‚ùå Validation error on SCH_3097.jpg: name 're' is not defined
[HPO]   Val sample 3/30: SCH_3217.jpg
[HPO]   ‚ùå Validation error on SCH_3217.jpg: name 're' is not defined
[HPO]   Val sample 4/30: SCH_2891_185.jpg
[HPO]   ‚ùå Validation error on SCH_2891_185.jpg: name 're' is not defined
[HPO]   Val sample 5/30: SCH_1931.jpg
[HPO]   ‚ùå Validation error on SCH_1931.jpg: name 're' is not defined
[HPO]   Val sample 6/30: SCH_2891_139.jpg
[HPO]   ‚ùå Validation error on SCH_2891_139.jpg: name 're' is not defined
[HPO]   Val sample 7/30: SCH_2891_303.jpg
[HPO]   ‚ùå Validation error on SCH_2891_303.jpg: name 're' is not defined
[HPO]   Val sample 8/30: SCH_3082_recto.jpg
[HPO]   ‚ùå Validation error on SCH_3082_recto.jpg: name 're' is not defined
[HPO]   Val sample 9/30: SCH_3192_15.jpg
[HPO]   ‚ùå Validation error on SCH_3192_15.jpg: name 're' is not defined
[HPO]   Val sample 10/30: SCH_2969.jpg
[HPO]   ‚ùå Validation error on SCH_2969.jpg: name 're' is not defined
[HPO]   Val sample 11/30: SCH_2891_24_a.jpg
[HPO]   ‚ùå Validation error on SCH_2891_24_a.jpg: name 're' is not defined
[HPO]   Val sample 12/30: SCH_3028.jpg
[HPO]   ‚ùå Validation error on SCH_3028.jpg: name 're' is not defined
[HPO]   Val sample 13/30: SCH_3192_34.jpg
[HPO]   ‚ùå Validation error on SCH_3192_34.jpg: name 're' is not defined
[HPO]   Val sample 14/30: SCH_2891_194_195.jpg
[HPO]   ‚ùå Validation error on SCH_2891_194_195.jpg: name 're' is not defined
[HPO]   Val sample 15/30: SCH_3138.jpg
[HPO]   ‚ùå Validation error on SCH_3138.jpg: name 're' is not defined
[HPO]   Val sample 16/30: SCH_2891_216.jpg
[HPO]   ‚ùå Validation error on SCH_2891_216.jpg: name 're' is not defined
[HPO]   Val sample 17/30: SCH_3201.jpg
[HPO]   ‚ùå Validation error on SCH_3201.jpg: name 're' is not defined
[HPO]   Val sample 18/30: SCH_2891_208.jpg
[HPO]   ‚ùå Validation error on SCH_2891_208.jpg: name 're' is not defined
[HPO]   Val sample 19/30: SCH_2079.jpg
[HPO]   ‚ùå Validation error on SCH_2079.jpg: name 're' is not defined
[HPO]   Val sample 20/30: SCH_2891_122.jpg
[HPO]   ‚ùå Validation error on SCH_2891_122.jpg: name 're' is not defined
[HPO]   Val sample 21/30: SCH_3192_24.jpg
[HPO]   ‚ùå Validation error on SCH_3192_24.jpg: name 're' is not defined
[HPO]   Val sample 22/30: SCH_2891_294.jpg
[HPO]   ‚ùå Validation error on SCH_2891_294.jpg: name 're' is not defined
[HPO]   Val sample 23/30: SCH_2891_119.jpg
[HPO]   ‚ùå Validation error on SCH_2891_119.jpg: name 're' is not defined
[HPO]   Val sample 24/30: SCH_3049.jpg
[HPO]   ‚ùå Validation error on SCH_3049.jpg: name 're' is not defined
[HPO]   Val sample 25/30: SCH_2891_269.jpg
[HPO]   ‚ùå Validation error on SCH_2891_269.jpg: name 're' is not defined
[HPO]   Val sample 26/30: SCH_2990.jpg
[HPO]   ‚ùå Validation error on SCH_2990.jpg: name 're' is not defined
[HPO]   Val sample 27/30: SCH_1933.jpg
[HPO]   ‚ùå Validation error on SCH_1933.jpg: name 're' is not defined
[HPO]   Val sample 28/30: SCH_2891_71.jpg
[HPO]   ‚ùå Validation error on SCH_2891_71.jpg: name 're' is not defined
[HPO]   Val sample 29/30: SCH_3121.jpg
[HPO]   ‚ùå Validation error on SCH_3121.jpg: name 're' is not defined
[HPO]   Val sample 30/30: SCH_2891_61.jpg
[HPO]   ‚ùå Validation error on SCH_2891_61.jpg: name 're' is not defined

[HPO]   ‚úÖ Validation CER: 1.0000 (100.00%)


================================================================================
[HPO] GEMMA-3 SCHMUCK TRIAL
================================================================================
[HPO] Trial #12
[HPO] Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/gemma/HPO/schmuck/hpo_run_20251220_060531/trial_012
[HPO]   ‚Ä¢ num_epochs: 9
[HPO]   ‚Ä¢ batch_size: 2
[HPO]   ‚Ä¢ grad_accum: 16
[HPO]   ‚Ä¢ learning_rate: 1.5955550272883035e-05
[HPO]   ‚Ä¢ weight_decay: 0.007732551342561815
[HPO]   ‚Ä¢ lora_r: 16
[HPO]   ‚Ä¢ lora_alpha: 64
[HPO]   ‚Ä¢ lora_dropout: 0.0034
Loading Gemma-3 vision model with Unsloth for SCHMUCK...
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Gemma3 patching. Transformers: 4.51.3.
   \\   /|    NVIDIA A100-SXM4-40GB. Num GPUs = 1. Max memory: 39.494 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 8.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Gemma3 does not support SDPA - switching to eager!
Model loaded - Unsloth auto-configured dtype and attention
Unsloth: Making `base_model.model.vision_tower.vision_model` require gradients
Gemma-3 vision model loaded with LoRA (r=16, alpha=64, dropout=0.0034)
Prepared 413 samples (valid images) out of 413 total
[HPO] Training samples: 413
[HPO] GPU = NVIDIA A100-SXM4-40GB. Max memory = 39.494 GB.
[HPO] 12.02 GB of memory reserved before training.
[HPO] Starting Gemma-3 training for this trial...

{'loss': 20.8331, 'grad_norm': 258.6055908203125, 'learning_rate': 1.3054541132358848e-05, 'epoch': 0.77}
{'loss': 4.7729, 'grad_norm': 72.80352783203125, 'learning_rate': 1.5689258922431427e-05, 'epoch': 1.62}
{'loss': 0.9316, 'grad_norm': 15.008783340454102, 'learning_rate': 1.4637845621102317e-05, 'epoch': 2.46}
{'loss': 0.3799, 'grad_norm': 13.284719467163086, 'learning_rate': 1.2893907267680102e-05, 'epoch': 3.31}
{'loss': 0.1863, 'grad_norm': 7.251123428344727, 'learning_rate': 1.0638781432365044e-05, 'epoch': 4.15}
{'loss': 0.1114, 'grad_norm': 9.838025093078613, 'learning_rate': 8.106959798116801e-06, 'epoch': 4.93}
{'loss': 0.097, 'grad_norm': 89.95320129394531, 'learning_rate': 5.561705330873421e-06, 'epoch': 5.77}
{'loss': 0.0794, 'grad_norm': 3.9714460372924805, 'learning_rate': 3.2676777645787995e-06, 'epoch': 6.62}
{'loss': 0.0537, 'grad_norm': 6.815894603729248, 'learning_rate': 1.4634138479820902e-06, 'epoch': 7.46}
{'loss': 0.0607, 'grad_norm': 11.080193519592285, 'learning_rate': 3.3652390228164996e-07, 'epoch': 8.31}
{'train_runtime': 3868.6159, 'train_samples_per_second': 0.961, 'train_steps_per_second': 0.028, 'train_loss': 2.5499237872384213, 'epoch': 8.93}
[HPO] Training runtime: 3868.62 s (64.48 min)
[HPO] Peak reserved memory: 12.02 GB

[HPO] === Running validation CER (Gemma-3 SCHMUCK) ===
[HPO] Using 30 validation samples
[HPO]   Val sample 1/30: SCH_1941.jpg
[HPO]   ‚ùå Validation error on SCH_1941.jpg: name 're' is not defined
[HPO]   Val sample 2/30: SCH_3097.jpg
[HPO]   ‚ùå Validation error on SCH_3097.jpg: name 're' is not defined
[HPO]   Val sample 3/30: SCH_3217.jpg
[HPO]   ‚ùå Validation error on SCH_3217.jpg: name 're' is not defined
[HPO]   Val sample 4/30: SCH_2891_185.jpg
[HPO]   ‚ùå Validation error on SCH_2891_185.jpg: name 're' is not defined
[HPO]   Val sample 5/30: SCH_1931.jpg
[HPO]   ‚ùå Validation error on SCH_1931.jpg: name 're' is not defined
[HPO]   Val sample 6/30: SCH_2891_139.jpg
[HPO]   ‚ùå Validation error on SCH_2891_139.jpg: name 're' is not defined
[HPO]   Val sample 7/30: SCH_2891_303.jpg
[HPO]   ‚ùå Validation error on SCH_2891_303.jpg: name 're' is not defined
[HPO]   Val sample 8/30: SCH_3082_recto.jpg
[HPO]   ‚ùå Validation error on SCH_3082_recto.jpg: name 're' is not defined
[HPO]   Val sample 9/30: SCH_3192_15.jpg
[HPO]   ‚ùå Validation error on SCH_3192_15.jpg: name 're' is not defined
[HPO]   Val sample 10/30: SCH_2969.jpg
[HPO]   ‚ùå Validation error on SCH_2969.jpg: name 're' is not defined
[HPO]   Val sample 11/30: SCH_2891_24_a.jpg
[HPO]   ‚ùå Validation error on SCH_2891_24_a.jpg: name 're' is not defined
[HPO]   Val sample 12/30: SCH_3028.jpg
[HPO]   ‚ùå Validation error on SCH_3028.jpg: name 're' is not defined
[HPO]   Val sample 13/30: SCH_3192_34.jpg
[HPO]   ‚ùå Validation error on SCH_3192_34.jpg: name 're' is not defined
[HPO]   Val sample 14/30: SCH_2891_194_195.jpg
[HPO]   ‚ùå Validation error on SCH_2891_194_195.jpg: name 're' is not defined
[HPO]   Val sample 15/30: SCH_3138.jpg
[HPO]   ‚ùå Validation error on SCH_3138.jpg: name 're' is not defined
[HPO]   Val sample 16/30: SCH_2891_216.jpg
[HPO]   ‚ùå Validation error on SCH_2891_216.jpg: name 're' is not defined
[HPO]   Val sample 17/30: SCH_3201.jpg
[HPO]   ‚ùå Validation error on SCH_3201.jpg: name 're' is not defined
[HPO]   Val sample 18/30: SCH_2891_208.jpg
[HPO]   ‚ùå Validation error on SCH_2891_208.jpg: name 're' is not defined
[HPO]   Val sample 19/30: SCH_2079.jpg
[HPO]   ‚ùå Validation error on SCH_2079.jpg: name 're' is not defined
[HPO]   Val sample 20/30: SCH_2891_122.jpg
[HPO]   ‚ùå Validation error on SCH_2891_122.jpg: name 're' is not defined
[HPO]   Val sample 21/30: SCH_3192_24.jpg
[HPO]   ‚ùå Validation error on SCH_3192_24.jpg: name 're' is not defined
[HPO]   Val sample 22/30: SCH_2891_294.jpg
[HPO]   ‚ùå Validation error on SCH_2891_294.jpg: name 're' is not defined
[HPO]   Val sample 23/30: SCH_2891_119.jpg
[HPO]   ‚ùå Validation error on SCH_2891_119.jpg: name 're' is not defined
[HPO]   Val sample 24/30: SCH_3049.jpg
[HPO]   ‚ùå Validation error on SCH_3049.jpg: name 're' is not defined
[HPO]   Val sample 25/30: SCH_2891_269.jpg
[HPO]   ‚ùå Validation error on SCH_2891_269.jpg: name 're' is not defined
[HPO]   Val sample 26/30: SCH_2990.jpg
[HPO]   ‚ùå Validation error on SCH_2990.jpg: name 're' is not defined
[HPO]   Val sample 27/30: SCH_1933.jpg
[HPO]   ‚ùå Validation error on SCH_1933.jpg: name 're' is not defined
[HPO]   Val sample 28/30: SCH_2891_71.jpg
[HPO]   ‚ùå Validation error on SCH_2891_71.jpg: name 're' is not defined
[HPO]   Val sample 29/30: SCH_3121.jpg
[HPO]   ‚ùå Validation error on SCH_3121.jpg: name 're' is not defined
[HPO]   Val sample 30/30: SCH_2891_61.jpg
[HPO]   ‚ùå Validation error on SCH_2891_61.jpg: name 're' is not defined

[HPO]   ‚úÖ Validation CER: 1.0000 (100.00%)


================================================================================
[HPO] GEMMA-3 SCHMUCK TRIAL
================================================================================
[HPO] Trial #13
[HPO] Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/gemma/HPO/schmuck/hpo_run_20251220_060531/trial_013
[HPO]   ‚Ä¢ num_epochs: 10
[HPO]   ‚Ä¢ batch_size: 2
[HPO]   ‚Ä¢ grad_accum: 16
[HPO]   ‚Ä¢ learning_rate: 0.00010216598910791735
[HPO]   ‚Ä¢ weight_decay: 0.09779403899210293
[HPO]   ‚Ä¢ lora_r: 8
[HPO]   ‚Ä¢ lora_alpha: 64
[HPO]   ‚Ä¢ lora_dropout: 0.0486
Loading Gemma-3 vision model with Unsloth for SCHMUCK...
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Gemma3 patching. Transformers: 4.51.3.
   \\   /|    NVIDIA A100-SXM4-40GB. Num GPUs = 1. Max memory: 39.494 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 8.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Gemma3 does not support SDPA - switching to eager!
Model loaded - Unsloth auto-configured dtype and attention
Unsloth: Making `base_model.model.vision_tower.vision_model` require gradients
Gemma-3 vision model loaded with LoRA (r=8, alpha=64, dropout=0.0486)
Prepared 413 samples (valid images) out of 413 total
[HPO] Training samples: 413
[HPO] GPU = NVIDIA A100-SXM4-40GB. Max memory = 39.494 GB.
[HPO] 12.02 GB of memory reserved before training.
[HPO] Starting Gemma-3 training for this trial...

{'loss': 13.7664, 'grad_norm': 86.68746948242188, 'learning_rate': 7.662449183093801e-05, 'epoch': 0.77}
{'loss': 0.7366, 'grad_norm': 44.038150787353516, 'learning_rate': 0.00010111064620207885, 'epoch': 1.62}
{'loss': 0.1947, 'grad_norm': 6.6586689949035645, 'learning_rate': 9.604631742599914e-05, 'epoch': 2.46}
{'loss': 0.1242, 'grad_norm': 10.426472663879395, 'learning_rate': 8.720412640637833e-05, 'epoch': 3.31}
{'loss': 0.0912, 'grad_norm': 14.911782264709473, 'learning_rate': 7.532700265708417e-05, 'epoch': 4.15}
{'loss': 0.0604, 'grad_norm': 12.341527938842773, 'learning_rate': 6.141287370011092e-05, 'epoch': 4.93}
{'loss': 0.0522, 'grad_norm': 5.953487873077393, 'learning_rate': 4.6630818221833826e-05, 'epoch': 5.77}
{'loss': 0.0418, 'grad_norm': 5.2868757247924805, 'learning_rate': 3.222283894149676e-05, 'epoch': 6.62}
{'loss': 0.0241, 'grad_norm': 3.3522238731384277, 'learning_rate': 1.9399508331330268e-05, 'epoch': 7.46}
{'loss': 0.0238, 'grad_norm': 4.247738361358643, 'learning_rate': 9.238255136679985e-06, 'epoch': 8.31}
{'loss': 0.0108, 'grad_norm': 1.7926573753356934, 'learning_rate': 2.592837761932049e-06, 'epoch': 9.15}
{'loss': 0.0063, 'grad_norm': 4.66262149810791, 'learning_rate': 2.1610656646999453e-08, 'epoch': 9.93}
{'train_runtime': 4348.5388, 'train_samples_per_second': 0.95, 'train_steps_per_second': 0.028, 'train_loss': 1.2610565504059195, 'epoch': 9.93}
[HPO] Training runtime: 4348.54 s (72.48 min)
[HPO] Peak reserved memory: 12.02 GB

[HPO] === Running validation CER (Gemma-3 SCHMUCK) ===
[HPO] Using 30 validation samples
[HPO]   Val sample 1/30: SCH_1941.jpg
[HPO]   ‚ùå Validation error on SCH_1941.jpg: name 're' is not defined
[HPO]   Val sample 2/30: SCH_3097.jpg
[HPO]   ‚ùå Validation error on SCH_3097.jpg: name 're' is not defined
[HPO]   Val sample 3/30: SCH_3217.jpg
[HPO]   ‚ùå Validation error on SCH_3217.jpg: name 're' is not defined
[HPO]   Val sample 4/30: SCH_2891_185.jpg
[HPO]   ‚ùå Validation error on SCH_2891_185.jpg: name 're' is not defined
[HPO]   Val sample 5/30: SCH_1931.jpg
[HPO]   ‚ùå Validation error on SCH_1931.jpg: name 're' is not defined
[HPO]   Val sample 6/30: SCH_2891_139.jpg
[HPO]   ‚ùå Validation error on SCH_2891_139.jpg: name 're' is not defined
[HPO]   Val sample 7/30: SCH_2891_303.jpg
[HPO]   ‚ùå Validation error on SCH_2891_303.jpg: name 're' is not defined
[HPO]   Val sample 8/30: SCH_3082_recto.jpg
[HPO]   ‚ùå Validation error on SCH_3082_recto.jpg: name 're' is not defined
[HPO]   Val sample 9/30: SCH_3192_15.jpg
[HPO]   ‚ùå Validation error on SCH_3192_15.jpg: name 're' is not defined
[HPO]   Val sample 10/30: SCH_2969.jpg
[HPO]   ‚ùå Validation error on SCH_2969.jpg: name 're' is not defined
[HPO]   Val sample 11/30: SCH_2891_24_a.jpg
[HPO]   ‚ùå Validation error on SCH_2891_24_a.jpg: name 're' is not defined
[HPO]   Val sample 12/30: SCH_3028.jpg
[HPO]   ‚ùå Validation error on SCH_3028.jpg: name 're' is not defined
[HPO]   Val sample 13/30: SCH_3192_34.jpg
[HPO]   ‚ùå Validation error on SCH_3192_34.jpg: name 're' is not defined
[HPO]   Val sample 14/30: SCH_2891_194_195.jpg
[HPO]   ‚ùå Validation error on SCH_2891_194_195.jpg: name 're' is not defined
[HPO]   Val sample 15/30: SCH_3138.jpg
[HPO]   ‚ùå Validation error on SCH_3138.jpg: name 're' is not defined
[HPO]   Val sample 16/30: SCH_2891_216.jpg
[HPO]   ‚ùå Validation error on SCH_2891_216.jpg: name 're' is not defined
[HPO]   Val sample 17/30: SCH_3201.jpg
[HPO]   ‚ùå Validation error on SCH_3201.jpg: name 're' is not defined
[HPO]   Val sample 18/30: SCH_2891_208.jpg
[HPO]   ‚ùå Validation error on SCH_2891_208.jpg: name 're' is not defined
[HPO]   Val sample 19/30: SCH_2079.jpg
[HPO]   ‚ùå Validation error on SCH_2079.jpg: name 're' is not defined
[HPO]   Val sample 20/30: SCH_2891_122.jpg
[HPO]   ‚ùå Validation error on SCH_2891_122.jpg: name 're' is not defined
[HPO]   Val sample 21/30: SCH_3192_24.jpg
[HPO]   ‚ùå Validation error on SCH_3192_24.jpg: name 're' is not defined
[HPO]   Val sample 22/30: SCH_2891_294.jpg
[HPO]   ‚ùå Validation error on SCH_2891_294.jpg: name 're' is not defined
[HPO]   Val sample 23/30: SCH_2891_119.jpg
[HPO]   ‚ùå Validation error on SCH_2891_119.jpg: name 're' is not defined
[HPO]   Val sample 24/30: SCH_3049.jpg
[HPO]   ‚ùå Validation error on SCH_3049.jpg: name 're' is not defined
[HPO]   Val sample 25/30: SCH_2891_269.jpg
[HPO]   ‚ùå Validation error on SCH_2891_269.jpg: name 're' is not defined
[HPO]   Val sample 26/30: SCH_2990.jpg
[HPO]   ‚ùå Validation error on SCH_2990.jpg: name 're' is not defined
[HPO]   Val sample 27/30: SCH_1933.jpg
[HPO]   ‚ùå Validation error on SCH_1933.jpg: name 're' is not defined
[HPO]   Val sample 28/30: SCH_2891_71.jpg
[HPO]   ‚ùå Validation error on SCH_2891_71.jpg: name 're' is not defined
[HPO]   Val sample 29/30: SCH_3121.jpg
[HPO]   ‚ùå Validation error on SCH_3121.jpg: name 're' is not defined
[HPO]   Val sample 30/30: SCH_2891_61.jpg
[HPO]   ‚ùå Validation error on SCH_2891_61.jpg: name 're' is not defined

[HPO]   ‚úÖ Validation CER: 1.0000 (100.00%)


================================================================================
[HPO] GEMMA-3 SCHMUCK TRIAL
================================================================================
[HPO] Trial #14
[HPO] Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/gemma/HPO/schmuck/hpo_run_20251220_060531/trial_014
[HPO]   ‚Ä¢ num_epochs: 10
[HPO]   ‚Ä¢ batch_size: 2
[HPO]   ‚Ä¢ grad_accum: 16
[HPO]   ‚Ä¢ learning_rate: 7.833361432996899e-06
[HPO]   ‚Ä¢ weight_decay: 0.05380155247278
[HPO]   ‚Ä¢ lora_r: 32
[HPO]   ‚Ä¢ lora_alpha: 64
[HPO]   ‚Ä¢ lora_dropout: 0.0064
Loading Gemma-3 vision model with Unsloth for SCHMUCK...
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Gemma3 patching. Transformers: 4.51.3.
   \\   /|    NVIDIA A100-SXM4-40GB. Num GPUs = 1. Max memory: 39.494 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 8.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Gemma3 does not support SDPA - switching to eager!
Model loaded - Unsloth auto-configured dtype and attention
Unsloth: Making `base_model.model.vision_tower.vision_model` require gradients
Gemma-3 vision model loaded with LoRA (r=32, alpha=64, dropout=0.0064)
Prepared 413 samples (valid images) out of 413 total
[HPO] Training samples: 413
[HPO] GPU = NVIDIA A100-SXM4-40GB. Max memory = 39.494 GB.
[HPO] 12.02 GB of memory reserved before training.
[HPO] Starting Gemma-3 training for this trial...

{'loss': 22.859, 'grad_norm': 346.8550720214844, 'learning_rate': 5.875021074747674e-06, 'epoch': 0.77}
{'loss': 7.9525, 'grad_norm': 120.25336456298828, 'learning_rate': 7.752445244651186e-06, 'epoch': 1.62}
{'loss': 1.5937, 'grad_norm': 31.193511962890625, 'learning_rate': 7.3641485319686985e-06, 'epoch': 2.46}
{'loss': 0.8466, 'grad_norm': 12.601325035095215, 'learning_rate': 6.686192210877088e-06, 'epoch': 3.31}
{'loss': 0.5398, 'grad_norm': 13.64604377746582, 'learning_rate': 5.775538832732066e-06, 'epoch': 4.15}
{'loss': 0.1955, 'grad_norm': 38.27423858642578, 'learning_rate': 4.7087023825884735e-06, 'epoch': 4.93}
{'loss': 0.1774, 'grad_norm': 10.796398162841797, 'learning_rate': 3.5753194995465967e-06, 'epoch': 5.77}
{'loss': 0.1341, 'grad_norm': 8.773497581481934, 'learning_rate': 2.4706181189061728e-06, 'epoch': 6.62}
{'loss': 0.1122, 'grad_norm': 9.080368995666504, 'learning_rate': 1.4874163281601132e-06, 'epoch': 7.46}
{'loss': 0.1051, 'grad_norm': 77.98709869384766, 'learning_rate': 7.08323700751471e-07, 'epoch': 8.31}
{'loss': 0.0944, 'grad_norm': 7.725099563598633, 'learning_rate': 1.9880035913793679e-07, 'epoch': 9.15}
{'loss': 0.0842, 'grad_norm': 5.082944393157959, 'learning_rate': 1.6569514551611668e-09, 'epoch': 9.93}
{'train_runtime': 4313.2406, 'train_samples_per_second': 0.958, 'train_steps_per_second': 0.028, 'train_loss': 2.8912184024850527, 'epoch': 9.93}
[HPO] Training runtime: 4313.24 s (71.89 min)
[HPO] Peak reserved memory: 12.02 GB

[HPO] === Running validation CER (Gemma-3 SCHMUCK) ===
[HPO] Using 30 validation samples
[HPO]   Val sample 1/30: SCH_1941.jpg
[HPO]   ‚ùå Validation error on SCH_1941.jpg: name 're' is not defined
[HPO]   Val sample 2/30: SCH_3097.jpg
[HPO]   ‚ùå Validation error on SCH_3097.jpg: name 're' is not defined
[HPO]   Val sample 3/30: SCH_3217.jpg
[HPO]   ‚ùå Validation error on SCH_3217.jpg: name 're' is not defined
[HPO]   Val sample 4/30: SCH_2891_185.jpg
[HPO]   ‚ùå Validation error on SCH_2891_185.jpg: name 're' is not defined
[HPO]   Val sample 5/30: SCH_1931.jpg
[HPO]   ‚ùå Validation error on SCH_1931.jpg: name 're' is not defined
[HPO]   Val sample 6/30: SCH_2891_139.jpg
[HPO]   ‚ùå Validation error on SCH_2891_139.jpg: name 're' is not defined
[HPO]   Val sample 7/30: SCH_2891_303.jpg
[HPO]   ‚ùå Validation error on SCH_2891_303.jpg: name 're' is not defined
[HPO]   Val sample 8/30: SCH_3082_recto.jpg
[HPO]   ‚ùå Validation error on SCH_3082_recto.jpg: name 're' is not defined
[HPO]   Val sample 9/30: SCH_3192_15.jpg
[HPO]   ‚ùå Validation error on SCH_3192_15.jpg: name 're' is not defined
[HPO]   Val sample 10/30: SCH_2969.jpg
[HPO]   ‚ùå Validation error on SCH_2969.jpg: name 're' is not defined
[HPO]   Val sample 11/30: SCH_2891_24_a.jpg
[HPO]   ‚ùå Validation error on SCH_2891_24_a.jpg: name 're' is not defined
[HPO]   Val sample 12/30: SCH_3028.jpg
[HPO]   ‚ùå Validation error on SCH_3028.jpg: name 're' is not defined
[HPO]   Val sample 13/30: SCH_3192_34.jpg
[HPO]   ‚ùå Validation error on SCH_3192_34.jpg: name 're' is not defined
[HPO]   Val sample 14/30: SCH_2891_194_195.jpg
[HPO]   ‚ùå Validation error on SCH_2891_194_195.jpg: name 're' is not defined
[HPO]   Val sample 15/30: SCH_3138.jpg
[HPO]   ‚ùå Validation error on SCH_3138.jpg: name 're' is not defined
[HPO]   Val sample 16/30: SCH_2891_216.jpg
[HPO]   ‚ùå Validation error on SCH_2891_216.jpg: name 're' is not defined
[HPO]   Val sample 17/30: SCH_3201.jpg
[HPO]   ‚ùå Validation error on SCH_3201.jpg: name 're' is not defined
[HPO]   Val sample 18/30: SCH_2891_208.jpg
[HPO]   ‚ùå Validation error on SCH_2891_208.jpg: name 're' is not defined
[HPO]   Val sample 19/30: SCH_2079.jpg
[HPO]   ‚ùå Validation error on SCH_2079.jpg: name 're' is not defined
[HPO]   Val sample 20/30: SCH_2891_122.jpg
[HPO]   ‚ùå Validation error on SCH_2891_122.jpg: name 're' is not defined
[HPO]   Val sample 21/30: SCH_3192_24.jpg
[HPO]   ‚ùå Validation error on SCH_3192_24.jpg: name 're' is not defined
[HPO]   Val sample 22/30: SCH_2891_294.jpg
[HPO]   ‚ùå Validation error on SCH_2891_294.jpg: name 're' is not defined
[HPO]   Val sample 23/30: SCH_2891_119.jpg
[HPO]   ‚ùå Validation error on SCH_2891_119.jpg: name 're' is not defined
[HPO]   Val sample 24/30: SCH_3049.jpg
[HPO]   ‚ùå Validation error on SCH_3049.jpg: name 're' is not defined
[HPO]   Val sample 25/30: SCH_2891_269.jpg
[HPO]   ‚ùå Validation error on SCH_2891_269.jpg: name 're' is not defined
[HPO]   Val sample 26/30: SCH_2990.jpg
[HPO]   ‚ùå Validation error on SCH_2990.jpg: name 're' is not defined
[HPO]   Val sample 27/30: SCH_1933.jpg
[HPO]   ‚ùå Validation error on SCH_1933.jpg: name 're' is not defined
[HPO]   Val sample 28/30: SCH_2891_71.jpg
[HPO]   ‚ùå Validation error on SCH_2891_71.jpg: name 're' is not defined
[HPO]   Val sample 29/30: SCH_3121.jpg
[HPO]   ‚ùå Validation error on SCH_3121.jpg: name 're' is not defined
[HPO]   Val sample 30/30: SCH_2891_61.jpg
[HPO]   ‚ùå Validation error on SCH_2891_61.jpg: name 're' is not defined

[HPO]   ‚úÖ Validation CER: 1.0000 (100.00%)


================================================================================
[HPO] GEMMA-3 SCHMUCK TRIAL
================================================================================
[HPO] Trial #15
[HPO] Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/gemma/HPO/schmuck/hpo_run_20251220_060531/trial_015
[HPO]   ‚Ä¢ num_epochs: 7
[HPO]   ‚Ä¢ batch_size: 2
[HPO]   ‚Ä¢ grad_accum: 16
[HPO]   ‚Ä¢ learning_rate: 1.4517220029959595e-05
[HPO]   ‚Ä¢ weight_decay: 0.08387336509179122
[HPO]   ‚Ä¢ lora_r: 8
[HPO]   ‚Ä¢ lora_alpha: 64
[HPO]   ‚Ä¢ lora_dropout: 0.0549
Loading Gemma-3 vision model with Unsloth for SCHMUCK...
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Gemma3 patching. Transformers: 4.51.3.
   \\   /|    NVIDIA A100-SXM4-40GB. Num GPUs = 1. Max memory: 39.494 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 8.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Gemma3 does not support SDPA - switching to eager!
Model loaded - Unsloth auto-configured dtype and attention
Unsloth: Making `base_model.model.vision_tower.vision_model` require gradients
Gemma-3 vision model loaded with LoRA (r=8, alpha=64, dropout=0.0549)
Prepared 413 samples (valid images) out of 413 total
[HPO] Training samples: 413
[HPO] GPU = NVIDIA A100-SXM4-40GB. Max memory = 39.494 GB.
[HPO] 12.02 GB of memory reserved before training.
[HPO] Starting Gemma-3 training for this trial...

{'loss': 21.52, 'grad_norm': 373.5494384765625, 'learning_rate': 1.4517220029959595e-05, 'epoch': 0.77}
{'loss': 6.5664, 'grad_norm': 165.26324462890625, 'learning_rate': 1.3889680222963682e-05, 'epoch': 1.62}
{'loss': 1.3542, 'grad_norm': 43.0150260925293, 'learning_rate': 1.211556813562571e-05, 'epoch': 2.46}
{'loss': 0.8053, 'grad_norm': 27.014589309692383, 'learning_rate': 9.501643865148746e-06, 'epoch': 3.31}
{'loss': 0.4725, 'grad_norm': 12.1923828125, 'learning_rate': 6.4998786646547615e-06, 'epoch': 4.15}
{'loss': 0.1972, 'grad_norm': 26.838424682617188, 'learning_rate': 3.6293050074899003e-06, 'epoch': 4.93}
{'loss': 0.1975, 'grad_norm': 11.652544975280762, 'learning_rate': 1.3862711573209502e-06, 'epoch': 5.77}
{'loss': 0.1719, 'grad_norm': 9.85634994506836, 'learning_rate': 1.586180441649352e-07, 'epoch': 6.62}
{'train_runtime': 3016.9569, 'train_samples_per_second': 0.958, 'train_steps_per_second': 0.028, 'train_loss': 3.7318497129849026, 'epoch': 6.93}
[HPO] Training runtime: 3016.96 s (50.28 min)
[HPO] Peak reserved memory: 12.02 GB

[HPO] === Running validation CER (Gemma-3 SCHMUCK) ===
[HPO] Using 30 validation samples
[HPO]   Val sample 1/30: SCH_1941.jpg
[HPO]   ‚ùå Validation error on SCH_1941.jpg: name 're' is not defined
[HPO]   Val sample 2/30: SCH_3097.jpg
[HPO]   ‚ùå Validation error on SCH_3097.jpg: name 're' is not defined
[HPO]   Val sample 3/30: SCH_3217.jpg
[HPO]   ‚ùå Validation error on SCH_3217.jpg: name 're' is not defined
[HPO]   Val sample 4/30: SCH_2891_185.jpg
[HPO]   ‚ùå Validation error on SCH_2891_185.jpg: name 're' is not defined
[HPO]   Val sample 5/30: SCH_1931.jpg
[HPO]   ‚ùå Validation error on SCH_1931.jpg: name 're' is not defined
[HPO]   Val sample 6/30: SCH_2891_139.jpg
[HPO]   ‚ùå Validation error on SCH_2891_139.jpg: name 're' is not defined
[HPO]   Val sample 7/30: SCH_2891_303.jpg
[HPO]   ‚ùå Validation error on SCH_2891_303.jpg: name 're' is not defined
[HPO]   Val sample 8/30: SCH_3082_recto.jpg
[HPO]   ‚ùå Validation error on SCH_3082_recto.jpg: name 're' is not defined
[HPO]   Val sample 9/30: SCH_3192_15.jpg
[HPO]   ‚ùå Validation error on SCH_3192_15.jpg: name 're' is not defined
[HPO]   Val sample 10/30: SCH_2969.jpg
[HPO]   ‚ùå Validation error on SCH_2969.jpg: name 're' is not defined
[HPO]   Val sample 11/30: SCH_2891_24_a.jpg
[HPO]   ‚ùå Validation error on SCH_2891_24_a.jpg: name 're' is not defined
[HPO]   Val sample 12/30: SCH_3028.jpg
[HPO]   ‚ùå Validation error on SCH_3028.jpg: name 're' is not defined
[HPO]   Val sample 13/30: SCH_3192_34.jpg
[HPO]   ‚ùå Validation error on SCH_3192_34.jpg: name 're' is not defined
[HPO]   Val sample 14/30: SCH_2891_194_195.jpg
[HPO]   ‚ùå Validation error on SCH_2891_194_195.jpg: name 're' is not defined
[HPO]   Val sample 15/30: SCH_3138.jpg
[HPO]   ‚ùå Validation error on SCH_3138.jpg: name 're' is not defined
[HPO]   Val sample 16/30: SCH_2891_216.jpg
[HPO]   ‚ùå Validation error on SCH_2891_216.jpg: name 're' is not defined
[HPO]   Val sample 17/30: SCH_3201.jpg
[HPO]   ‚ùå Validation error on SCH_3201.jpg: name 're' is not defined
[HPO]   Val sample 18/30: SCH_2891_208.jpg
[HPO]   ‚ùå Validation error on SCH_2891_208.jpg: name 're' is not defined
[HPO]   Val sample 19/30: SCH_2079.jpg
[HPO]   ‚ùå Validation error on SCH_2079.jpg: name 're' is not defined
[HPO]   Val sample 20/30: SCH_2891_122.jpg
[HPO]   ‚ùå Validation error on SCH_2891_122.jpg: name 're' is not defined
[HPO]   Val sample 21/30: SCH_3192_24.jpg
[HPO]   ‚ùå Validation error on SCH_3192_24.jpg: name 're' is not defined
[HPO]   Val sample 22/30: SCH_2891_294.jpg
[HPO]   ‚ùå Validation error on SCH_2891_294.jpg: name 're' is not defined
[HPO]   Val sample 23/30: SCH_2891_119.jpg
[HPO]   ‚ùå Validation error on SCH_2891_119.jpg: name 're' is not defined
[HPO]   Val sample 24/30: SCH_3049.jpg
[HPO]   ‚ùå Validation error on SCH_3049.jpg: name 're' is not defined
[HPO]   Val sample 25/30: SCH_2891_269.jpg
[HPO]   ‚ùå Validation error on SCH_2891_269.jpg: name 're' is not defined
[HPO]   Val sample 26/30: SCH_2990.jpg
[HPO]   ‚ùå Validation error on SCH_2990.jpg: name 're' is not defined
[HPO]   Val sample 27/30: SCH_1933.jpg
[HPO]   ‚ùå Validation error on SCH_1933.jpg: name 're' is not defined
[HPO]   Val sample 28/30: SCH_2891_71.jpg
[HPO]   ‚ùå Validation error on SCH_2891_71.jpg: name 're' is not defined
[HPO]   Val sample 29/30: SCH_3121.jpg
[HPO]   ‚ùå Validation error on SCH_3121.jpg: name 're' is not defined
[HPO]   Val sample 30/30: SCH_2891_61.jpg
[HPO]   ‚ùå Validation error on SCH_2891_61.jpg: name 're' is not defined

[HPO]   ‚úÖ Validation CER: 1.0000 (100.00%)


================================================================================
[HPO] GEMMA-3 SCHMUCK TRIAL
================================================================================
[HPO] Trial #16
[HPO] Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/gemma/HPO/schmuck/hpo_run_20251220_060531/trial_016
[HPO]   ‚Ä¢ num_epochs: 9
[HPO]   ‚Ä¢ batch_size: 2
[HPO]   ‚Ä¢ grad_accum: 4
[HPO]   ‚Ä¢ learning_rate: 1.3776740213123441e-05
[HPO]   ‚Ä¢ weight_decay: 0.004261706205193502
[HPO]   ‚Ä¢ lora_r: 32
[HPO]   ‚Ä¢ lora_alpha: 64
[HPO]   ‚Ä¢ lora_dropout: 0.0276
Loading Gemma-3 vision model with Unsloth for SCHMUCK...
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Gemma3 patching. Transformers: 4.51.3.
   \\   /|    NVIDIA A100-SXM4-40GB. Num GPUs = 1. Max memory: 39.494 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 8.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Gemma3 does not support SDPA - switching to eager!
Model loaded - Unsloth auto-configured dtype and attention
Unsloth: Making `base_model.model.vision_tower.vision_model` require gradients
Gemma-3 vision model loaded with LoRA (r=32, alpha=64, dropout=0.0276)
Prepared 413 samples (valid images) out of 413 total
[HPO] Training samples: 413
[HPO] GPU = NVIDIA A100-SXM4-40GB. Max memory = 39.494 GB.
[HPO] 12.02 GB of memory reserved before training.
[HPO] Starting Gemma-3 training for this trial...

{'loss': 6.4816, 'grad_norm': 194.30276489257812, 'learning_rate': 2.6954491721328475e-06, 'epoch': 0.19}
{'loss': 3.2794, 'grad_norm': 66.50035095214844, 'learning_rate': 5.6903926967249e-06, 'epoch': 0.39}
{'loss': 1.1972, 'grad_norm': 28.75722312927246, 'learning_rate': 8.685336221316953e-06, 'epoch': 0.58}
{'loss': 0.2892, 'grad_norm': 22.908395767211914, 'learning_rate': 1.1680279745909004e-05, 'epoch': 0.77}
{'loss': 0.168, 'grad_norm': 20.921001434326172, 'learning_rate': 1.3774946678429645e-05, 'epoch': 0.97}
{'loss': 0.0761, 'grad_norm': 5.894735336303711, 'learning_rate': 1.3743087592598097e-05, 'epoch': 1.17}
{'loss': 0.0511, 'grad_norm': 5.681056022644043, 'learning_rate': 1.3671584295698781e-05, 'epoch': 1.37}
{'loss': 0.0621, 'grad_norm': 7.310316562652588, 'learning_rate': 1.3560850326553697e-05, 'epoch': 1.56}
{'loss': 0.0534, 'grad_norm': 5.756180763244629, 'learning_rate': 1.3411526114305856e-05, 'epoch': 1.75}
{'loss': 0.0469, 'grad_norm': 3.6216022968292236, 'learning_rate': 1.3224475274501769e-05, 'epoch': 1.95}
{'loss': 0.0265, 'grad_norm': 6.892685890197754, 'learning_rate': 1.300077961437692e-05, 'epoch': 2.15}
{'loss': 0.0286, 'grad_norm': 2.310708522796631, 'learning_rate': 1.274173287623112e-05, 'epoch': 2.35}
{'loss': 0.0208, 'grad_norm': 3.93669056892395, 'learning_rate': 1.2448833255078882e-05, 'epoch': 2.54}
{'loss': 0.0312, 'grad_norm': 1.6739169359207153, 'learning_rate': 1.2123774733848935e-05, 'epoch': 2.73}
{'loss': 0.0315, 'grad_norm': 0.9983972311019897, 'learning_rate': 1.1768437286245705e-05, 'epoch': 2.93}
{'loss': 0.0215, 'grad_norm': 1.2945631742477417, 'learning_rate': 1.1384876003934425e-05, 'epoch': 3.14}
{'loss': 0.0167, 'grad_norm': 6.937887668609619, 'learning_rate': 1.097530921093273e-05, 'epoch': 3.33}
{'loss': 0.0159, 'grad_norm': 5.47506856918335, 'learning_rate': 1.0542105633949076e-05, 'epoch': 3.52}
{'loss': 0.0147, 'grad_norm': 2.65986967086792, 'learning_rate': 1.0087770702868246e-05, 'epoch': 3.71}
{'loss': 0.0151, 'grad_norm': 1.1155909299850464, 'learning_rate': 9.614932060614971e-06, 'epoch': 3.91}
{'loss': 0.0195, 'grad_norm': 4.313390731811523, 'learning_rate': 9.126324366199294e-06, 'epoch': 4.12}
{'loss': 0.0078, 'grad_norm': 1.2053157091140747, 'learning_rate': 8.62477347883514e-06, 'epoch': 4.31}
{'loss': 0.0075, 'grad_norm': 2.313620090484619, 'learning_rate': 8.113180114603132e-06, 'epoch': 4.5}
{'loss': 0.0096, 'grad_norm': 1.4776924848556519, 'learning_rate': 7.594503070179252e-06, 'epoch': 4.7}
{'loss': 0.0083, 'grad_norm': 3.1562371253967285, 'learning_rate': 7.071742110654774e-06, 'epoch': 4.89}
{'loss': 0.0082, 'grad_norm': 0.1494545340538025, 'learning_rate': 6.547920620415646e-06, 'epoch': 5.1}
{'loss': 0.0043, 'grad_norm': 4.077407360076904, 'learning_rate': 6.026068117419858e-06, 'epoch': 5.29}
{'loss': 0.0043, 'grad_norm': 25.271276473999023, 'learning_rate': 5.509202732001318e-06, 'epoch': 5.48}
{'loss': 0.0045, 'grad_norm': 1.8176960945129395, 'learning_rate': 5.000313751534e-06, 'epoch': 5.68}
{'loss': 0.0076, 'grad_norm': 0.6269857287406921, 'learning_rate': 4.5023443319091315e-06, 'epoch': 5.87}
{'loss': 0.0047, 'grad_norm': 2.3309364318847656, 'learning_rate': 4.0181744758134885e-06, 'epoch': 6.08}
{'loss': 0.0042, 'grad_norm': 0.561978816986084, 'learning_rate': 3.5506043762538292e-06, 'epoch': 6.27}
{'loss': 0.0012, 'grad_norm': 0.41954562067985535, 'learning_rate': 3.102338221660048e-06, 'epoch': 6.46}
{'loss': 0.0024, 'grad_norm': 1.4179668426513672, 'learning_rate': 2.6759685562301322e-06, 'epoch': 6.66}
{'loss': 0.0012, 'grad_norm': 0.7492260336875916, 'learning_rate': 2.273961285968757e-06, 'epoch': 6.85}
{'loss': 0.0012, 'grad_norm': 0.6548970341682434, 'learning_rate': 1.8986414171370113e-06, 'epoch': 7.06}
{'loss': 0.0007, 'grad_norm': 0.29277297854423523, 'learning_rate': 1.552179609594797e-06, 'epoch': 7.25}
{'loss': 0.0003, 'grad_norm': 0.6974676847457886, 'learning_rate': 1.2365796228045688e-06, 'epoch': 7.44}
{'loss': 0.0029, 'grad_norm': 1.8625744581222534, 'learning_rate': 9.536667271023826e-07, 'epoch': 7.64}
{'loss': 0.0008, 'grad_norm': 0.3834112882614136, 'learning_rate': 7.05077147259554e-07, 'epoch': 7.83}
{'loss': 0.0003, 'grad_norm': 0.0521896556019783, 'learning_rate': 4.922485993880309e-07, 'epoch': 8.04}
{'loss': 0.0002, 'grad_norm': 0.10252748429775238, 'learning_rate': 3.164119759192296e-07, 'epoch': 8.23}
{'loss': 0.0017, 'grad_norm': 0.0788140743970871, 'learning_rate': 1.785842267461909e-07, 'epoch': 8.43}
{'loss': 0.0002, 'grad_norm': 0.2024356871843338, 'learning_rate': 7.956247770091863e-08, 'epoch': 8.62}
{'loss': 0.0002, 'grad_norm': 0.5095087885856628, 'learning_rate': 1.991942038265861e-08, 'epoch': 8.81}
{'train_runtime': 3881.8443, 'train_samples_per_second': 0.958, 'train_steps_per_second': 0.118, 'train_loss': 0.2621304233386516, 'epoch': 8.99}
[HPO] Training runtime: 3881.84 s (64.70 min)
[HPO] Peak reserved memory: 12.02 GB

[HPO] === Running validation CER (Gemma-3 SCHMUCK) ===
[HPO] Using 30 validation samples
[HPO]   Val sample 1/30: SCH_1941.jpg
[HPO]   ‚ùå Validation error on SCH_1941.jpg: name 're' is not defined
[HPO]   Val sample 2/30: SCH_3097.jpg
[HPO]   ‚ùå Validation error on SCH_3097.jpg: name 're' is not defined
[HPO]   Val sample 3/30: SCH_3217.jpg
[HPO]   ‚ùå Validation error on SCH_3217.jpg: name 're' is not defined
[HPO]   Val sample 4/30: SCH_2891_185.jpg
[HPO]   ‚ùå Validation error on SCH_2891_185.jpg: name 're' is not defined
[HPO]   Val sample 5/30: SCH_1931.jpg
[HPO]   ‚ùå Validation error on SCH_1931.jpg: name 're' is not defined
[HPO]   Val sample 6/30: SCH_2891_139.jpg
[HPO]   ‚ùå Validation error on SCH_2891_139.jpg: name 're' is not defined
[HPO]   Val sample 7/30: SCH_2891_303.jpg
[HPO]   ‚ùå Validation error on SCH_2891_303.jpg: name 're' is not defined
[HPO]   Val sample 8/30: SCH_3082_recto.jpg
[HPO]   ‚ùå Validation error on SCH_3082_recto.jpg: name 're' is not defined
[HPO]   Val sample 9/30: SCH_3192_15.jpg
[HPO]   ‚ùå Validation error on SCH_3192_15.jpg: name 're' is not defined
[HPO]   Val sample 10/30: SCH_2969.jpg
[HPO]   ‚ùå Validation error on SCH_2969.jpg: name 're' is not defined
[HPO]   Val sample 11/30: SCH_2891_24_a.jpg
[HPO]   ‚ùå Validation error on SCH_2891_24_a.jpg: name 're' is not defined
[HPO]   Val sample 12/30: SCH_3028.jpg
[HPO]   ‚ùå Validation error on SCH_3028.jpg: name 're' is not defined
[HPO]   Val sample 13/30: SCH_3192_34.jpg
[HPO]   ‚ùå Validation error on SCH_3192_34.jpg: name 're' is not defined
[HPO]   Val sample 14/30: SCH_2891_194_195.jpg
[HPO]   ‚ùå Validation error on SCH_2891_194_195.jpg: name 're' is not defined
[HPO]   Val sample 15/30: SCH_3138.jpg
[HPO]   ‚ùå Validation error on SCH_3138.jpg: name 're' is not defined
[HPO]   Val sample 16/30: SCH_2891_216.jpg
[HPO]   ‚ùå Validation error on SCH_2891_216.jpg: name 're' is not defined
[HPO]   Val sample 17/30: SCH_3201.jpg
[HPO]   ‚ùå Validation error on SCH_3201.jpg: name 're' is not defined
[HPO]   Val sample 18/30: SCH_2891_208.jpg
[HPO]   ‚ùå Validation error on SCH_2891_208.jpg: name 're' is not defined
[HPO]   Val sample 19/30: SCH_2079.jpg
[HPO]   ‚ùå Validation error on SCH_2079.jpg: name 're' is not defined
[HPO]   Val sample 20/30: SCH_2891_122.jpg
[HPO]   ‚ùå Validation error on SCH_2891_122.jpg: name 're' is not defined
[HPO]   Val sample 21/30: SCH_3192_24.jpg
[HPO]   ‚ùå Validation error on SCH_3192_24.jpg: name 're' is not defined
[HPO]   Val sample 22/30: SCH_2891_294.jpg
[HPO]   ‚ùå Validation error on SCH_2891_294.jpg: name 're' is not defined
[HPO]   Val sample 23/30: SCH_2891_119.jpg
[HPO]   ‚ùå Validation error on SCH_2891_119.jpg: name 're' is not defined
[HPO]   Val sample 24/30: SCH_3049.jpg
[HPO]   ‚ùå Validation error on SCH_3049.jpg: name 're' is not defined
[HPO]   Val sample 25/30: SCH_2891_269.jpg
[HPO]   ‚ùå Validation error on SCH_2891_269.jpg: name 're' is not defined
[HPO]   Val sample 26/30: SCH_2990.jpg
[HPO]   ‚ùå Validation error on SCH_2990.jpg: name 're' is not defined
[HPO]   Val sample 27/30: SCH_1933.jpg
[HPO]   ‚ùå Validation error on SCH_1933.jpg: name 're' is not defined
[HPO]   Val sample 28/30: SCH_2891_71.jpg
[HPO]   ‚ùå Validation error on SCH_2891_71.jpg: name 're' is not defined
[HPO]   Val sample 29/30: SCH_3121.jpg
[HPO]   ‚ùå Validation error on SCH_3121.jpg: name 're' is not defined
[HPO]   Val sample 30/30: SCH_2891_61.jpg
[HPO]   ‚ùå Validation error on SCH_2891_61.jpg: name 're' is not defined

[HPO]   ‚úÖ Validation CER: 1.0000 (100.00%)


================================================================================
[HPO] GEMMA-3 SCHMUCK TRIAL
================================================================================
[HPO] Trial #17
[HPO] Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/gemma/HPO/schmuck/hpo_run_20251220_060531/trial_017
[HPO]   ‚Ä¢ num_epochs: 7
[HPO]   ‚Ä¢ batch_size: 2
[HPO]   ‚Ä¢ grad_accum: 16
[HPO]   ‚Ä¢ learning_rate: 1.2040359486385462e-05
[HPO]   ‚Ä¢ weight_decay: 0.0962748609399005
[HPO]   ‚Ä¢ lora_r: 8
[HPO]   ‚Ä¢ lora_alpha: 32
[HPO]   ‚Ä¢ lora_dropout: 0.1144
Loading Gemma-3 vision model with Unsloth for SCHMUCK...
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Gemma3 patching. Transformers: 4.51.3.
   \\   /|    NVIDIA A100-SXM4-40GB. Num GPUs = 1. Max memory: 39.494 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 8.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Gemma3 does not support SDPA - switching to eager!
Model loaded - Unsloth auto-configured dtype and attention
Unsloth: Making `base_model.model.vision_tower.vision_model` require gradients
Gemma-3 vision model loaded with LoRA (r=8, alpha=32, dropout=0.1144)
Prepared 413 samples (valid images) out of 413 total
[HPO] Training samples: 413
[HPO] GPU = NVIDIA A100-SXM4-40GB. Max memory = 39.494 GB.
[HPO] 12.02 GB of memory reserved before training.
[HPO] Starting Gemma-3 training for this trial...

{'loss': 24.9965, 'grad_norm': 353.3892517089844, 'learning_rate': 1.2040359486385462e-05, 'epoch': 0.77}
{'loss': 12.4536, 'grad_norm': 89.34404754638672, 'learning_rate': 1.151988760177845e-05, 'epoch': 1.62}
{'loss': 5.827, 'grad_norm': 64.49510192871094, 'learning_rate': 1.0048466265144598e-05, 'epoch': 2.46}
{'loss': 2.0855, 'grad_norm': 114.26140594482422, 'learning_rate': 7.880517593031092e-06, 'epoch': 3.31}
{'loss': 1.1063, 'grad_norm': 13.896658897399902, 'learning_rate': 5.390899606041739e-06, 'epoch': 4.15}
{'loss': 0.8974, 'grad_norm': 28.56024169921875, 'learning_rate': 3.0100898715963667e-06, 'epoch': 4.93}
{'loss': 0.9153, 'grad_norm': 12.152288436889648, 'learning_rate': 1.1497520217580055e-06, 'epoch': 5.77}
{'loss': 0.8862, 'grad_norm': 9.158781051635742, 'learning_rate': 1.3155537140250268e-07, 'epoch': 6.62}
{'train_runtime': 3001.9804, 'train_samples_per_second': 0.963, 'train_steps_per_second': 0.028, 'train_loss': 5.890729342188154, 'epoch': 6.93}
[HPO] Training runtime: 3001.98 s (50.03 min)
[HPO] Peak reserved memory: 12.02 GB

[HPO] === Running validation CER (Gemma-3 SCHMUCK) ===
[HPO] Using 30 validation samples
[HPO]   Val sample 1/30: SCH_1941.jpg
[HPO]   ‚ùå Validation error on SCH_1941.jpg: name 're' is not defined
[HPO]   Val sample 2/30: SCH_3097.jpg
[HPO]   ‚ùå Validation error on SCH_3097.jpg: name 're' is not defined
[HPO]   Val sample 3/30: SCH_3217.jpg
[HPO]   ‚ùå Validation error on SCH_3217.jpg: name 're' is not defined
[HPO]   Val sample 4/30: SCH_2891_185.jpg
[HPO]   ‚ùå Validation error on SCH_2891_185.jpg: name 're' is not defined
[HPO]   Val sample 5/30: SCH_1931.jpg
[HPO]   ‚ùå Validation error on SCH_1931.jpg: name 're' is not defined
[HPO]   Val sample 6/30: SCH_2891_139.jpg
[HPO]   ‚ùå Validation error on SCH_2891_139.jpg: name 're' is not defined
[HPO]   Val sample 7/30: SCH_2891_303.jpg
[HPO]   ‚ùå Validation error on SCH_2891_303.jpg: name 're' is not defined
[HPO]   Val sample 8/30: SCH_3082_recto.jpg
[HPO]   ‚ùå Validation error on SCH_3082_recto.jpg: name 're' is not defined
[HPO]   Val sample 9/30: SCH_3192_15.jpg
[HPO]   ‚ùå Validation error on SCH_3192_15.jpg: name 're' is not defined
[HPO]   Val sample 10/30: SCH_2969.jpg
[HPO]   ‚ùå Validation error on SCH_2969.jpg: name 're' is not defined
[HPO]   Val sample 11/30: SCH_2891_24_a.jpg
[HPO]   ‚ùå Validation error on SCH_2891_24_a.jpg: name 're' is not defined
[HPO]   Val sample 12/30: SCH_3028.jpg
[HPO]   ‚ùå Validation error on SCH_3028.jpg: name 're' is not defined
[HPO]   Val sample 13/30: SCH_3192_34.jpg
[HPO]   ‚ùå Validation error on SCH_3192_34.jpg: name 're' is not defined
[HPO]   Val sample 14/30: SCH_2891_194_195.jpg
[HPO]   ‚ùå Validation error on SCH_2891_194_195.jpg: name 're' is not defined
[HPO]   Val sample 15/30: SCH_3138.jpg
[HPO]   ‚ùå Validation error on SCH_3138.jpg: name 're' is not defined
[HPO]   Val sample 16/30: SCH_2891_216.jpg
[HPO]   ‚ùå Validation error on SCH_2891_216.jpg: name 're' is not defined
[HPO]   Val sample 17/30: SCH_3201.jpg
[HPO]   ‚ùå Validation error on SCH_3201.jpg: name 're' is not defined
[HPO]   Val sample 18/30: SCH_2891_208.jpg
[HPO]   ‚ùå Validation error on SCH_2891_208.jpg: name 're' is not defined
[HPO]   Val sample 19/30: SCH_2079.jpg
[HPO]   ‚ùå Validation error on SCH_2079.jpg: name 're' is not defined
[HPO]   Val sample 20/30: SCH_2891_122.jpg
[HPO]   ‚ùå Validation error on SCH_2891_122.jpg: name 're' is not defined
[HPO]   Val sample 21/30: SCH_3192_24.jpg
[HPO]   ‚ùå Validation error on SCH_3192_24.jpg: name 're' is not defined
[HPO]   Val sample 22/30: SCH_2891_294.jpg
[HPO]   ‚ùå Validation error on SCH_2891_294.jpg: name 're' is not defined
[HPO]   Val sample 23/30: SCH_2891_119.jpg
[HPO]   ‚ùå Validation error on SCH_2891_119.jpg: name 're' is not defined
[HPO]   Val sample 24/30: SCH_3049.jpg
[HPO]   ‚ùå Validation error on SCH_3049.jpg: name 're' is not defined
[HPO]   Val sample 25/30: SCH_2891_269.jpg
[HPO]   ‚ùå Validation error on SCH_2891_269.jpg: name 're' is not defined
[HPO]   Val sample 26/30: SCH_2990.jpg
[HPO]   ‚ùå Validation error on SCH_2990.jpg: name 're' is not defined
[HPO]   Val sample 27/30: SCH_1933.jpg
[HPO]   ‚ùå Validation error on SCH_1933.jpg: name 're' is not defined
[HPO]   Val sample 28/30: SCH_2891_71.jpg
[HPO]   ‚ùå Validation error on SCH_2891_71.jpg: name 're' is not defined
[HPO]   Val sample 29/30: SCH_3121.jpg
[HPO]   ‚ùå Validation error on SCH_3121.jpg: name 're' is not defined
[HPO]   Val sample 30/30: SCH_2891_61.jpg
[HPO]   ‚ùå Validation error on SCH_2891_61.jpg: name 're' is not defined

[HPO]   ‚úÖ Validation CER: 1.0000 (100.00%)


================================================================================
[HPO] GEMMA-3 SCHMUCK TRIAL
================================================================================
[HPO] Trial #18
[HPO] Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/gemma/HPO/schmuck/hpo_run_20251220_060531/trial_018
[HPO]   ‚Ä¢ num_epochs: 10
[HPO]   ‚Ä¢ batch_size: 2
[HPO]   ‚Ä¢ grad_accum: 8
[HPO]   ‚Ä¢ learning_rate: 1.0190229248095588e-05
[HPO]   ‚Ä¢ weight_decay: 0.0361372129382167
[HPO]   ‚Ä¢ lora_r: 8
[HPO]   ‚Ä¢ lora_alpha: 16
[HPO]   ‚Ä¢ lora_dropout: 0.0061
Loading Gemma-3 vision model with Unsloth for SCHMUCK...
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Gemma3 patching. Transformers: 4.51.3.
   \\   /|    NVIDIA A100-SXM4-40GB. Num GPUs = 1. Max memory: 39.494 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 8.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Gemma3 does not support SDPA - switching to eager!
Model loaded - Unsloth auto-configured dtype and attention
Unsloth: Making `base_model.model.vision_tower.vision_model` require gradients
Gemma-3 vision model loaded with LoRA (r=8, alpha=16, dropout=0.0061)
Prepared 413 samples (valid images) out of 413 total
[HPO] Training samples: 413
[HPO] GPU = NVIDIA A100-SXM4-40GB. Max memory = 39.494 GB.
[HPO] 12.02 GB of memory reserved before training.
[HPO] Starting Gemma-3 training for this trial...

{'loss': 13.8832, 'grad_norm': 162.03521728515625, 'learning_rate': 3.6684825293144116e-06, 'epoch': 0.39}
{'loss': 12.2313, 'grad_norm': 85.06520080566406, 'learning_rate': 7.744574228552646e-06, 'epoch': 0.77}
{'loss': 8.2466, 'grad_norm': 43.028236389160156, 'learning_rate': 1.018228476287686e-05, 'epoch': 1.19}
{'loss': 5.0156, 'grad_norm': 30.67255401611328, 'learning_rate': 1.0093193581602535e-05, 'epoch': 1.58}
{'loss': 3.21, 'grad_norm': 20.738550186157227, 'learning_rate': 9.906820478649958e-06, 'epoch': 1.97}
{'loss': 1.9685, 'grad_norm': 17.744951248168945, 'learning_rate': 9.626792994471836e-06, 'epoch': 2.39}
{'loss': 0.7311, 'grad_norm': 16.47230339050293, 'learning_rate': 9.258561545521154e-06, 'epoch': 2.77}
{'loss': 0.5456, 'grad_norm': 6.209338665008545, 'learning_rate': 8.809293338094676e-06, 'epoch': 3.19}
{'loss': 0.4646, 'grad_norm': 16.352258682250977, 'learning_rate': 8.287732866814942e-06, 'epoch': 3.58}
{'loss': 0.4179, 'grad_norm': 6.0580549240112305, 'learning_rate': 7.704031712989171e-06, 'epoch': 3.97}
{'loss': 0.4229, 'grad_norm': 7.072256088256836, 'learning_rate': 7.069550955626361e-06, 'epoch': 4.39}
{'loss': 0.3113, 'grad_norm': 7.322362899780273, 'learning_rate': 6.3966400409574135e-06, 'epoch': 4.77}
{'loss': 0.2402, 'grad_norm': 4.10548734664917, 'learning_rate': 5.69839641451154e-06, 'epoch': 5.19}
{'loss': 0.1419, 'grad_norm': 5.798092365264893, 'learning_rate': 4.988410594237153e-06, 'epoch': 5.58}
{'loss': 0.107, 'grad_norm': 3.1927907466888428, 'learning_rate': 4.280501646528997e-06, 'epoch': 5.97}
{'loss': 0.122, 'grad_norm': 3.3602075576782227, 'learning_rate': 3.5884482138197167e-06, 'epoch': 6.39}
{'loss': 0.1097, 'grad_norm': 5.6795196533203125, 'learning_rate': 2.925720328977883e-06, 'epoch': 6.77}
{'loss': 0.1132, 'grad_norm': 3.1390275955200195, 'learning_rate': 2.305217236440151e-06, 'epoch': 7.19}
{'loss': 0.1039, 'grad_norm': 5.509203910827637, 'learning_rate': 1.7390163230909584e-06, 'epoch': 7.58}
{'loss': 0.0903, 'grad_norm': 2.9475345611572266, 'learning_rate': 1.238138045664657e-06, 'epoch': 7.97}
{'loss': 0.1073, 'grad_norm': 6.050095081329346, 'learning_rate': 8.123314300907496e-07, 'epoch': 8.39}
{'loss': 0.0907, 'grad_norm': 3.7081170082092285, 'learning_rate': 4.698843177935391e-07, 'epoch': 8.77}
{'loss': 0.0963, 'grad_norm': 3.1451141834259033, 'learning_rate': 2.1746205228607216e-07, 'epoch': 9.19}
{'loss': 0.1, 'grad_norm': 5.0410566329956055, 'learning_rate': 5.997774584038125e-08, 'epoch': 9.58}
=== JOB_STATISTICS ===
=== current date     : Sun Dec 21 06:04:51 AM CET 2025
= Job-ID             : 1471141 on tinygpu
= Job-Name           : schmuck_hpo
= Job-Command        : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles/job_gemma2.sh
= Initial workdir    : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles
= Queue/Partition    : a100
= Slurm account      : iwi5 with QOS=normal
= Requested resources:  for 1-00:00:00
= Elapsed runtime    : 1-00:00:12
= Total RAM usage    : 12.4 GiB of requested  GiB (%)   
= Node list          : tg091
= Subm/Elig/Start/End: 2025-12-19T20:38:57 / 2025-12-19T20:38:57 / 2025-12-20T06:04:37 / 2025-12-21T06:04:49
======================
=== Quota infos ======
    Path                 Used     SoftQ    HardQ    Gracetime  Filec    FileQ    FiHaQ    FileGrace    
    /home/hpc              88.3G   104.9G   209.7G        N/A  29,017      500K   1,000K        N/A    
    /home/woody           219.5G  1000.0G  1500.0G        N/A   1,015K   5,000K   7,500K        N/A    
    /home/vault           959.0G  1048.6G  2097.2G        N/A   7,331      200K     400K        N/A    
======================
=== GPU utilization ==
gpu_name, gpu_bus_id, pid, gpu_utilization [%], mem_utilization [%], max_memory_usage [MiB], time [ms]
NVIDIA A100-SXM4-40GB, 00000000:C1:00.0, 500909, 35 %, 14 %, 12850 MiB, 86382220 ms
