Unsloth: KwargsForCausalLM cannot be inherited from TransformersKwargs since it's of type = <class 'type'>
/home/woody/iwi5/iwi5298h/software/private/conda/envs/qwen_vision/lib/python3.11/site-packages/optuna/_experimental.py:32: ExperimentalWarning: Argument ``multivariate`` is an experimental feature. The interface can change in the future.
  warnings.warn(
/home/woody/iwi5/iwi5298h/software/private/conda/envs/qwen_vision/lib/python3.11/site-packages/optuna/_experimental.py:32: ExperimentalWarning: Argument ``group`` is an experimental feature. The interface can change in the future.
  warnings.warn(
[I 2025-12-23 05:35:18,767] A new study created in RDB with name: gemma3_schmuck_data
[W 2025-12-23 05:35:19,080] Trial 0 failed with parameters: {'learning_rate': 0.00011844319751820385, 'weight_decay': 0.08927180304353628, 'lora_r': 8, 'lora_alpha': 64, 'lora_dropout': 0.10621088666940683, 'gradient_accumulation_steps': 8, 'num_epochs': 6} because of the following error: FileNotFoundError('/home/vault/iwi5/iwi5298h/models/gemma3/*.json (invalid repository id)').
Traceback (most recent call last):
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/qwen_vision/lib/python3.11/site-packages/huggingface_hub/hf_file_system.py", line 125, in _repo_and_revision_exist
    self._api.repo_info(
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/qwen_vision/lib/python3.11/site-packages/huggingface_hub/utils/_validators.py", line 106, in _inner_fn
    validate_repo_id(arg_value)
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/qwen_vision/lib/python3.11/site-packages/huggingface_hub/utils/_validators.py", line 160, in validate_repo_id
    raise HFValidationError(
huggingface_hub.errors.HFValidationError: Repo id must use alphanumeric chars or '-', '_', '.', '--' and '..' are forbidden, '-' and '.' cannot start or end the name, max length is 96: '/home'.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/qwen_vision/lib/python3.11/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/gemma3/hpo/schmuck_hpo.py", line 582, in objective
    val_cer = train_one_config(
              ^^^^^^^^^^^^^^^^^
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/gemma3/hpo/schmuck_hpo.py", line 445, in train_one_config
    finetuner = SchmuckOCRHPOGemma3(
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/gemma3/hpo/schmuck_hpo.py", line 116, in __init__
    self.model, self.processor = FastVisionModel.from_pretrained(
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/qwen_vision/lib/python3.11/site-packages/unsloth/models/loader.py", line 651, in from_pretrained
    files = HfFileSystem(token = token).glob(f"{model_name}/*.json")
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/qwen_vision/lib/python3.11/site-packages/huggingface_hub/hf_file_system.py", line 515, in glob
    path = self.resolve_path(path, revision=kwargs.get("revision")).unresolve()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/qwen_vision/lib/python3.11/site-packages/huggingface_hub/hf_file_system.py", line 216, in resolve_path
    _raise_file_not_found(path, err)
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/qwen_vision/lib/python3.11/site-packages/huggingface_hub/hf_file_system.py", line 1124, in _raise_file_not_found
    raise FileNotFoundError(msg) from err
FileNotFoundError: /home/vault/iwi5/iwi5298h/models/gemma3/*.json (invalid repository id)
[W 2025-12-23 05:35:19,181] Trial 0 failed with value None.
Traceback (most recent call last):
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/qwen_vision/lib/python3.11/site-packages/huggingface_hub/hf_file_system.py", line 125, in _repo_and_revision_exist
    self._api.repo_info(
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/qwen_vision/lib/python3.11/site-packages/huggingface_hub/utils/_validators.py", line 106, in _inner_fn
    validate_repo_id(arg_value)
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/qwen_vision/lib/python3.11/site-packages/huggingface_hub/utils/_validators.py", line 160, in validate_repo_id
    raise HFValidationError(
huggingface_hub.errors.HFValidationError: Repo id must use alphanumeric chars or '-', '_', '.', '--' and '..' are forbidden, '-' and '.' cannot start or end the name, max length is 96: '/home'.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/gemma3/hpo/schmuck_hpo.py", line 650, in <module>
    main()
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/gemma3/hpo/schmuck_hpo.py", line 646, in main
    run_optuna_hpo()
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/gemma3/hpo/schmuck_hpo.py", line 596, in run_optuna_hpo
    study.optimize(objective, n_trials=remaining, gc_after_trial=True)
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/qwen_vision/lib/python3.11/site-packages/optuna/study/study.py", line 490, in optimize
    _optimize(
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/qwen_vision/lib/python3.11/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/qwen_vision/lib/python3.11/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial_id = _run_trial(study, func, catch)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/qwen_vision/lib/python3.11/site-packages/optuna/study/_optimize.py", line 258, in _run_trial
    raise func_err
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/qwen_vision/lib/python3.11/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/gemma3/hpo/schmuck_hpo.py", line 582, in objective
    val_cer = train_one_config(
              ^^^^^^^^^^^^^^^^^
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/gemma3/hpo/schmuck_hpo.py", line 445, in train_one_config
    finetuner = SchmuckOCRHPOGemma3(
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/gemma3/hpo/schmuck_hpo.py", line 116, in __init__
    self.model, self.processor = FastVisionModel.from_pretrained(
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/qwen_vision/lib/python3.11/site-packages/unsloth/models/loader.py", line 651, in from_pretrained
    files = HfFileSystem(token = token).glob(f"{model_name}/*.json")
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/qwen_vision/lib/python3.11/site-packages/huggingface_hub/hf_file_system.py", line 515, in glob
    path = self.resolve_path(path, revision=kwargs.get("revision")).unresolve()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/qwen_vision/lib/python3.11/site-packages/huggingface_hub/hf_file_system.py", line 216, in resolve_path
    _raise_file_not_found(path, err)
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/qwen_vision/lib/python3.11/site-packages/huggingface_hub/hf_file_system.py", line 1124, in _raise_file_not_found
    raise FileNotFoundError(msg) from err
FileNotFoundError: /home/vault/iwi5/iwi5298h/models/gemma3/*.json (invalid repository id)
