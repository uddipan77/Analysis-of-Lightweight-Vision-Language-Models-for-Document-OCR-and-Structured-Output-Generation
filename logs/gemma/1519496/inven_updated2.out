### Starting TaskPrologue of job 1519496 on tg097 at Fri Jan 30 03:27:05 PM CET 2026
Running on cores 0-31 with governor ondemand
Fri Jan 30 15:27:05 2026       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 580.126.09             Driver Version: 580.126.09     CUDA Version: 13.0     |
+-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-40GB          On  |   00000000:01:00.0 Off |                    0 |
| N/A   39C    P0             54W /  400W |       0MiB /  40960MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
### Finished TaskPrologue

ü¶• Unsloth: Will patch your computer to enable 2x faster free finetuning.
ü¶• Unsloth Zoo will now patch everything to make training faster!
Created run directory: /home/vault/iwi5/iwi5298h/models_image_text/gemma/inventory_dataset/run_A100_genCER_20260130_152820

============================================================
GEMMA-3 INVENTORY - BEST BY AUTOREGRESSIVE GEN-CER (SAVE ONLY ONE)
============================================================
Loading Gemma-3 vision model with Unsloth for INVENTORY...
Temporary directory for augmented images: /tmp/1519496.tinygpu/inventory_gemma_aug_u67ba9xx
Augmentation factor (per original image): 1
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Gemma3 patching. Transformers: 4.51.3.
   \\   /|    NVIDIA A100-SXM4-40GB. Num GPUs = 1. Max memory: 39.493 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 8.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Gemma3 does not support SDPA - switching to eager!
Model loaded - Unsloth auto-configured dtype and attention
Unsloth: Making `base_model.model.vision_tower.vision_model` require gradients
Gemma-3 vision model loaded with A100-optimized LoRA config

============================================================
STARTING TRAINING (A100-OPTIMIZED, INVENTORY)
============================================================
Preparing training and validation datasets for INVENTORY...
Preparing INVENTORY TRAIN data with augmentation factor = 1
Training: 426 samples (original: 213, augmented: 213)
Validation/Test: 47 valid samples out of 47 total (no augmentation)
Training: 426 samples, Validation: 47 samples
[GenCER Callback] Fixed val subset size = 47
GPU = NVIDIA A100-SXM4-40GB. Max memory = 39.493 GB.
4.809 GB of memory reserved.
Starting training (best checkpoint selected by autoregressive gen-CER)...
{'loss': 79.8361, 'grad_norm': 604.5905151367188, 'learning_rate': 0.0, 'epoch': 0.04}
{'loss': 80.1375, 'grad_norm': 766.3023071289062, 'learning_rate': 1.2000000000000002e-06, 'epoch': 0.19}
{'loss': 79.1574, 'grad_norm': 1974.5810546875, 'learning_rate': 2.7e-06, 'epoch': 0.38}
{'loss': 69.9503, 'grad_norm': 416.6203918457031, 'learning_rate': 4.2000000000000004e-06, 'epoch': 0.56}
{'loss': 59.9242, 'grad_norm': 265.4140625, 'learning_rate': 5.7000000000000005e-06, 'epoch': 0.75}
{'loss': 51.8212, 'grad_norm': 142.8717041015625, 'learning_rate': 7.2e-06, 'epoch': 0.94}
{'eval_loss': 2.8788254261016846, 'eval_runtime': 22.7314, 'eval_samples_per_second': 2.068, 'eval_steps_per_second': 2.068, 'epoch': 1.0}

[GenCER Callback] Epoch 1.00 gen_cer = 0.6475 (64.75%)
{'loss': 42.2494, 'grad_norm': 119.53287506103516, 'learning_rate': 8.7e-06, 'epoch': 1.11}
{'loss': 40.9044, 'grad_norm': 76.55547332763672, 'learning_rate': 1.02e-05, 'epoch': 1.3}
{'loss': 36.0034, 'grad_norm': 74.13114929199219, 'learning_rate': 1.1700000000000001e-05, 'epoch': 1.49}
{'loss': 32.325, 'grad_norm': 73.48773956298828, 'learning_rate': 1.32e-05, 'epoch': 1.68}
{'loss': 28.1876, 'grad_norm': 43.94932174682617, 'learning_rate': 1.47e-05, 'epoch': 1.86}
{'eval_loss': 1.6653199195861816, 'eval_runtime': 22.1147, 'eval_samples_per_second': 2.125, 'eval_steps_per_second': 2.125, 'epoch': 2.0}

[GenCER Callback] Epoch 2.00 gen_cer = 0.3383 (33.83%)
{'loss': 24.3371, 'grad_norm': 163.5607147216797, 'learning_rate': 1.62e-05, 'epoch': 2.04}
{'loss': 25.6109, 'grad_norm': 42.81447982788086, 'learning_rate': 1.77e-05, 'epoch': 2.23}
{'loss': 25.0188, 'grad_norm': 34.609439849853516, 'learning_rate': 1.9200000000000003e-05, 'epoch': 2.41}
{'loss': 23.5782, 'grad_norm': 34.44975662231445, 'learning_rate': 2.07e-05, 'epoch': 2.6}
{'loss': 24.3863, 'grad_norm': 31.930727005004883, 'learning_rate': 2.22e-05, 'epoch': 2.79}
{'loss': 23.2298, 'grad_norm': 27.121156692504883, 'learning_rate': 2.37e-05, 'epoch': 2.98}
{'eval_loss': 1.481497049331665, 'eval_runtime': 21.734, 'eval_samples_per_second': 2.163, 'eval_steps_per_second': 2.163, 'epoch': 3.0}

[GenCER Callback] Epoch 3.00 gen_cer = 0.2472 (24.72%)
{'loss': 20.5473, 'grad_norm': 25.363100051879883, 'learning_rate': 2.52e-05, 'epoch': 3.15}
{'loss': 22.0629, 'grad_norm': 35.728736877441406, 'learning_rate': 2.6700000000000002e-05, 'epoch': 3.34}
{'loss': 22.6259, 'grad_norm': 26.82596778869629, 'learning_rate': 2.8199999999999998e-05, 'epoch': 3.53}
{'loss': 21.2456, 'grad_norm': 34.37440490722656, 'learning_rate': 2.97e-05, 'epoch': 3.71}
{'loss': 21.2693, 'grad_norm': 52.999839782714844, 'learning_rate': 2.9985919533659653e-05, 'epoch': 3.9}
{'eval_loss': 1.4381134510040283, 'eval_runtime': 21.9174, 'eval_samples_per_second': 2.144, 'eval_steps_per_second': 2.144, 'epoch': 4.0}

[GenCER Callback] Epoch 4.00 gen_cer = 0.2772 (27.72%)
{'loss': 19.6309, 'grad_norm': 27.203968048095703, 'learning_rate': 2.992876294154013e-05, 'epoch': 4.08}
{'loss': 20.3632, 'grad_norm': 32.65791702270508, 'learning_rate': 2.9827817715520775e-05, 'epoch': 4.26}
{'loss': 20.2416, 'grad_norm': 29.695941925048828, 'learning_rate': 2.968337994534213e-05, 'epoch': 4.45}
{'loss': 19.3873, 'grad_norm': 52.78642654418945, 'learning_rate': 2.9495873291870436e-05, 'epoch': 4.64}
{'loss': 19.4993, 'grad_norm': 29.6543025970459, 'learning_rate': 2.9265847744427305e-05, 'epoch': 4.83}
{'loss': 18.0693, 'grad_norm': 33.19831466674805, 'learning_rate': 2.8993978007576263e-05, 'epoch': 5.0}
{'eval_loss': 1.4509186744689941, 'eval_runtime': 21.6613, 'eval_samples_per_second': 2.17, 'eval_steps_per_second': 2.17, 'epoch': 5.0}

[GenCER Callback] Epoch 5.00 gen_cer = 0.2396 (23.96%)
{'loss': 18.8716, 'grad_norm': 31.544981002807617, 'learning_rate': 2.868106152209805e-05, 'epoch': 5.19}
{'loss': 18.0674, 'grad_norm': 40.4828987121582, 'learning_rate': 2.832801612595937e-05, 'epoch': 5.38}
{'loss': 17.8544, 'grad_norm': 36.118412017822266, 'learning_rate': 2.793587736213603e-05, 'epoch': 5.56}
{'loss': 17.4666, 'grad_norm': 38.09243392944336, 'learning_rate': 2.7505795441186953e-05, 'epoch': 5.75}
{'loss': 17.5409, 'grad_norm': 33.78703308105469, 'learning_rate': 2.703903186748843e-05, 'epoch': 5.94}
{'eval_loss': 1.510581612586975, 'eval_runtime': 21.6209, 'eval_samples_per_second': 2.174, 'eval_steps_per_second': 2.174, 'epoch': 6.0}

[GenCER Callback] Epoch 6.00 gen_cer = 0.2541 (25.41%)
{'train_runtime': 16026.0981, 'train_samples_per_second': 0.399, 'train_steps_per_second': 0.024, 'train_loss': 30.474704695336612, 'epoch': 6.0}

=== BEST CHECKPOINT INFO ===
Best checkpoint: /home/vault/iwi5/iwi5298h/models_image_text/gemma/inventory_dataset/run_A100_genCER_20260130_152820/checkpoint-135
Best metric (gen_cer): 0.23955550346903673

Saving ONLY best model to: /home/vault/iwi5/iwi5298h/models_image_text/gemma/inventory_dataset/run_A100_genCER_20260130_152820/best_model_gen_cer

Cleaning up: removing checkpoint-* folders (keeping only best_model_gen_cer)...
16026.0981 seconds used for training.
Peak reserved memory = 9.291 GB (23.526%).

Best model already saved (ONLY ONE) at: /home/vault/iwi5/iwi5298h/models_image_text/gemma/inventory_dataset/run_A100_genCER_20260130_152820/best_model_gen_cer

============================================================
STARTING EVALUATION ON INVENTORY TEST.JSONL
============================================================
Starting evaluation on INVENTORY test.jsonl with aggressive chunking...
Loaded 48 test samples

============================================================
Chunk 1/10 (5 images)
============================================================

[1/48] Processing: inventarbuch-022.jpg
  ‚úÖ CER: 0.2346 (23.46%)

[2/48] Processing: inventarbuch-099.jpg
  ‚úÖ CER: 0.1688 (16.88%)

[3/48] Processing: inventarbuch-245.jpg
  ‚úÖ CER: 0.2445 (24.45%)

[4/48] Processing: inventarbuch-263.jpg
  ‚úÖ CER: 0.1359 (13.59%)

[5/48] Processing: inventarbuch-033.jpg
  ‚úÖ CER: 0.3435 (34.35%)

Chunk 1 completed. Cleaning memory...

============================================================
Chunk 2/10 (5 images)
============================================================

[6/48] Processing: inventarbuch-143.jpg
  ‚úÖ CER: 0.1872 (18.72%)

[7/48] Processing: inventarbuch-244.jpg
  ‚úÖ CER: 0.3879 (38.79%)

[8/48] Processing: inventarbuch-024.jpg
  ‚úÖ CER: 0.0410 (4.10%)

[9/48] Processing: inventarbuch-141.jpg
  ‚úÖ CER: 0.1018 (10.18%)

[10/48] Processing: inventarbuch-183.jpg
  ‚úÖ CER: 1.0000 (100.00%)

Chunk 2 completed. Cleaning memory...

============================================================
Chunk 3/10 (5 images)
============================================================

[11/48] Processing: inventarbuch-191.jpg
  ‚úÖ CER: 0.2086 (20.86%)

[12/48] Processing: inventarbuch-051.jpg
  ‚úÖ CER: 0.0968 (9.68%)

[13/48] Processing: inventarbuch-203.jpg
  ‚úÖ CER: 0.1806 (18.06%)

[14/48] Processing: inventarbuch-296.jpg
  ‚úÖ CER: 0.2830 (28.30%)

[15/48] Processing: inventarbuch-302.jpg
  ‚úÖ CER: 0.0369 (3.69%)

Chunk 3 completed. Cleaning memory...
Saved intermediate results to: /home/vault/iwi5/iwi5298h/models_image_text/gemma/inventory_dataset/run_A100_genCER_20260130_152820/test_predictions_chunk_3.jsonl

============================================================
Chunk 4/10 (5 images)
============================================================

[16/48] Processing: inventarbuch-179.jpg
  ‚úÖ CER: 0.2211 (22.11%)

[17/48] Processing: inventarbuch-114.jpg
  ‚úÖ CER: 0.2857 (28.57%)

[18/48] Processing: inventarbuch-082.jpg
  ‚úÖ CER: 0.3299 (32.99%)

[19/48] Processing: inventarbuch-287.jpg
  ‚úÖ CER: 0.2871 (28.71%)

[20/48] Processing: inventarbuch-181.jpg
  ‚úÖ CER: 0.2177 (21.77%)

Chunk 4 completed. Cleaning memory...

============================================================
Chunk 5/10 (5 images)
============================================================

[21/48] Processing: inventarbuch-299.jpg
  ‚úÖ CER: 0.2607 (26.07%)

[22/48] Processing: inventarbuch-084.jpg
  ‚úÖ CER: 0.4167 (41.67%)

[23/48] Processing: inventarbuch-004.jpg
  ‚úÖ CER: 0.2575 (25.75%)

[24/48] Processing: inventarbuch-148.jpg
  ‚úÖ CER: 0.1270 (12.70%)

[25/48] Processing: inventarbuch-238.jpg
  ‚úÖ CER: 0.3204 (32.04%)

Chunk 5 completed. Cleaning memory...

============================================================
Chunk 6/10 (5 images)
============================================================

[26/48] Processing: inventarbuch-116.jpg
  ‚úÖ CER: 0.1529 (15.29%)

[27/48] Processing: inventarbuch-223.jpg
  ‚ùå Error: p.attn_bias_ptr is not correctly aligned

[28/48] Processing: inventarbuch-104.jpg
  ‚úÖ CER: 0.2836 (28.36%)

[29/48] Processing: inventarbuch-015.jpg
  ‚úÖ CER: 0.2444 (24.44%)

[30/48] Processing: inventarbuch-272.jpg
  ‚úÖ CER: 0.2281 (22.81%)

Chunk 6 completed. Cleaning memory...
Saved intermediate results to: /home/vault/iwi5/iwi5298h/models_image_text/gemma/inventory_dataset/run_A100_genCER_20260130_152820/test_predictions_chunk_6.jsonl

============================================================
Chunk 7/10 (5 images)
============================================================

[31/48] Processing: inventarbuch-124.jpg
  ‚úÖ CER: 0.1353 (13.53%)

[32/48] Processing: inventarbuch-115.jpg
  ‚úÖ CER: 0.3538 (35.38%)

[33/48] Processing: inventarbuch-049.jpg
  ‚úÖ CER: 0.0216 (2.16%)

[34/48] Processing: inventarbuch-017.jpg
  ‚úÖ CER: 0.0798 (7.98%)

[35/48] Processing: inventarbuch-018.jpg
  ‚úÖ CER: 0.3042 (30.42%)

Chunk 7 completed. Cleaning memory...

============================================================
Chunk 8/10 (5 images)
============================================================

[36/48] Processing: inventarbuch-225.jpg
  ‚úÖ CER: 0.3836 (38.36%)

[37/48] Processing: inventarbuch-046.jpg
  ‚úÖ CER: 0.3186 (31.86%)

[38/48] Processing: inventarbuch-294.jpg
  ‚úÖ CER: 0.1282 (12.82%)

[39/48] Processing: inventarbuch-054.jpg
  ‚úÖ CER: 0.3587 (35.87%)

[40/48] Processing: inventarbuch-073.jpg
  ‚úÖ CER: 0.3526 (35.26%)

Chunk 8 completed. Cleaning memory...

============================================================
Chunk 9/10 (5 images)
============================================================

[41/48] Processing: inventarbuch-118.jpg
  ‚úÖ CER: 0.1895 (18.95%)

[42/48] Processing: inventarbuch-130.jpg
  ‚úÖ CER: 0.1990 (19.90%)

[43/48] Processing: inventarbuch-146.jpg
  ‚úÖ CER: 0.2860 (28.60%)

[44/48] Processing: inventarbuch-014.jpg
  ‚úÖ CER: 0.2372 (23.72%)

[45/48] Processing: inventarbuch-059.jpg
  ‚úÖ CER: 0.2266 (22.66%)

Chunk 9 completed. Cleaning memory...
Saved intermediate results to: /home/vault/iwi5/iwi5298h/models_image_text/gemma/inventory_dataset/run_A100_genCER_20260130_152820/test_predictions_chunk_9.jsonl

============================================================
Chunk 10/10 (3 images)
============================================================

[46/48] Processing: inventarbuch-256.jpg
  ‚úÖ CER: 0.2085 (20.85%)

[47/48] Processing: inventarbuch-260.jpg
  ‚úÖ CER: 0.1746 (17.46%)

[48/48] Processing: inventarbuch-279.jpg
  ‚úÖ CER: 0.9387 (93.87%)

Chunk 10 completed. Cleaning memory...
Saved intermediate results to: /home/vault/iwi5/iwi5298h/models_image_text/gemma/inventory_dataset/run_A100_genCER_20260130_152820/test_predictions_chunk_10.jsonl

CER evaluation results saved to: /home/vault/iwi5/iwi5298h/models_image_text/gemma/inventory_dataset/run_A100_genCER_20260130_152820/cer_evaluation_results.txt

üéâ Gemma-3 Inventory training completed!
All outputs saved to: /home/vault/iwi5/iwi5298h/models_image_text/gemma/inventory_dataset/run_A100_genCER_20260130_152820

Final CER: 0.2746 (27.46%)
Best VALIDATION gen-CER (autoregressive): 0.2396 (23.96%)
ONLY saved best model at: /home/vault/iwi5/iwi5298h/models_image_text/gemma/inventory_dataset/run_A100_genCER_20260130_152820/best_model_gen_cer
Cleaned up temporary directory: /tmp/1519496.tinygpu/inventory_gemma_aug_u67ba9xx
Gemma-3 training completed at: Fri Jan 30 08:32:19 PM CET 2026
=== JOB_STATISTICS ===
=== current date     : Fri Jan 30 08:32:19 PM CET 2026
= Job-ID             : 1519496 on tinygpu
= Job-Name           : inven_updated2
= Job-Command        : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles/job_gemma2.sh
= Initial workdir    : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles
= Queue/Partition    : a100
= Slurm account      : iwi5 with QOS=normal
= Requested resources:  for 1-00:00:00
= Elapsed runtime    : 05:05:14
= Total RAM usage    : 7.8 GiB of requested  GiB (%)   
= Node list          : tg097
= Subm/Elig/Start/End: 2026-01-28T15:52:29 / 2026-01-28T15:52:29 / 2026-01-30T15:27:05 / 2026-01-30T20:32:19
======================
=== Quota infos ======
    Path                 Used     SoftQ    HardQ    Gracetime  Filec    FileQ    FiHaQ    FileGrace    
    /home/woody           219.6G  1000.0G  1500.0G        N/A   1,017K   5,000K   7,500K        N/A    
    /home/hpc              88.1G   104.9G   209.7G        N/A  29,334      500K   1,000K        N/A    
!!! /home/vault          1123.6G  1048.6G  2097.2G  -29221days   8,741      200K     400K        N/A !!!
======================
=== GPU utilization ==
gpu_name, gpu_bus_id, pid, gpu_utilization [%], mem_utilization [%], max_memory_usage [MiB], time [ms]
NVIDIA A100-SXM4-40GB, 00000000:01:00.0, 219251, 24 %, 4 %, 10056 MiB, 18299156 ms
