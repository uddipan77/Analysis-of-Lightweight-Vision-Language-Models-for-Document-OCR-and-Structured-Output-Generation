### Starting TaskPrologue of job 1162793 on tg073 at Thu Aug  7 03:06:52 PM CEST 2025
Running on cores 4-5,12-13,20-21,28-29 with governor ondemand
Thu Aug  7 15:06:52 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.158.01             Driver Version: 570.158.01     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-PCIE-32GB           On  |   00000000:86:00.0 Off |                    0 |
| N/A   31C    P0             24W /  250W |       0MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
### Finished TaskPrologue

===================================
DONUT Staircase Dataset Fine-tuning Configuration:
===================================
Job ID: 1162793
Log Directory: /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/logs/DONUT/1162793
Data Directory: /home/woody/iwi5/iwi5298h/json_staircase
Image Directory: /home/woody/iwi5/iwi5298h/staircase_images
Model Cache Directory: /home/vault/iwi5/iwi5298h/models/donut_cord
Output Directory: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_cord/donut_cord_20250807_150654
Num Epochs: 30
Batch Size: 2
Learning Rate: 2e-5
Max Length: 768
Prediction On: test
Prediction Batch Size: 1
Early Stopping Patience: 10
Early Stopping Threshold: 0.005
Augmentation Factor: 3
Disable Augmentation: false
===================================
Running command: python3 staircase_cord.py     --data_dir "/home/woody/iwi5/iwi5298h/json_staircase"     --image_dir "/home/woody/iwi5/iwi5298h/staircase_images"     --epochs 30     --batch_size 2     --lr 2e-5     --max_length 768     --predict_on "test"     --prediction_batch_size 1     --early_stopping_patience 10     --early_stopping_threshold 0.005     --augmentation_factor 3
===================================
[2025-08-07 15:07:07,560] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-08-07 15:07:10,196] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
Using device: cuda
All output will be saved in: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_cord/donut_cord_20250807_150711
Checking for model at: /home/vault/iwi5/iwi5298h/models/donut_cord
Model already exists at /home/vault/iwi5/iwi5298h/models/donut_cord, loading from local cache...
=== MODEL STRUCTURE INSPECTION ===
Model config keys: ['return_dict', 'output_hidden_states', 'output_attentions', 'torchscript', 'torch_dtype', 'use_bfloat16', 'tf_legacy_loss', 'pruned_heads', 'tie_word_embeddings', 'chunk_size_feed_forward', 'is_encoder_decoder', 'is_decoder', 'cross_attention_hidden_size', 'add_cross_attention', 'tie_encoder_decoder', 'max_length', 'min_length', 'do_sample', 'early_stopping', 'num_beams', 'num_beam_groups', 'diversity_penalty', 'temperature', 'top_k', 'top_p', 'typical_p', 'repetition_penalty', 'length_penalty', 'no_repeat_ngram_size', 'encoder_no_repeat_ngram_size', 'bad_words_ids', 'num_return_sequences', 'output_scores', 'return_dict_in_generate', 'forced_bos_token_id', 'forced_eos_token_id', 'remove_invalid_values', 'exponential_decay_length_penalty', 'suppress_tokens', 'begin_suppress_tokens', 'architectures', 'finetuning_task', 'id2label', 'label2id', 'tokenizer_class', 'prefix', 'bos_token_id', 'pad_token_id', 'eos_token_id', 'sep_token_id', 'decoder_start_token_id', 'task_specific_params', 'problem_type', '_name_or_path', '_commit_hash', '_attn_implementation_internal', '_attn_implementation_autoset', 'transformers_version', 'decoder', 'encoder', 'model_type']
Decoder config keys: ['vocab_size', 'max_position_embeddings', 'd_model', 'encoder_ffn_dim', 'encoder_layers', 'encoder_attention_heads', 'decoder_ffn_dim', 'decoder_layers', 'decoder_attention_heads', 'dropout', 'attention_dropout', 'activation_dropout', 'activation_function', 'init_std', 'encoder_layerdrop', 'decoder_layerdrop', 'classifier_dropout', 'use_cache', 'num_hidden_layers', 'scale_embedding', 'return_dict', 'output_hidden_states', 'output_attentions', 'torchscript', 'torch_dtype', 'use_bfloat16', 'tf_legacy_loss', 'pruned_heads', 'tie_word_embeddings', 'chunk_size_feed_forward', 'is_encoder_decoder', 'is_decoder', 'cross_attention_hidden_size', 'add_cross_attention', 'tie_encoder_decoder', 'max_length', 'min_length', 'do_sample', 'early_stopping', 'num_beams', 'num_beam_groups', 'diversity_penalty', 'temperature', 'top_k', 'top_p', 'typical_p', 'repetition_penalty', 'length_penalty', 'no_repeat_ngram_size', 'encoder_no_repeat_ngram_size', 'bad_words_ids', 'num_return_sequences', 'output_scores', 'return_dict_in_generate', 'forced_bos_token_id', 'forced_eos_token_id', 'remove_invalid_values', 'exponential_decay_length_penalty', 'suppress_tokens', 'begin_suppress_tokens', 'architectures', 'finetuning_task', 'id2label', 'label2id', 'tokenizer_class', 'prefix', 'bos_token_id', 'pad_token_id', 'eos_token_id', 'sep_token_id', 'decoder_start_token_id', 'task_specific_params', 'problem_type', '_name_or_path', '_commit_hash', '_attn_implementation_internal', '_attn_implementation_autoset', 'transformers_version', 'add_final_layer_norm']
Found model.decoder.config.max_position_embeddings: 768
Loaded 26 original samples from /home/woody/iwi5/iwi5298h/json_staircase/train.jsonl
Created 104 total samples with 3x augmentation
Loaded 9 original samples from /home/woody/iwi5/iwi5298h/json_staircase/val.jsonl
Using 9 samples without augmentation
Loaded 9 original samples from /home/woody/iwi5/iwi5298h/json_staircase/test.jsonl
Using 9 samples without augmentation
Starting training...
Model selection based on: eval_cer_jiwer (lower is better)
{'loss': 5.5378, 'grad_norm': 21.982881546020508, 'learning_rate': 3.6000000000000003e-06, 'epoch': 0.38}
{'loss': 3.7312, 'grad_norm': 33.643314361572266, 'learning_rate': 7.600000000000001e-06, 'epoch': 0.77}
{'eval_loss': 2.355797290802002, 'eval_cer_jiwer': 74.08231757842255, 'eval_cer_structured': 74.1309334745015, 'eval_runtime': 27.5457, 'eval_samples_per_second': 0.327, 'eval_steps_per_second': 0.182, 'epoch': 1.0}
{'loss': 2.6838, 'grad_norm': 4.552222728729248, 'learning_rate': 1.16e-05, 'epoch': 1.15}
{'loss': 1.6678, 'grad_norm': 3.038339614868164, 'learning_rate': 1.5600000000000003e-05, 'epoch': 1.54}
{'loss': 1.2215, 'grad_norm': 2.7286131381988525, 'learning_rate': 1.9600000000000002e-05, 'epoch': 1.92}
{'eval_loss': 0.905115008354187, 'eval_cer_jiwer': 59.504211364061476, 'eval_cer_structured': 59.749426504323274, 'eval_runtime': 43.8173, 'eval_samples_per_second': 0.205, 'eval_steps_per_second': 0.114, 'epoch': 2.0}
{'loss': 0.8412, 'grad_norm': 2.682074546813965, 'learning_rate': 1.9753424657534247e-05, 'epoch': 2.31}
{'loss': 0.5403, 'grad_norm': 2.62719988822937, 'learning_rate': 1.947945205479452e-05, 'epoch': 2.69}
{'eval_loss': 0.3943033516407013, 'eval_cer_jiwer': 57.86975702838881, 'eval_cer_structured': 58.461266984295044, 'eval_runtime': 48.6284, 'eval_samples_per_second': 0.185, 'eval_steps_per_second': 0.103, 'epoch': 3.0}
{'loss': 0.3811, 'grad_norm': 1.9092600345611572, 'learning_rate': 1.9205479452054796e-05, 'epoch': 3.08}
{'loss': 0.2724, 'grad_norm': 2.2039759159088135, 'learning_rate': 1.893150684931507e-05, 'epoch': 3.46}
{'loss': 0.2172, 'grad_norm': 1.9374709129333496, 'learning_rate': 1.8657534246575345e-05, 'epoch': 3.85}
{'eval_loss': 0.28168243169784546, 'eval_cer_jiwer': 54.67807750956144, 'eval_cer_structured': 54.402682195164985, 'eval_runtime': 51.253, 'eval_samples_per_second': 0.176, 'eval_steps_per_second': 0.098, 'epoch': 4.0}
{'loss': 0.2116, 'grad_norm': 1.6653332710266113, 'learning_rate': 1.838356164383562e-05, 'epoch': 4.23}
{'loss': 0.1564, 'grad_norm': 1.8720753192901611, 'learning_rate': 1.810958904109589e-05, 'epoch': 4.62}
{'loss': 0.1335, 'grad_norm': 4.857086181640625, 'learning_rate': 1.7835616438356165e-05, 'epoch': 5.0}
{'eval_loss': 0.2686740756034851, 'eval_cer_jiwer': 54.636420344397465, 'eval_cer_structured': 54.879124757367215, 'eval_runtime': 44.3552, 'eval_samples_per_second': 0.203, 'eval_steps_per_second': 0.113, 'epoch': 5.0}
{'loss': 0.1063, 'grad_norm': 1.8051155805587769, 'learning_rate': 1.756164383561644e-05, 'epoch': 5.38}
{'loss': 0.101, 'grad_norm': 2.319789171218872, 'learning_rate': 1.7287671232876714e-05, 'epoch': 5.77}
{'eval_loss': 0.2528146803379059, 'eval_cer_jiwer': 55.49427810346822, 'eval_cer_structured': 55.196753132168695, 'eval_runtime': 38.313, 'eval_samples_per_second': 0.235, 'eval_steps_per_second': 0.131, 'epoch': 6.0}
{'loss': 0.0848, 'grad_norm': 1.6591300964355469, 'learning_rate': 1.701369863013699e-05, 'epoch': 6.15}
{'loss': 0.0726, 'grad_norm': 1.9451881647109985, 'learning_rate': 1.673972602739726e-05, 'epoch': 6.54}
{'loss': 0.0697, 'grad_norm': 1.7499639987945557, 'learning_rate': 1.6465753424657534e-05, 'epoch': 6.92}
{'eval_loss': 0.26081711053848267, 'eval_cer_jiwer': 55.02570809668299, 'eval_cer_structured': 54.93206281983413, 'eval_runtime': 40.8719, 'eval_samples_per_second': 0.22, 'eval_steps_per_second': 0.122, 'epoch': 7.0}
{'loss': 0.0531, 'grad_norm': 1.679587721824646, 'learning_rate': 1.619178082191781e-05, 'epoch': 7.31}
{'loss': 0.0564, 'grad_norm': 1.7623616456985474, 'learning_rate': 1.5917808219178083e-05, 'epoch': 7.69}
{'eval_loss': 0.27699142694473267, 'eval_cer_jiwer': 51.24444775162568, 'eval_cer_structured': 50.86465502029293, 'eval_runtime': 37.9166, 'eval_samples_per_second': 0.237, 'eval_steps_per_second': 0.132, 'epoch': 8.0}
{'loss': 0.0415, 'grad_norm': 0.915107786655426, 'learning_rate': 1.5643835616438358e-05, 'epoch': 8.08}
{'loss': 0.0395, 'grad_norm': 1.230492115020752, 'learning_rate': 1.5369863013698632e-05, 'epoch': 8.46}
{'loss': 0.058, 'grad_norm': 1.1083356142044067, 'learning_rate': 1.5095890410958905e-05, 'epoch': 8.85}
{'eval_loss': 0.2597963511943817, 'eval_cer_jiwer': 51.6958307482554, 'eval_cer_structured': 51.402858655373215, 'eval_runtime': 35.7633, 'eval_samples_per_second': 0.252, 'eval_steps_per_second': 0.14, 'epoch': 9.0}
{'loss': 0.0384, 'grad_norm': 2.087416410446167, 'learning_rate': 1.482191780821918e-05, 'epoch': 9.23}
{'loss': 0.0466, 'grad_norm': 2.3153367042541504, 'learning_rate': 1.4547945205479452e-05, 'epoch': 9.62}
{'loss': 0.0357, 'grad_norm': 0.8692349791526794, 'learning_rate': 1.4273972602739727e-05, 'epoch': 10.0}
{'eval_loss': 0.2728921175003052, 'eval_cer_jiwer': 53.21598745945709, 'eval_cer_structured': 53.079230633492145, 'eval_runtime': 41.2334, 'eval_samples_per_second': 0.218, 'eval_steps_per_second': 0.121, 'epoch': 10.0}
{'loss': 0.0248, 'grad_norm': 1.4855395555496216, 'learning_rate': 1.4e-05, 'epoch': 10.38}
{'loss': 0.0302, 'grad_norm': 1.8178648948669434, 'learning_rate': 1.3726027397260276e-05, 'epoch': 10.77}
{'eval_loss': 0.26507046818733215, 'eval_cer_jiwer': 54.046042207843925, 'eval_cer_structured': 54.226221986941944, 'eval_runtime': 40.5212, 'eval_samples_per_second': 0.222, 'eval_steps_per_second': 0.123, 'epoch': 11.0}
{'loss': 0.0371, 'grad_norm': 1.0819251537322998, 'learning_rate': 1.3452054794520549e-05, 'epoch': 11.15}
{'loss': 0.032, 'grad_norm': 1.086239218711853, 'learning_rate': 1.3178082191780823e-05, 'epoch': 11.54}
{'loss': 0.0224, 'grad_norm': 0.9559187889099121, 'learning_rate': 1.2904109589041096e-05, 'epoch': 11.92}
{'eval_loss': 0.26315951347351074, 'eval_cer_jiwer': 53.81048711797649, 'eval_cer_structured': 53.75860243515087, 'eval_runtime': 39.0436, 'eval_samples_per_second': 0.231, 'eval_steps_per_second': 0.128, 'epoch': 12.0}
{'loss': 0.0222, 'grad_norm': 0.941081702709198, 'learning_rate': 1.263013698630137e-05, 'epoch': 12.31}
{'loss': 0.0247, 'grad_norm': 0.6295067071914673, 'learning_rate': 1.2356164383561643e-05, 'epoch': 12.69}
{'eval_loss': 0.2819041609764099, 'eval_cer_jiwer': 51.89743406466489, 'eval_cer_structured': 51.88812422798659, 'eval_runtime': 36.8663, 'eval_samples_per_second': 0.244, 'eval_steps_per_second': 0.136, 'epoch': 13.0}
{'loss': 0.0174, 'grad_norm': 1.2246345281600952, 'learning_rate': 1.208219178082192e-05, 'epoch': 13.08}
{'loss': 0.0177, 'grad_norm': 1.025789737701416, 'learning_rate': 1.1808219178082192e-05, 'epoch': 13.46}
{'loss': 0.0211, 'grad_norm': 1.4161449670791626, 'learning_rate': 1.1534246575342467e-05, 'epoch': 13.85}
{'eval_loss': 0.27001953125, 'eval_cer_jiwer': 51.679044513421815, 'eval_cer_structured': 51.658725957296625, 'eval_runtime': 38.819, 'eval_samples_per_second': 0.232, 'eval_steps_per_second': 0.129, 'epoch': 14.0}
{'loss': 0.0185, 'grad_norm': 0.7739609479904175, 'learning_rate': 1.126027397260274e-05, 'epoch': 14.23}
{'loss': 0.0226, 'grad_norm': 0.837617814540863, 'learning_rate': 1.0986301369863014e-05, 'epoch': 14.62}
{'loss': 0.0136, 'grad_norm': 0.6343096494674683, 'learning_rate': 1.0712328767123287e-05, 'epoch': 15.0}
{'eval_loss': 0.28582319617271423, 'eval_cer_jiwer': 53.387443597571526, 'eval_cer_structured': 53.1233456855479, 'eval_runtime': 40.5748, 'eval_samples_per_second': 0.222, 'eval_steps_per_second': 0.123, 'epoch': 15.0}
{'loss': 0.0151, 'grad_norm': 0.7058893442153931, 'learning_rate': 1.0438356164383563e-05, 'epoch': 15.38}
{'loss': 0.0173, 'grad_norm': 0.9972409605979919, 'learning_rate': 1.0164383561643836e-05, 'epoch': 15.77}
{'eval_loss': 0.2755008041858673, 'eval_cer_jiwer': 51.07848965223069, 'eval_cer_structured': 51.01464619728251, 'eval_runtime': 39.9755, 'eval_samples_per_second': 0.225, 'eval_steps_per_second': 0.125, 'epoch': 16.0}
{'loss': 0.0147, 'grad_norm': 0.6072529554367065, 'learning_rate': 9.89041095890411e-06, 'epoch': 16.15}
{'loss': 0.0153, 'grad_norm': 0.6540610194206238, 'learning_rate': 9.616438356164385e-06, 'epoch': 16.54}
{'loss': 0.0155, 'grad_norm': 0.9431170225143433, 'learning_rate': 9.342465753424658e-06, 'epoch': 16.92}
{'eval_loss': 0.2771855294704437, 'eval_cer_jiwer': 52.43447576500701, 'eval_cer_structured': 52.35574377977766, 'eval_runtime': 39.6945, 'eval_samples_per_second': 0.227, 'eval_steps_per_second': 0.126, 'epoch': 17.0}
{'loss': 0.0117, 'grad_norm': 0.8573593497276306, 'learning_rate': 9.068493150684932e-06, 'epoch': 17.31}
{'loss': 0.0123, 'grad_norm': 0.5997500419616699, 'learning_rate': 8.794520547945207e-06, 'epoch': 17.69}
{'eval_loss': 0.28107747435569763, 'eval_cer_jiwer': 51.396525302765006, 'eval_cer_structured': 51.349920592906294, 'eval_runtime': 40.0188, 'eval_samples_per_second': 0.225, 'eval_steps_per_second': 0.125, 'epoch': 18.0}
{'loss': 0.0191, 'grad_norm': 0.4919116795063019, 'learning_rate': 8.520547945205481e-06, 'epoch': 18.08}
{'loss': 0.0151, 'grad_norm': 1.1403061151504517, 'learning_rate': 8.246575342465754e-06, 'epoch': 18.46}
{'loss': 0.0088, 'grad_norm': 0.6894064545631409, 'learning_rate': 7.972602739726027e-06, 'epoch': 18.85}
{'eval_loss': 0.2805601954460144, 'eval_cer_jiwer': 53.377970833196365, 'eval_cer_structured': 53.02629257102524, 'eval_runtime': 39.9514, 'eval_samples_per_second': 0.225, 'eval_steps_per_second': 0.125, 'epoch': 19.0}
{'loss': 0.0098, 'grad_norm': 0.40719568729400635, 'learning_rate': 7.698630136986302e-06, 'epoch': 19.23}
{'loss': 0.0118, 'grad_norm': 1.088532567024231, 'learning_rate': 7.424657534246575e-06, 'epoch': 19.62}
{'loss': 0.0093, 'grad_norm': 1.2396259307861328, 'learning_rate': 7.15068493150685e-06, 'epoch': 20.0}
{'eval_loss': 0.2843814492225647, 'eval_cer_jiwer': 53.72492079530902, 'eval_cer_structured': 53.75860243515087, 'eval_runtime': 41.4808, 'eval_samples_per_second': 0.217, 'eval_steps_per_second': 0.121, 'epoch': 20.0}
{'loss': 0.0101, 'grad_norm': 0.7086363434791565, 'learning_rate': 6.876712328767123e-06, 'epoch': 20.38}
{'loss': 0.0123, 'grad_norm': 0.566415548324585, 'learning_rate': 6.602739726027397e-06, 'epoch': 20.77}
{'eval_loss': 0.28413596749305725, 'eval_cer_jiwer': 54.12444235126739, 'eval_cer_structured': 54.03211575789659, 'eval_runtime': 38.5623, 'eval_samples_per_second': 0.233, 'eval_steps_per_second': 0.13, 'epoch': 21.0}
{'loss': 0.0102, 'grad_norm': 0.8450654149055481, 'learning_rate': 6.328767123287672e-06, 'epoch': 21.15}
{'loss': 0.0129, 'grad_norm': 1.9398640394210815, 'learning_rate': 6.054794520547945e-06, 'epoch': 21.54}
{'loss': 0.0095, 'grad_norm': 0.4028623402118683, 'learning_rate': 5.780821917808219e-06, 'epoch': 21.92}
{'eval_loss': 0.28083309531211853, 'eval_cer_jiwer': 53.839887080059235, 'eval_cer_structured': 53.626257278983594, 'eval_runtime': 43.7542, 'eval_samples_per_second': 0.206, 'eval_steps_per_second': 0.114, 'epoch': 22.0}
{'loss': 0.0074, 'grad_norm': 0.5982140302658081, 'learning_rate': 5.506849315068493e-06, 'epoch': 22.31}
{'loss': 0.0404, 'grad_norm': 0.26238706707954407, 'learning_rate': 5.232876712328767e-06, 'epoch': 22.69}
{'eval_loss': 0.28264063596725464, 'eval_cer_jiwer': 54.34355706733719, 'eval_cer_structured': 53.95270866419622, 'eval_runtime': 41.1299, 'eval_samples_per_second': 0.219, 'eval_steps_per_second': 0.122, 'epoch': 23.0}
{'loss': 0.008, 'grad_norm': 1.4263910055160522, 'learning_rate': 4.958904109589042e-06, 'epoch': 23.08}
{'loss': 0.0153, 'grad_norm': 0.6347179412841797, 'learning_rate': 4.684931506849315e-06, 'epoch': 23.46}
{'loss': 0.0066, 'grad_norm': 0.3134533166885376, 'learning_rate': 4.41095890410959e-06, 'epoch': 23.85}
{'eval_loss': 0.2888152003288269, 'eval_cer_jiwer': 54.20759904704179, 'eval_cer_structured': 53.899770601729315, 'eval_runtime': 41.1815, 'eval_samples_per_second': 0.219, 'eval_steps_per_second': 0.121, 'epoch': 24.0}
{'loss': 0.0128, 'grad_norm': 0.7555025815963745, 'learning_rate': 4.136986301369863e-06, 'epoch': 24.23}
{'loss': 0.0083, 'grad_norm': 0.7757041454315186, 'learning_rate': 3.863013698630138e-06, 'epoch': 24.62}
{'loss': 0.009, 'grad_norm': 0.5892801880836487, 'learning_rate': 3.5890410958904116e-06, 'epoch': 25.0}
{'eval_loss': 0.2880362868309021, 'eval_cer_jiwer': 58.42880365097906, 'eval_cer_structured': 57.967178401270516, 'eval_runtime': 40.5273, 'eval_samples_per_second': 0.222, 'eval_steps_per_second': 0.123, 'epoch': 25.0}
{'loss': 0.005, 'grad_norm': 0.537651538848877, 'learning_rate': 3.3150684931506857e-06, 'epoch': 25.38}
{'loss': 0.0066, 'grad_norm': 0.6340323090553284, 'learning_rate': 3.0410958904109593e-06, 'epoch': 25.77}
{'eval_loss': 0.28817567229270935, 'eval_cer_jiwer': 55.64280971915142, 'eval_cer_structured': 55.63790365272631, 'eval_runtime': 42.4203, 'eval_samples_per_second': 0.212, 'eval_steps_per_second': 0.118, 'epoch': 26.0}
{'train_runtime': 4279.1695, 'train_samples_per_second': 0.729, 'train_steps_per_second': 0.182, 'train_loss': 0.28190456781007306, 'epoch': 26.0}
Saving final model and processor...
Model and processor saved.
Generating predictions on test set...
Saving 9 predictions to /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_cord/donut_cord_20250807_150711/test_predictions.jsonl
Predictions saved successfully!
CER scores written to /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_cord/donut_cord_20250807_150711/final_CER_scores.txt

All outputs saved to: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_cord/donut_cord_20250807_150711

To view TensorBoard loss curves, run:
  tensorboard --logdir /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_cord/donut_cord_20250807_150711/tensorboard_logs
===================================
Training completed successfully!

Training Summary:
- Dataset: Staircase (26 train, 9 val, 9 test images)
- Augmentation: ENABLED (3x factor)
- Total training samples: 104
- Epochs completed: Check final_CER_scores.txt for details
- Model saved in: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_cord/donut_cord_20250807_150654/final_model/
Output directory: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_cord/donut_cord_20250807_150654
Log directory: /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/logs/DONUT/1162793

Key files generated:
- Model: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_cord/donut_cord_20250807_150654/final_model/
- CER scores: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_cord/donut_cord_20250807_150654/final_CER_scores.txt
- Training summary: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_cord/donut_cord_20250807_150654/training_summary.txt
- Predictions: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_cord/donut_cord_20250807_150654/*_predictions.jsonl
- TensorBoard logs: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_cord/donut_cord_20250807_150654/tensorboard_logs/

To view training curves:
tensorboard --logdir /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_cord/donut_cord_20250807_150654/tensorboard_logs/
Job completed at: Thu Aug  7 04:19:46 PM CEST 2025
=== JOB_STATISTICS ===
=== current date     : Thu Aug  7 04:19:46 PM CEST 2025
= Job-ID             : 1162793 on tinygpu
= Job-Name           : donut_cord_stair
= Job-Command        : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles/job_donut_staircase.sh
= Initial workdir    : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles
= Queue/Partition    : v100
= Slurm account      : iwi5 with QOS=normal
= Requested resources:  for 20:00:00
= Elapsed runtime    : 01:12:55
= Total RAM usage    : 8.7 GiB of requested  GiB (%)   
= Node list          : tg073
= Subm/Elig/Start/End: 2025-08-07T15:06:34 / 2025-08-07T15:06:34 / 2025-08-07T15:06:35 / 2025-08-07T16:19:30
======================
=== Quota infos ======
    Path                 Used     SoftQ    HardQ    Gracetime  Filec    FileQ    FiHaQ    FileGrace    
    /home/hpc              26.0G   104.9G   209.7G        N/A  31,940      500K   1,000K        N/A    
    /home/woody            71.2G  1000.0G  1500.0G        N/A     238K   5,000K   7,500K        N/A    
    /home/vault           424.3G  1048.6G  2097.2G        N/A   1,324      200K     400K        N/A    
======================
=== GPU utilization ==
gpu_name, gpu_bus_id, pid, gpu_utilization [%], mem_utilization [%], max_memory_usage [MiB], time [ms]
Tesla V100-PCIE-32GB, 00000000:86:00.0, 2351515, 36 %, 16 %, 32476 MiB, 4358478 ms
