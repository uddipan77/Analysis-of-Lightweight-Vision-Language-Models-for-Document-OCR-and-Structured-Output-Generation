### Starting TaskPrologue of job 1201368 on tg073 at Sun Sep  7 09:45:12 PM CEST 2025
Running on cores 0-1,8-9,16-17,24-25 with governor ondemand
Sun Sep  7 21:45:12 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.158.01             Driver Version: 570.158.01     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-PCIE-32GB           On  |   00000000:18:00.0 Off |                    0 |
| N/A   48C    P0             43W /  250W |       0MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
### Finished TaskPrologue

===================================
DONUT Fine-tuning Configuration:
===================================
Job ID: 1201368
Log Directory: /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/logs/DONUT/1201368
Data Directory: /home/woody/iwi5/iwi5298h/json_schmuck
Image Directory: /home/woody/iwi5/iwi5298h/schmuck_images
Model Cache Directory: /home/vault/iwi5/iwi5298h/models/donut_cord
Output Directory: /home/vault/iwi5/iwi5298h/models_image_text/donut/schmuck/schmuck_data_cord_20250907_214514
Num Epochs: 50
Batch Size: 2
Learning Rate: 1e-5
Max Length: 512
Prediction On: test
Prediction Batch Size: 2
Early Stopping Patience: 5
Early Stopping Threshold: 0.00
===================================
[2025-09-07 21:45:31,273] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-09-07 21:45:35,725] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
Using device: cuda
All output will be saved in: /home/vault/iwi5/iwi5298h/models_image_text/donut/schmuck/schmuck_cord_20250907_214537
Checking for model at: /home/vault/iwi5/iwi5298h/models/donut_cord
Model already exists at /home/vault/iwi5/iwi5298h/models/donut_cord, loading from local cache...
Loaded 413 samples from /home/woody/iwi5/iwi5298h/json_schmuck/train.jsonl
Loaded 88 samples from /home/woody/iwi5/iwi5298h/json_schmuck/val.jsonl
Loaded 89 samples from /home/woody/iwi5/iwi5298h/json_schmuck/test.jsonl
Starting training...
Model: donut-base-finetuned-cord-v2
Model selection based on: eval_cer_string (lower is better)
{'loss': 3.6825, 'grad_norm': 8.365903854370117, 'learning_rate': 4.9000000000000005e-06, 'epoch': 0.24}
{'loss': 0.6139, 'grad_norm': 4.558557510375977, 'learning_rate': 9.9e-06, 'epoch': 0.48}
{'loss': 0.2146, 'grad_norm': 1.938862681388855, 'learning_rate': 9.999436133854477e-06, 'epoch': 0.72}
{'loss': 0.132, 'grad_norm': 5.251358509063721, 'learning_rate': 9.997698404018374e-06, 'epoch': 0.97}
{'eval_loss': 0.08404925465583801, 'eval_cer_string': 8.148792831125293, 'eval_cer_structured': 8.148792831125293, 'eval_runtime': 121.0543, 'eval_samples_per_second': 0.727, 'eval_steps_per_second': 0.363, 'epoch': 1.0}
{'loss': 0.0808, 'grad_norm': 3.7553319931030273, 'learning_rate': 9.994786983740136e-06, 'epoch': 1.21}
{'loss': 0.0674, 'grad_norm': 2.8643977642059326, 'learning_rate': 9.990702556755738e-06, 'epoch': 1.45}
{'loss': 0.1009, 'grad_norm': 8.38720703125, 'learning_rate': 9.9854460822773e-06, 'epoch': 1.69}
{'loss': 0.0665, 'grad_norm': 2.1121296882629395, 'learning_rate': 9.979018794767841e-06, 'epoch': 1.93}
{'eval_loss': 0.05827457085251808, 'eval_cer_string': 6.8078522386616385, 'eval_cer_structured': 6.8078522386616385, 'eval_runtime': 124.748, 'eval_samples_per_second': 0.705, 'eval_steps_per_second': 0.353, 'epoch': 2.0}
{'loss': 0.0527, 'grad_norm': 1.7044743299484253, 'learning_rate': 9.971422203651365e-06, 'epoch': 2.17}
{'loss': 0.0326, 'grad_norm': 2.005389928817749, 'learning_rate': 9.96265809295837e-06, 'epoch': 2.42}
{'loss': 0.0425, 'grad_norm': 1.0852382183074951, 'learning_rate': 9.952728520906884e-06, 'epoch': 2.66}
{'loss': 0.0292, 'grad_norm': 0.2117866426706314, 'learning_rate': 9.941635819419098e-06, 'epoch': 2.9}
{'eval_loss': 0.0541968010365963, 'eval_cer_string': 7.017374206234084, 'eval_cer_structured': 7.017374206234084, 'eval_runtime': 121.8816, 'eval_samples_per_second': 0.722, 'eval_steps_per_second': 0.361, 'epoch': 3.0}
{'loss': 0.0439, 'grad_norm': 0.19598859548568726, 'learning_rate': 9.929382593573723e-06, 'epoch': 3.14}
{'loss': 0.0176, 'grad_norm': 0.12319862842559814, 'learning_rate': 9.915971720994196e-06, 'epoch': 3.38}
{'loss': 0.032, 'grad_norm': 0.546565055847168, 'learning_rate': 9.901406351172883e-06, 'epoch': 3.62}
{'loss': 0.0242, 'grad_norm': 0.34035804867744446, 'learning_rate': 9.88568990473143e-06, 'epoch': 3.86}
{'eval_loss': 0.05045945942401886, 'eval_cer_string': 8.003739161267447, 'eval_cer_structured': 8.003739161267447, 'eval_runtime': 118.7419, 'eval_samples_per_second': 0.741, 'eval_steps_per_second': 0.371, 'epoch': 4.0}
{'loss': 0.0262, 'grad_norm': 0.5371201038360596, 'learning_rate': 9.868826072617446e-06, 'epoch': 4.11}
{'loss': 0.0138, 'grad_norm': 0.6342655420303345, 'learning_rate': 9.850818815237695e-06, 'epoch': 4.35}
{'loss': 0.0249, 'grad_norm': 0.10333269834518433, 'learning_rate': 9.831672361528015e-06, 'epoch': 4.59}
{'loss': 0.0141, 'grad_norm': 0.44668614864349365, 'learning_rate': 9.81139120796016e-06, 'epoch': 4.83}
{'eval_loss': 0.052246201783418655, 'eval_cer_string': 7.085065918834413, 'eval_cer_structured': 7.085065918834413, 'eval_runtime': 121.9809, 'eval_samples_per_second': 0.721, 'eval_steps_per_second': 0.361, 'epoch': 5.0}
{'loss': 0.0109, 'grad_norm': 2.560432195663452, 'learning_rate': 9.78998011748583e-06, 'epoch': 5.07}
{'loss': 0.0107, 'grad_norm': 0.5564499497413635, 'learning_rate': 9.767444118418099e-06, 'epoch': 5.31}
{'loss': 0.0071, 'grad_norm': 0.05467095971107483, 'learning_rate': 9.743788503250548e-06, 'epoch': 5.56}
{'loss': 0.01, 'grad_norm': 0.06434748321771622, 'learning_rate': 9.719018827414335e-06, 'epoch': 5.8}
{'eval_loss': 0.051885269582271576, 'eval_cer_string': 7.25913032266383, 'eval_cer_structured': 7.25913032266383, 'eval_runtime': 127.5727, 'eval_samples_per_second': 0.69, 'eval_steps_per_second': 0.345, 'epoch': 6.0}
{'loss': 0.02, 'grad_norm': 0.0763821005821228, 'learning_rate': 9.69314090797352e-06, 'epoch': 6.04}
{'loss': 0.0086, 'grad_norm': 0.45659372210502625, 'learning_rate': 9.66616082225896e-06, 'epoch': 6.28}
{'loss': 0.0043, 'grad_norm': 4.2414045333862305, 'learning_rate': 9.638084906441058e-06, 'epoch': 6.52}
{'loss': 0.0172, 'grad_norm': 0.7078928351402283, 'learning_rate': 9.608919754041754e-06, 'epoch': 6.76}
{'eval_loss': 0.05769595131278038, 'eval_cer_string': 7.481545949779196, 'eval_cer_structured': 7.481545949779196, 'eval_runtime': 124.5653, 'eval_samples_per_second': 0.706, 'eval_steps_per_second': 0.353, 'epoch': 7.0}
{'train_runtime': 2699.2204, 'train_samples_per_second': 7.65, 'train_steps_per_second': 3.834, 'train_loss': 0.1865182234304703, 'epoch': 7.0}
Saving final model and processor...
Model and processor saved.
Generating predictions on test set...
Saving 89 predictions to /home/vault/iwi5/iwi5298h/models_image_text/donut/schmuck/schmuck_cord_20250907_214537/test_predictions.jsonl
Predictions saved successfully!
CER scores written to /home/vault/iwi5/iwi5298h/models_image_text/donut/schmuck/schmuck_cord_20250907_214537/final_CER_scores.txt

All outputs saved to: /home/vault/iwi5/iwi5298h/models_image_text/donut/schmuck/schmuck_cord_20250907_214537

To view TensorBoard loss curves, run:
  tensorboard --logdir /home/vault/iwi5/iwi5298h/models_image_text/donut/schmuck/schmuck_cord_20250907_214537/tensorboard_logs
===================================
Training completed successfully!
Output directory: /home/vault/iwi5/iwi5298h/models_image_text/donut/schmuck/schmuck_data_cord_20250907_214514
Log directory: /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/logs/DONUT/1201368
Job completed at: Sun Sep  7 10:32:57 PM CEST 2025
=== JOB_STATISTICS ===
=== current date     : Sun Sep  7 10:32:57 PM CEST 2025
= Job-ID             : 1201368 on tinygpu
= Job-Name           : donut_inventory
= Job-Command        : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles/job_donut3.sh
= Initial workdir    : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles
= Queue/Partition    : v100
= Slurm account      : iwi5 with QOS=normal
= Requested resources:  for 15:00:00
= Elapsed runtime    : 00:47:48
= Total RAM usage    : 7.6 GiB of requested  GiB (%)   
= Node list          : tg073
= Subm/Elig/Start/End: 2025-09-07T20:24:54 / 2025-09-07T20:24:54 / 2025-09-07T21:44:58 / 2025-09-07T22:32:46
======================
=== Quota infos ======
    Path                 Used     SoftQ    HardQ    Gracetime  Filec    FileQ    FiHaQ    FileGrace    
    /home/woody            46.8G  1000.0G  1500.0G        N/A     239K   5,000K   7,500K        N/A    
    /home/hpc              26.3G   104.9G   209.7G        N/A  32,426      500K   1,000K        N/A    
    /home/vault           935.5G  1048.6G  2097.2G        N/A   2,374      200K     400K        N/A    
======================
=== GPU utilization ==
gpu_name, gpu_bus_id, pid, gpu_utilization [%], mem_utilization [%], max_memory_usage [MiB], time [ms]
Tesla V100-PCIE-32GB, 00000000:18:00.0, 3318963, 51 %, 24 %, 12976 MiB, 2846570 ms
