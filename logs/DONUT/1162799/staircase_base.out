### Starting TaskPrologue of job 1162799 on tg073 at Thu Aug  7 03:14:02 PM CEST 2025
Running on cores 6-7,14-15,22-23,30-31 with governor ondemand
Thu Aug  7 15:14:02 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.158.01             Driver Version: 570.158.01     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-PCIE-32GB           On  |   00000000:AF:00.0 Off |                    0 |
| N/A   31C    P0             27W /  250W |       0MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
### Finished TaskPrologue

===================================
DONUT Staircase Dataset Fine-tuning Configuration:
===================================
Job ID: 1162799
Log Directory: /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/logs/DONUT/1162799
Data Directory: /home/woody/iwi5/iwi5298h/json_staircase
Image Directory: /home/woody/iwi5/iwi5298h/staircase_images
Model Cache Directory: /home/vault/iwi5/iwi5298h/models/donut_base
Output Directory: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_base/donut_base_20250807_151404
Num Epochs: 30
Batch Size: 2
Learning Rate: 2e-5
Max Length: 768
Prediction On: test
Prediction Batch Size: 1
Early Stopping Patience: 10
Early Stopping Threshold: 0.005
Augmentation Factor: 3
Disable Augmentation: false
===================================
Running command: python3 staircase_base.py     --data_dir "/home/woody/iwi5/iwi5298h/json_staircase"     --image_dir "/home/woody/iwi5/iwi5298h/staircase_images"     --epochs 30     --batch_size 2     --lr 2e-5     --max_length 768     --predict_on "test"     --prediction_batch_size 1     --early_stopping_patience 10     --early_stopping_threshold 0.005     --augmentation_factor 3
===================================
[2025-08-07 15:14:19,010] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-08-07 15:14:22,333] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
Using device: cuda
All output will be saved in: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_base/donut_base_20250807_151423
Checking for model at: /home/vault/iwi5/iwi5298h/models/donut_base
Model already exists at /home/vault/iwi5/iwi5298h/models/donut_base, loading from local cache...
=== MODEL STRUCTURE INSPECTION ===
Model config keys: ['return_dict', 'output_hidden_states', 'output_attentions', 'torchscript', 'torch_dtype', 'use_bfloat16', 'tf_legacy_loss', 'pruned_heads', 'tie_word_embeddings', 'chunk_size_feed_forward', 'is_encoder_decoder', 'is_decoder', 'cross_attention_hidden_size', 'add_cross_attention', 'tie_encoder_decoder', 'max_length', 'min_length', 'do_sample', 'early_stopping', 'num_beams', 'num_beam_groups', 'diversity_penalty', 'temperature', 'top_k', 'top_p', 'typical_p', 'repetition_penalty', 'length_penalty', 'no_repeat_ngram_size', 'encoder_no_repeat_ngram_size', 'bad_words_ids', 'num_return_sequences', 'output_scores', 'return_dict_in_generate', 'forced_bos_token_id', 'forced_eos_token_id', 'remove_invalid_values', 'exponential_decay_length_penalty', 'suppress_tokens', 'begin_suppress_tokens', 'architectures', 'finetuning_task', 'id2label', 'label2id', 'tokenizer_class', 'prefix', 'bos_token_id', 'pad_token_id', 'eos_token_id', 'sep_token_id', 'decoder_start_token_id', 'task_specific_params', 'problem_type', '_name_or_path', '_commit_hash', '_attn_implementation_internal', '_attn_implementation_autoset', 'transformers_version', 'decoder', 'encoder', 'model_type']
Decoder config keys: ['vocab_size', 'max_position_embeddings', 'd_model', 'encoder_ffn_dim', 'encoder_layers', 'encoder_attention_heads', 'decoder_ffn_dim', 'decoder_layers', 'decoder_attention_heads', 'dropout', 'attention_dropout', 'activation_dropout', 'activation_function', 'init_std', 'encoder_layerdrop', 'decoder_layerdrop', 'classifier_dropout', 'use_cache', 'num_hidden_layers', 'scale_embedding', 'return_dict', 'output_hidden_states', 'output_attentions', 'torchscript', 'torch_dtype', 'use_bfloat16', 'tf_legacy_loss', 'pruned_heads', 'tie_word_embeddings', 'chunk_size_feed_forward', 'is_encoder_decoder', 'is_decoder', 'cross_attention_hidden_size', 'add_cross_attention', 'tie_encoder_decoder', 'max_length', 'min_length', 'do_sample', 'early_stopping', 'num_beams', 'num_beam_groups', 'diversity_penalty', 'temperature', 'top_k', 'top_p', 'typical_p', 'repetition_penalty', 'length_penalty', 'no_repeat_ngram_size', 'encoder_no_repeat_ngram_size', 'bad_words_ids', 'num_return_sequences', 'output_scores', 'return_dict_in_generate', 'forced_bos_token_id', 'forced_eos_token_id', 'remove_invalid_values', 'exponential_decay_length_penalty', 'suppress_tokens', 'begin_suppress_tokens', 'architectures', 'finetuning_task', 'id2label', 'label2id', 'tokenizer_class', 'prefix', 'bos_token_id', 'pad_token_id', 'eos_token_id', 'sep_token_id', 'decoder_start_token_id', 'task_specific_params', 'problem_type', '_name_or_path', '_commit_hash', '_attn_implementation_internal', '_attn_implementation_autoset', 'transformers_version', 'add_final_layer_norm']
Found model.decoder.config.max_position_embeddings: 1536
Loaded 26 original samples from /home/woody/iwi5/iwi5298h/json_staircase/train.jsonl
Created 104 total samples with 3x augmentation
Loaded 9 original samples from /home/woody/iwi5/iwi5298h/json_staircase/val.jsonl
Using 9 samples without augmentation
Loaded 9 original samples from /home/woody/iwi5/iwi5298h/json_staircase/test.jsonl
Using 9 samples without augmentation
Starting training...
Model selection based on: eval_cer_jiwer (lower is better)
{'loss': 6.3478, 'grad_norm': 26.047534942626953, 'learning_rate': 3.6000000000000003e-06, 'epoch': 0.19}
{'loss': 4.9526, 'grad_norm': 17.452573776245117, 'learning_rate': 7.600000000000001e-06, 'epoch': 0.38}
{'loss': 3.507, 'grad_norm': 12.798606872558594, 'learning_rate': 1.16e-05, 'epoch': 0.58}
{'loss': 2.5172, 'grad_norm': 10.169156074523926, 'learning_rate': 1.5600000000000003e-05, 'epoch': 0.77}
{'loss': 2.0643, 'grad_norm': 6.7036871910095215, 'learning_rate': 1.9600000000000002e-05, 'epoch': 0.96}
{'eval_loss': 1.5938974618911743, 'eval_cer_jiwer': 78.08595061437184, 'eval_cer_structured': 78.53589196872778, 'eval_runtime': 78.8463, 'eval_samples_per_second': 0.114, 'eval_steps_per_second': 0.063, 'epoch': 1.0}
{'loss': 1.6938, 'grad_norm': 4.780704021453857, 'learning_rate': 1.9880794701986756e-05, 'epoch': 1.15}
{'loss': 1.1008, 'grad_norm': 3.303104877471924, 'learning_rate': 1.9748344370860927e-05, 'epoch': 1.35}
{'loss': 0.9669, 'grad_norm': 3.8585617542266846, 'learning_rate': 1.96158940397351e-05, 'epoch': 1.54}
{'loss': 0.7696, 'grad_norm': 4.0635247230529785, 'learning_rate': 1.9483443708609273e-05, 'epoch': 1.73}
{'loss': 0.6042, 'grad_norm': 3.9087491035461426, 'learning_rate': 1.9350993377483444e-05, 'epoch': 1.92}
{'eval_loss': 0.48976048827171326, 'eval_cer_jiwer': 58.20398100284151, 'eval_cer_structured': 58.53766879886283, 'eval_runtime': 62.0751, 'eval_samples_per_second': 0.145, 'eval_steps_per_second': 0.081, 'epoch': 2.0}
{'loss': 0.5184, 'grad_norm': 3.4885919094085693, 'learning_rate': 1.921854304635762e-05, 'epoch': 2.12}
{'loss': 0.4075, 'grad_norm': 3.1946868896484375, 'learning_rate': 1.908609271523179e-05, 'epoch': 2.31}
{'loss': 0.3066, 'grad_norm': 4.11906099319458, 'learning_rate': 1.895364238410596e-05, 'epoch': 2.5}
{'loss': 0.3274, 'grad_norm': 5.040305137634277, 'learning_rate': 1.8821192052980136e-05, 'epoch': 2.69}
{'loss': 0.2542, 'grad_norm': 2.4966671466827393, 'learning_rate': 1.8688741721854307e-05, 'epoch': 2.88}
{'eval_loss': 0.30244383215904236, 'eval_cer_jiwer': 68.88380116458195, 'eval_cer_structured': 68.727789623312, 'eval_runtime': 56.1187, 'eval_samples_per_second': 0.16, 'eval_steps_per_second': 0.089, 'epoch': 3.0}
{'loss': 0.203, 'grad_norm': 2.9278457164764404, 'learning_rate': 1.8556291390728478e-05, 'epoch': 3.08}
{'loss': 0.1745, 'grad_norm': 6.309939384460449, 'learning_rate': 1.842384105960265e-05, 'epoch': 3.27}
{'loss': 0.1696, 'grad_norm': 2.3463211059570312, 'learning_rate': 1.8291390728476824e-05, 'epoch': 3.46}
{'loss': 0.1544, 'grad_norm': 1.905131459236145, 'learning_rate': 1.8158940397350995e-05, 'epoch': 3.65}
{'loss': 0.1322, 'grad_norm': 2.796226978302002, 'learning_rate': 1.8026490066225166e-05, 'epoch': 3.85}
{'eval_loss': 0.22965388000011444, 'eval_cer_jiwer': 68.20991206943387, 'eval_cer_structured': 67.62615493958778, 'eval_runtime': 56.2668, 'eval_samples_per_second': 0.16, 'eval_steps_per_second': 0.089, 'epoch': 4.0}
{'loss': 0.153, 'grad_norm': 1.560805082321167, 'learning_rate': 1.789403973509934e-05, 'epoch': 4.04}
{'loss': 0.1055, 'grad_norm': 2.56601881980896, 'learning_rate': 1.7761589403973512e-05, 'epoch': 4.23}
{'loss': 0.1091, 'grad_norm': 3.3372068405151367, 'learning_rate': 1.7629139072847683e-05, 'epoch': 4.42}
{'loss': 0.0787, 'grad_norm': 2.3862533569335938, 'learning_rate': 1.7496688741721858e-05, 'epoch': 4.62}
{'loss': 0.0827, 'grad_norm': 2.0440187454223633, 'learning_rate': 1.736423841059603e-05, 'epoch': 4.81}
{'loss': 0.0857, 'grad_norm': 1.817592978477478, 'learning_rate': 1.72317880794702e-05, 'epoch': 5.0}
{'eval_loss': 0.22752046585083008, 'eval_cer_jiwer': 61.03206142599863, 'eval_cer_structured': 60.758706467661696, 'eval_runtime': 54.4573, 'eval_samples_per_second': 0.165, 'eval_steps_per_second': 0.092, 'epoch': 5.0}
{'loss': 0.0587, 'grad_norm': 2.0437653064727783, 'learning_rate': 1.709933774834437e-05, 'epoch': 5.19}
{'loss': 0.0635, 'grad_norm': 1.6275417804718018, 'learning_rate': 1.6966887417218546e-05, 'epoch': 5.38}
{'loss': 0.058, 'grad_norm': 1.9107906818389893, 'learning_rate': 1.6834437086092717e-05, 'epoch': 5.58}
{'loss': 0.0546, 'grad_norm': 1.3570293188095093, 'learning_rate': 1.670198675496689e-05, 'epoch': 5.77}
{'loss': 0.0522, 'grad_norm': 2.184406280517578, 'learning_rate': 1.6569536423841063e-05, 'epoch': 5.96}
{'eval_loss': 0.23558667302131653, 'eval_cer_jiwer': 69.47990160442156, 'eval_cer_structured': 69.53624733475479, 'eval_runtime': 49.5058, 'eval_samples_per_second': 0.182, 'eval_steps_per_second': 0.101, 'epoch': 6.0}
{'loss': 0.049, 'grad_norm': 1.3660764694213867, 'learning_rate': 1.6437086092715234e-05, 'epoch': 6.15}
{'loss': 0.0378, 'grad_norm': 0.9281206130981445, 'learning_rate': 1.6304635761589405e-05, 'epoch': 6.35}
{'loss': 0.0425, 'grad_norm': 2.0734405517578125, 'learning_rate': 1.6172185430463577e-05, 'epoch': 6.54}
{'loss': 0.0379, 'grad_norm': 2.821187973022461, 'learning_rate': 1.603973509933775e-05, 'epoch': 6.73}
{'loss': 0.0404, 'grad_norm': 1.6128827333450317, 'learning_rate': 1.5907284768211923e-05, 'epoch': 6.92}
{'eval_loss': 0.23185352981090546, 'eval_cer_jiwer': 55.2682943675896, 'eval_cer_structured': 55.38379530916845, 'eval_runtime': 57.8572, 'eval_samples_per_second': 0.156, 'eval_steps_per_second': 0.086, 'epoch': 7.0}
{'loss': 0.0337, 'grad_norm': 1.316535472869873, 'learning_rate': 1.5774834437086094e-05, 'epoch': 7.12}
{'loss': 0.0292, 'grad_norm': 1.6001880168914795, 'learning_rate': 1.5642384105960265e-05, 'epoch': 7.31}
{'loss': 0.0317, 'grad_norm': 3.090345621109009, 'learning_rate': 1.550993377483444e-05, 'epoch': 7.5}
{'loss': 0.0316, 'grad_norm': 1.3336433172225952, 'learning_rate': 1.537748344370861e-05, 'epoch': 7.69}
{'loss': 0.0204, 'grad_norm': 1.1106187105178833, 'learning_rate': 1.5245033112582784e-05, 'epoch': 7.88}
{'eval_loss': 0.22911283373832703, 'eval_cer_jiwer': 65.1468039525272, 'eval_cer_structured': 64.53447050461976, 'eval_runtime': 47.0469, 'eval_samples_per_second': 0.191, 'eval_steps_per_second': 0.106, 'epoch': 8.0}
{'loss': 0.0264, 'grad_norm': 0.7637777328491211, 'learning_rate': 1.5112582781456955e-05, 'epoch': 8.08}
{'loss': 0.0249, 'grad_norm': 3.451591968536377, 'learning_rate': 1.4980132450331126e-05, 'epoch': 8.27}
{'loss': 0.0198, 'grad_norm': 1.3105716705322266, 'learning_rate': 1.48476821192053e-05, 'epoch': 8.46}
{'loss': 0.0341, 'grad_norm': 0.7880222797393799, 'learning_rate': 1.4715231788079472e-05, 'epoch': 8.65}
{'loss': 0.0384, 'grad_norm': 2.7171356678009033, 'learning_rate': 1.4582781456953643e-05, 'epoch': 8.85}
{'eval_loss': 0.23790335655212402, 'eval_cer_jiwer': 71.58316551073645, 'eval_cer_structured': 71.25977256574272, 'eval_runtime': 54.3458, 'eval_samples_per_second': 0.166, 'eval_steps_per_second': 0.092, 'epoch': 9.0}
{'loss': 0.0214, 'grad_norm': 0.692003071308136, 'learning_rate': 1.4450331125827816e-05, 'epoch': 9.04}
{'loss': 0.0235, 'grad_norm': 1.8505327701568604, 'learning_rate': 1.4317880794701989e-05, 'epoch': 9.23}
{'loss': 0.0243, 'grad_norm': 1.073131799697876, 'learning_rate': 1.418543046357616e-05, 'epoch': 9.42}
{'loss': 0.0308, 'grad_norm': 1.5786917209625244, 'learning_rate': 1.4052980132450331e-05, 'epoch': 9.62}
{'loss': 0.022, 'grad_norm': 0.8767037391662598, 'learning_rate': 1.3920529801324504e-05, 'epoch': 9.81}
{'loss': 0.0206, 'grad_norm': 0.7312853932380676, 'learning_rate': 1.3788079470198677e-05, 'epoch': 10.0}
{'eval_loss': 0.2427264004945755, 'eval_cer_jiwer': 66.69927330053429, 'eval_cer_structured': 66.16027007818053, 'eval_runtime': 49.6702, 'eval_samples_per_second': 0.181, 'eval_steps_per_second': 0.101, 'epoch': 10.0}
{'loss': 0.0144, 'grad_norm': 1.3659629821777344, 'learning_rate': 1.3655629139072848e-05, 'epoch': 10.19}
{'loss': 0.0142, 'grad_norm': 0.8652653694152832, 'learning_rate': 1.3523178807947021e-05, 'epoch': 10.38}
{'loss': 0.0121, 'grad_norm': 0.4363435208797455, 'learning_rate': 1.3390728476821192e-05, 'epoch': 10.58}
{'loss': 0.0158, 'grad_norm': 1.4953941106796265, 'learning_rate': 1.3258278145695365e-05, 'epoch': 10.77}
{'loss': 0.0216, 'grad_norm': 1.0325651168823242, 'learning_rate': 1.3125827814569538e-05, 'epoch': 10.96}
{'eval_loss': 0.2436026632785797, 'eval_cer_jiwer': 67.06183459205047, 'eval_cer_structured': 67.1997157071784, 'eval_runtime': 53.6589, 'eval_samples_per_second': 0.168, 'eval_steps_per_second': 0.093, 'epoch': 11.0}
{'loss': 0.0119, 'grad_norm': 0.7599322199821472, 'learning_rate': 1.299337748344371e-05, 'epoch': 11.15}
{'loss': 0.0133, 'grad_norm': 0.8671898245811462, 'learning_rate': 1.286092715231788e-05, 'epoch': 11.35}
{'loss': 0.0197, 'grad_norm': 1.1765105724334717, 'learning_rate': 1.2728476821192055e-05, 'epoch': 11.54}
{'loss': 0.0157, 'grad_norm': 1.3666141033172607, 'learning_rate': 1.2596026490066226e-05, 'epoch': 11.73}
{'loss': 0.013, 'grad_norm': 2.262683153152466, 'learning_rate': 1.2463576158940398e-05, 'epoch': 11.92}
{'eval_loss': 0.2553479075431824, 'eval_cer_jiwer': 64.56116111891093, 'eval_cer_structured': 63.23738450604123, 'eval_runtime': 56.3159, 'eval_samples_per_second': 0.16, 'eval_steps_per_second': 0.089, 'epoch': 12.0}
{'loss': 0.0132, 'grad_norm': 1.072371244430542, 'learning_rate': 1.2331125827814569e-05, 'epoch': 12.12}
{'loss': 0.0104, 'grad_norm': 0.5638085603713989, 'learning_rate': 1.2198675496688743e-05, 'epoch': 12.31}
{'loss': 0.0126, 'grad_norm': 1.2191437482833862, 'learning_rate': 1.2066225165562915e-05, 'epoch': 12.5}
{'loss': 0.0105, 'grad_norm': 1.3213621377944946, 'learning_rate': 1.1933774834437086e-05, 'epoch': 12.69}
{'loss': 0.011, 'grad_norm': 0.2836258113384247, 'learning_rate': 1.180132450331126e-05, 'epoch': 12.88}
{'eval_loss': 0.25808000564575195, 'eval_cer_jiwer': 65.1616200728653, 'eval_cer_structured': 64.87206823027718, 'eval_runtime': 48.9918, 'eval_samples_per_second': 0.184, 'eval_steps_per_second': 0.102, 'epoch': 13.0}
{'loss': 0.0076, 'grad_norm': 0.44183239340782166, 'learning_rate': 1.1668874172185432e-05, 'epoch': 13.08}
{'loss': 0.0086, 'grad_norm': 0.4616273045539856, 'learning_rate': 1.1536423841059603e-05, 'epoch': 13.27}
{'loss': 0.0101, 'grad_norm': 0.5486607551574707, 'learning_rate': 1.1403973509933778e-05, 'epoch': 13.46}
{'loss': 0.0098, 'grad_norm': 0.5120437145233154, 'learning_rate': 1.1271523178807949e-05, 'epoch': 13.65}
{'loss': 0.0072, 'grad_norm': 1.4587262868881226, 'learning_rate': 1.113907284768212e-05, 'epoch': 13.85}
{'eval_loss': 0.2580721974372864, 'eval_cer_jiwer': 70.31829410757358, 'eval_cer_structured': 70.46019900497512, 'eval_runtime': 51.4662, 'eval_samples_per_second': 0.175, 'eval_steps_per_second': 0.097, 'epoch': 14.0}
{'loss': 0.0086, 'grad_norm': 0.3664725720882416, 'learning_rate': 1.1006622516556291e-05, 'epoch': 14.04}
{'loss': 0.0107, 'grad_norm': 0.9676210880279541, 'learning_rate': 1.0874172185430466e-05, 'epoch': 14.23}
{'loss': 0.0114, 'grad_norm': 1.2320650815963745, 'learning_rate': 1.0741721854304637e-05, 'epoch': 14.42}
{'loss': 0.0064, 'grad_norm': 0.9470117092132568, 'learning_rate': 1.0609271523178808e-05, 'epoch': 14.62}
{'loss': 0.0045, 'grad_norm': 0.535247802734375, 'learning_rate': 1.0476821192052981e-05, 'epoch': 14.81}
{'loss': 0.0071, 'grad_norm': 0.05741371214389801, 'learning_rate': 1.0344370860927154e-05, 'epoch': 15.0}
{'eval_loss': 0.25749844312667847, 'eval_cer_jiwer': 58.8953848914848, 'eval_cer_structured': 58.91968727789624, 'eval_runtime': 52.6749, 'eval_samples_per_second': 0.171, 'eval_steps_per_second': 0.095, 'epoch': 15.0}
{'loss': 0.0056, 'grad_norm': 1.0764051675796509, 'learning_rate': 1.0211920529801325e-05, 'epoch': 15.19}
{'loss': 0.0037, 'grad_norm': 0.14157938957214355, 'learning_rate': 1.0079470198675498e-05, 'epoch': 15.38}
{'loss': 0.0062, 'grad_norm': 1.0617231130599976, 'learning_rate': 9.94701986754967e-06, 'epoch': 15.58}
{'loss': 0.0061, 'grad_norm': 0.864378035068512, 'learning_rate': 9.814569536423842e-06, 'epoch': 15.77}
{'loss': 0.0072, 'grad_norm': 1.3443083763122559, 'learning_rate': 9.682119205298013e-06, 'epoch': 15.96}
{'eval_loss': 0.2500342130661011, 'eval_cer_jiwer': 68.16972877754036, 'eval_cer_structured': 67.45735607675905, 'eval_runtime': 50.9898, 'eval_samples_per_second': 0.177, 'eval_steps_per_second': 0.098, 'epoch': 16.0}
{'loss': 0.0069, 'grad_norm': 0.41621828079223633, 'learning_rate': 9.549668874172186e-06, 'epoch': 16.15}
{'loss': 0.0084, 'grad_norm': 1.2839878797531128, 'learning_rate': 9.417218543046358e-06, 'epoch': 16.35}
{'loss': 0.007, 'grad_norm': 0.8293699026107788, 'learning_rate': 9.28476821192053e-06, 'epoch': 16.54}
{'loss': 0.0079, 'grad_norm': 0.7718056440353394, 'learning_rate': 9.152317880794702e-06, 'epoch': 16.73}
{'loss': 0.0124, 'grad_norm': 1.354499101638794, 'learning_rate': 9.019867549668875e-06, 'epoch': 16.92}
{'eval_loss': 0.2538396716117859, 'eval_cer_jiwer': 64.46622491396676, 'eval_cer_structured': 64.31236673773986, 'eval_runtime': 52.521, 'eval_samples_per_second': 0.171, 'eval_steps_per_second': 0.095, 'epoch': 17.0}
{'train_runtime': 5679.0582, 'train_samples_per_second': 0.549, 'train_steps_per_second': 0.275, 'train_loss': 0.3290597553411288, 'epoch': 17.0}
Saving final model and processor...
Model and processor saved.
Generating predictions on test set...
Saving 9 predictions to /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_base/donut_base_20250807_151423/test_predictions.jsonl
Predictions saved successfully!
CER scores written to /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_base/donut_base_20250807_151423/final_CER_scores.txt

All outputs saved to: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_base/donut_base_20250807_151423

To view TensorBoard loss curves, run:
  tensorboard --logdir /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_base/donut_base_20250807_151423/tensorboard_logs
===================================
Training completed successfully!

Training Summary:
- Dataset: Staircase (26 train, 9 val, 9 test images)
- Augmentation: ENABLED (3x factor)
- Total training samples: 104
- Epochs completed: Check final_CER_scores.txt for details
- Model saved in: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_base/donut_base_20250807_151404/final_model/
Output directory: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_base/donut_base_20250807_151404
Log directory: /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/logs/DONUT/1162799

Key files generated:
- Model: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_base/donut_base_20250807_151404/final_model/
- CER scores: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_base/donut_base_20250807_151404/final_CER_scores.txt
- Training summary: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_base/donut_base_20250807_151404/training_summary.txt
- Predictions: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_base/donut_base_20250807_151404/*_predictions.jsonl
- TensorBoard logs: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_base/donut_base_20250807_151404/tensorboard_logs/

To view training curves:
tensorboard --logdir /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/donut_base/donut_base_20250807_151404/tensorboard_logs/
Job completed at: Thu Aug  7 04:50:35 PM CEST 2025
=== JOB_STATISTICS ===
=== current date     : Thu Aug  7 04:50:35 PM CEST 2025
= Job-ID             : 1162799 on tinygpu
= Job-Name           : donut_base_stair
= Job-Command        : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles/job_donut_staircase.sh
= Initial workdir    : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles
= Queue/Partition    : v100
= Slurm account      : iwi5 with QOS=normal
= Requested resources:  for 20:00:00
= Elapsed runtime    : 01:36:34
= Total RAM usage    : 10.4 GiB of requested  GiB (%)   
= Node list          : tg073
= Subm/Elig/Start/End: 2025-08-07T15:13:44 / 2025-08-07T15:13:44 / 2025-08-07T15:13:45 / 2025-08-07T16:50:19
======================
=== Quota infos ======
    Path                 Used     SoftQ    HardQ    Gracetime  Filec    FileQ    FiHaQ    FileGrace    
    /home/hpc              25.9G   104.9G   209.7G        N/A  31,953      500K   1,000K        N/A    
    /home/woody            71.2G  1000.0G  1500.0G        N/A     238K   5,000K   7,500K        N/A    
    /home/vault           421.1G  1048.6G  2097.2G        N/A   1,328      200K     400K        N/A    
======================
=== GPU utilization ==
gpu_name, gpu_bus_id, pid, gpu_utilization [%], mem_utilization [%], max_memory_usage [MiB], time [ms]
Tesla V100-PCIE-32GB, 00000000:AF:00.0, 2351833, 55 %, 25 %, 32490 MiB, 5776464 ms
