### Starting TaskPrologue of job 1526312 on tg073 at Sat Feb  7 09:01:45 PM CET 2026
Running on cores 0-1,8-9,16-17,24-25 with governor ondemand
Sat Feb  7 21:01:45 2026       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.211.01             Driver Version: 570.211.01     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-PCIE-32GB           On  |   00000000:18:00.0 Off |                    0 |
| N/A   33C    P0             27W /  250W |       0MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
### Finished TaskPrologue

Job started at: Sat Feb  7 09:01:47 PM CET 2026
Using device: cuda
Output dir: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/staircase_data_cord_20260207_210207
TensorBoard logs: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/staircase_data_cord_20260207_210207/tensorboard_logs
Loading model from local cache: /home/vault/iwi5/iwi5298h/models/donut_cord
Loaded 115 original samples from /home/woody/iwi5/iwi5298h/json_staircase/train.jsonl
No augmentation: total samples = 115
Loaded 25 original samples from /home/woody/iwi5/iwi5298h/json_staircase/val.jsonl
No augmentation: total samples = 25
Loaded 24 original samples from /home/woody/iwi5/iwi5298h/json_staircase/test.jsonl
No augmentation: total samples = 24

Starting training...
Best model selection based on: eval_gen_cer_string (AUTOREGRESSIVE, lower is better)

{'loss': 3.2632, 'grad_norm': 5.665596008300781, 'learning_rate': 1.8400000000000003e-05, 'epoch': 0.43}
{'loss': 0.7586, 'grad_norm': 4.295460224151611, 'learning_rate': 1.9962804844468452e-05, 'epoch': 0.87}
{'eval_loss': 0.3342858850955963, 'eval_runtime': 11.1048, 'eval_samples_per_second': 2.251, 'eval_steps_per_second': 2.251, 'epoch': 1.0}
{'eval_gen_cer_string': 65.40137073725685, 'eval_gen_cer_structured': 65.40137073725685, 'epoch': 1.0}

[Autoreg Val CER] cer_string=65.4014% | cer_structured=65.4014%

{'loss': 0.3278, 'grad_norm': 2.458866834640503, 'learning_rate': 1.983833762375688e-05, 'epoch': 1.3}
{'loss': 0.2479, 'grad_norm': 3.7078797817230225, 'learning_rate': 1.9627410738258455e-05, 'epoch': 1.74}
{'eval_loss': 0.16164018213748932, 'eval_runtime': 7.9468, 'eval_samples_per_second': 3.146, 'eval_steps_per_second': 3.146, 'epoch': 2.0}
{'eval_gen_cer_string': 66.9025222675435, 'eval_gen_cer_structured': 66.9025222675435, 'epoch': 2.0}

[Autoreg Val CER] cer_string=66.9025% | cer_structured=66.9025%

{'loss': 0.2114, 'grad_norm': 3.4714627265930176, 'learning_rate': 1.9331877821027075e-05, 'epoch': 2.17}
{'loss': 0.1357, 'grad_norm': 3.353440284729004, 'learning_rate': 1.895433602596561e-05, 'epoch': 2.61}
{'eval_loss': 0.14570555090904236, 'eval_runtime': 8.7273, 'eval_samples_per_second': 2.865, 'eval_steps_per_second': 2.865, 'epoch': 3.0}
{'eval_gen_cer_string': 73.26784871944282, 'eval_gen_cer_structured': 73.26784871944282, 'epoch': 3.0}

[Autoreg Val CER] cer_string=73.2678% | cer_structured=73.2678%

{'loss': 0.1448, 'grad_norm': 5.977202892303467, 'learning_rate': 1.8498103203944026e-05, 'epoch': 3.04}
{'loss': 0.0999, 'grad_norm': 3.146857976913452, 'learning_rate': 1.7967188745406653e-05, 'epoch': 3.48}
{'loss': 0.0976, 'grad_norm': 2.429905891418457, 'learning_rate': 1.736625834570478e-05, 'epoch': 3.91}
{'eval_loss': 0.11932327598333359, 'eval_runtime': 9.1158, 'eval_samples_per_second': 2.742, 'eval_steps_per_second': 2.742, 'epoch': 4.0}
{'eval_gen_cer_string': 67.71275562584978, 'eval_gen_cer_structured': 67.71275562584978, 'epoch': 4.0}

[Autoreg Val CER] cer_string=67.7128% | cer_structured=67.7128%

{'loss': 0.0845, 'grad_norm': 0.8851885795593262, 'learning_rate': 1.6700593002798168e-05, 'epoch': 4.35}
{'loss': 0.067, 'grad_norm': 2.598250389099121, 'learning_rate': 1.5976042607655083e-05, 'epoch': 4.78}
{'eval_loss': 0.1149665042757988, 'eval_runtime': 8.6235, 'eval_samples_per_second': 2.899, 'eval_steps_per_second': 2.899, 'epoch': 5.0}
{'eval_gen_cer_string': 68.32875495990454, 'eval_gen_cer_structured': 68.32875495990454, 'epoch': 5.0}

[Autoreg Val CER] cer_string=68.3288% | cer_structured=68.3288%

{'loss': 0.0584, 'grad_norm': 1.0155388116836548, 'learning_rate': 1.5198974535200114e-05, 'epoch': 5.22}
{'loss': 0.0552, 'grad_norm': 2.993992328643799, 'learning_rate': 1.437621768759442e-05, 'epoch': 5.65}
{'eval_loss': 0.1165766641497612, 'eval_runtime': 9.4802, 'eval_samples_per_second': 2.637, 'eval_steps_per_second': 2.637, 'epoch': 6.0}
{'eval_gen_cer_string': 67.84871944282582, 'eval_gen_cer_structured': 67.84871944282582, 'epoch': 6.0}

[Autoreg Val CER] cer_string=67.8487% | cer_structured=67.8487%

{'loss': 0.0519, 'grad_norm': 1.431767225265503, 'learning_rate': 1.3515002481597972e-05, 'epoch': 6.09}
{'loss': 0.0406, 'grad_norm': 1.5993657112121582, 'learning_rate': 1.2622897307407099e-05, 'epoch': 6.52}
{'loss': 0.0405, 'grad_norm': 0.5935797691345215, 'learning_rate': 1.1707742017369295e-05, 'epoch': 6.96}
{'eval_loss': 0.1235373243689537, 'eval_runtime': 8.6479, 'eval_samples_per_second': 2.891, 'eval_steps_per_second': 2.891, 'epoch': 7.0}
{'eval_gen_cer_string': 69.97141985071728, 'eval_gen_cer_structured': 69.97141985071728, 'epoch': 7.0}

[Autoreg Val CER] cer_string=69.9714% | cer_structured=69.9714%

{'loss': 0.0394, 'grad_norm': 0.45414870977401733, 'learning_rate': 1.0777579029078935e-05, 'epoch': 7.39}
{'loss': 0.0319, 'grad_norm': 2.688524007797241, 'learning_rate': 9.840582648322236e-06, 'epoch': 7.83}
{'eval_loss': 0.11907636374235153, 'eval_runtime': 8.6634, 'eval_samples_per_second': 2.886, 'eval_steps_per_second': 2.886, 'epoch': 8.0}
{'eval_gen_cer_string': 69.04742084963512, 'eval_gen_cer_structured': 69.04742084963512, 'epoch': 8.0}

[Autoreg Val CER] cer_string=69.0474% | cer_structured=69.0474%

{'loss': 0.0202, 'grad_norm': 0.6915345191955566, 'learning_rate': 8.904987232984127e-06, 'epoch': 8.26}
{'loss': 0.0331, 'grad_norm': 0.6615724563598633, 'learning_rate': 7.979014829215051e-06, 'epoch': 8.7}
{'eval_loss': 0.1264716237783432, 'eval_runtime': 8.8268, 'eval_samples_per_second': 2.832, 'eval_steps_per_second': 2.832, 'epoch': 9.0}
{'eval_gen_cer_string': 67.95693554205167, 'eval_gen_cer_structured': 67.95693554205167, 'epoch': 9.0}

[Autoreg Val CER] cer_string=67.9569% | cer_structured=67.9569%

{'loss': 0.0233, 'grad_norm': 0.48231691122055054, 'learning_rate': 7.070802915793791e-06, 'epoch': 9.13}
{'loss': 0.0225, 'grad_norm': 0.32918041944503784, 'learning_rate': 6.1883328916713444e-06, 'epoch': 9.57}
{'loss': 0.0236, 'grad_norm': 0.7147438526153564, 'learning_rate': 5.339359935149967e-06, 'epoch': 10.0}
{'eval_loss': 0.12301843613386154, 'eval_runtime': 8.5928, 'eval_samples_per_second': 2.909, 'eval_steps_per_second': 2.909, 'epoch': 10.0}
{'eval_gen_cer_string': 63.68378700851854, 'eval_gen_cer_structured': 63.68378700851854, 'epoch': 10.0}

[Autoreg Val CER] cer_string=63.6838% | cer_structured=63.6838%

{'loss': 0.0185, 'grad_norm': 1.2617723941802979, 'learning_rate': 4.531344851097413e-06, 'epoch': 10.43}
{'loss': 0.0186, 'grad_norm': 1.183566927909851, 'learning_rate': 3.7713885051254995e-06, 'epoch': 10.87}
{'eval_loss': 0.12655968964099884, 'eval_runtime': 8.6541, 'eval_samples_per_second': 2.889, 'eval_steps_per_second': 2.889, 'epoch': 11.0}
{'eval_gen_cer_string': 71.38932822775327, 'eval_gen_cer_structured': 71.38932822775327, 'epoch': 11.0}

[Autoreg Val CER] cer_string=71.3893% | cer_structured=71.3893%

{'loss': 0.0153, 'grad_norm': 1.1736950874328613, 'learning_rate': 3.0661694209277637e-06, 'epoch': 11.3}
{'loss': 0.0145, 'grad_norm': 1.3074012994766235, 'learning_rate': 2.4218850891731425e-06, 'epoch': 11.74}
{'eval_loss': 0.12675164639949799, 'eval_runtime': 8.9563, 'eval_samples_per_second': 2.791, 'eval_steps_per_second': 2.791, 'epoch': 12.0}
{'eval_gen_cer_string': 69.36374483198757, 'eval_gen_cer_structured': 69.36374483198757, 'epoch': 12.0}

[Autoreg Val CER] cer_string=69.3637% | cer_structured=69.3637%

{'loss': 0.0154, 'grad_norm': 0.9221453070640564, 'learning_rate': 1.8441975037351124e-06, 'epoch': 12.17}
{'loss': 0.0163, 'grad_norm': 1.3476636409759521, 'learning_rate': 1.338183403885952e-06, 'epoch': 12.61}
{'eval_loss': 0.12738603353500366, 'eval_runtime': 8.6792, 'eval_samples_per_second': 2.88, 'eval_steps_per_second': 2.88, 'epoch': 13.0}
{'eval_gen_cer_string': 73.29282166541802, 'eval_gen_cer_structured': 73.29282166541802, 'epoch': 13.0}

[Autoreg Val CER] cer_string=73.2928% | cer_structured=73.2928%

{'loss': 0.013, 'grad_norm': 0.34993839263916016, 'learning_rate': 9.082896597294866e-07, 'epoch': 13.04}
{'loss': 0.0153, 'grad_norm': 0.4912605285644531, 'learning_rate': 5.582941929467067e-07, 'epoch': 13.48}
{'loss': 0.0135, 'grad_norm': 1.011387825012207, 'learning_rate': 2.912727762842116e-07, 'epoch': 13.91}
{'eval_loss': 0.12729384005069733, 'eval_runtime': 8.9905, 'eval_samples_per_second': 2.781, 'eval_steps_per_second': 2.781, 'epoch': 14.0}
{'eval_gen_cer_string': 70.21282499514415, 'eval_gen_cer_structured': 70.21282499514415, 'epoch': 14.0}

[Autoreg Val CER] cer_string=70.2128% | cer_structured=70.2128%

{'loss': 0.0122, 'grad_norm': 0.653518557548523, 'learning_rate': 1.0957200355270481e-07, 'epoch': 14.35}
{'loss': 0.0107, 'grad_norm': 1.6410281658172607, 'learning_rate': 1.4788667676221002e-08, 'epoch': 14.78}
{'eval_loss': 0.1270696520805359, 'eval_runtime': 11.3101, 'eval_samples_per_second': 2.21, 'eval_steps_per_second': 2.21, 'epoch': 15.0}
{'eval_gen_cer_string': 71.14514831155138, 'eval_gen_cer_structured': 71.14514831155138, 'epoch': 15.0}

[Autoreg Val CER] cer_string=71.1451% | cer_structured=71.1451%

{'train_runtime': 3633.9636, 'train_samples_per_second': 0.475, 'train_steps_per_second': 0.475, 'train_loss': 0.17535231750944386, 'epoch': 15.0}

Saved final model to: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/staircase_data_cord_20260207_210207/final_model
âœ… Note: trainer.model is the BEST model (restored by load_best_model_at_end).

Generating predictions on test set using BEST model...

TEST CER (string): 66.3085%
TEST CER (structured): 66.3085%
Predictions saved: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/staircase_data_cord_20260207_210207/test_predictions.jsonl
Scores saved: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/staircase_data_cord_20260207_210207/final_CER_scores.txt

All outputs saved in: /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase/staircase_data_cord_20260207_210207
To view TensorBoard:
  tensorboard --logdir /home/vault/iwi5/iwi5298h/models_image_text/donut/staircase
Job completed at: Sat Feb  7 10:05:15 PM CET 2026
=== JOB_STATISTICS ===
=== current date     : Sat Feb  7 10:05:15 PM CET 2026
= Job-ID             : 1526312 on tinygpu
= Job-Name           : staircase_new_base
= Job-Command        : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles/job_donut3.sh
= Initial workdir    : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles
= Queue/Partition    : v100
= Slurm account      : iwi5 with QOS=normal
= Requested resources:  for 10:00:00
= Elapsed runtime    : 01:03:33
= Total RAM usage    : 9.1 GiB of requested  GiB (%)   
= Node list          : tg073
= Subm/Elig/Start/End: 2026-02-07T17:22:57 / 2026-02-07T17:22:57 / 2026-02-07T21:01:42 / 2026-02-07T22:05:15
======================
=== Quota infos ======
    Path                 Used     SoftQ    HardQ    Gracetime  Filec    FileQ    FiHaQ    FileGrace    
    /home/hpc              91.3G   104.9G   209.7G        N/A  30,029      500K   1,000K        N/A    
    /home/woody           408.1G  1000.0G  1500.0G        N/A   1,018K   5,000K   7,500K        N/A    
    /home/vault           965.9G  1048.6G  2097.2G        N/A   9,561      200K     400K        N/A    
======================
=== GPU utilization ==
gpu_name, gpu_bus_id, pid, gpu_utilization [%], mem_utilization [%], max_memory_usage [MiB], time [ms]
Tesla V100-PCIE-32GB, 00000000:18:00.0, 362238, 29 %, 17 %, 5778 MiB, 3791934 ms
