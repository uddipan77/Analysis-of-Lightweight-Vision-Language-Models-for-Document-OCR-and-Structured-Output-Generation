/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/transformers/models/auto/image_processing_auto.py:520: FutureWarning: The image_processor_class argument is deprecated and will be removed in v4.42. Please use `slow_image_processor_class`, or `fast_image_processor_class` instead
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:48<00:48, 48.31s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:18<00:00, 37.87s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:18<00:00, 39.44s/it]
  0%|          | 0/75 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
You are not running the flash-attention implementation, expect numerical differences.
  1%|▏         | 1/75 [02:37<3:14:36, 157.79s/it]  3%|▎         | 2/75 [05:15<3:12:08, 157.93s/it]  4%|▍         | 3/75 [07:51<3:08:30, 157.10s/it]  5%|▌         | 4/75 [10:28<3:05:46, 156.99s/it]  7%|▋         | 5/75 [13:05<3:03:05, 156.94s/it]  8%|▊         | 6/75 [15:43<3:00:42, 157.14s/it]  9%|▉         | 7/75 [18:20<2:58:00, 157.06s/it] 11%|█         | 8/75 [20:57<2:55:36, 157.26s/it] 12%|█▏        | 9/75 [23:34<2:52:54, 157.19s/it] 13%|█▎        | 10/75 [26:14<2:51:11, 158.02s/it]                                                   13%|█▎        | 10/75 [26:14<2:51:11, 158.02s/it] 15%|█▍        | 11/75 [28:51<2:48:01, 157.52s/it] 16%|█▌        | 12/75 [31:28<2:45:20, 157.46s/it] 17%|█▋        | 13/75 [34:06<2:42:47, 157.55s/it] 19%|█▊        | 14/75 [36:43<2:40:08, 157.51s/it] 20%|██        | 15/75 [39:19<2:37:05, 157.09s/it] 21%|██▏       | 16/75 [41:56<2:34:19, 156.95s/it] 23%|██▎       | 17/75 [44:32<2:31:36, 156.83s/it] 24%|██▍       | 18/75 [47:09<2:29:02, 156.89s/it] 25%|██▌       | 19/75 [49:46<2:26:15, 156.70s/it] 27%|██▋       | 20/75 [52:21<2:23:20, 156.38s/it]                                                   27%|██▋       | 20/75 [52:21<2:23:20, 156.38s/it] 28%|██▊       | 21/75 [54:58<2:20:50, 156.49s/it] 29%|██▉       | 22/75 [57:34<2:18:09, 156.40s/it] 31%|███       | 23/75 [1:00:14<2:16:26, 157.44s/it] 32%|███▏      | 24/75 [1:02:51<2:13:36, 157.18s/it] 33%|███▎      | 25/75 [1:05:27<2:10:45, 156.91s/it] 35%|███▍      | 26/75 [1:08:05<2:08:33, 157.42s/it] 36%|███▌      | 27/75 [1:10:41<2:05:34, 156.97s/it] 37%|███▋      | 28/75 [1:13:17<2:02:33, 156.46s/it] 39%|███▊      | 29/75 [1:15:53<1:59:52, 156.35s/it] 40%|████      | 30/75 [1:18:30<1:57:24, 156.53s/it]                                                     40%|████      | 30/75 [1:18:30<1:57:24, 156.53s/it] 41%|████▏     | 31/75 [1:21:07<1:54:51, 156.63s/it] 43%|████▎     | 32/75 [1:23:44<1:52:26, 156.90s/it] 44%|████▍     | 33/75 [1:26:20<1:49:41, 156.71s/it] 45%|████▌     | 34/75 [1:28:57<1:47:00, 156.59s/it] 47%|████▋     | 35/75 [1:31:33<1:44:18, 156.47s/it] 48%|████▊     | 36/75 [1:34:09<1:41:42, 156.49s/it] 49%|████▉     | 37/75 [1:36:46<1:39:09, 156.56s/it] 51%|█████     | 38/75 [1:39:23<1:36:38, 156.71s/it] 52%|█████▏    | 39/75 [1:41:59<1:33:54, 156.52s/it] 53%|█████▎    | 40/75 [1:44:37<1:31:33, 156.96s/it]                                                     53%|█████▎    | 40/75 [1:44:37<1:31:33, 156.96s/it] 55%|█████▍    | 41/75 [1:47:14<1:28:58, 157.02s/it] 56%|█████▌    | 42/75 [1:49:54<1:26:46, 157.76s/it] 57%|█████▋    | 43/75 [1:52:31<1:24:03, 157.62s/it] 59%|█████▊    | 44/75 [1:55:08<1:21:16, 157.30s/it] 60%|██████    | 45/75 [1:57:46<1:18:48, 157.63s/it] 61%|██████▏   | 46/75 [2:00:24<1:16:09, 157.55s/it] 63%|██████▎   | 47/75 [2:03:03<1:13:50, 158.22s/it] 64%|██████▍   | 48/75 [2:05:40<1:10:56, 157.66s/it] 65%|██████▌   | 49/75 [2:08:17<1:08:14, 157.49s/it] 67%|██████▋   | 50/75 [2:10:54<1:05:32, 157.29s/it]                                                     67%|██████▋   | 50/75 [2:10:54<1:05:32, 157.29s/it] 68%|██████▊   | 51/75 [2:13:30<1:02:49, 157.05s/it] 69%|██████▉   | 52/75 [2:16:08<1:00:19, 157.36s/it] 71%|███████   | 53/75 [2:18:45<57:38, 157.22s/it]   72%|███████▏  | 54/75 [2:21:22<54:58, 157.08s/it] 73%|███████▎  | 55/75 [2:23:59<52:20, 157.00s/it] 75%|███████▍  | 56/75 [2:26:36<49:47, 157.24s/it] 76%|███████▌  | 57/75 [2:29:13<47:06, 157.04s/it] 77%|███████▋  | 58/75 [2:31:50<44:29, 157.01s/it] 79%|███████▊  | 59/75 [2:34:26<41:46, 156.66s/it] 80%|████████  | 60/75 [2:37:02<39:10, 156.68s/it]                                                   80%|████████  | 60/75 [2:37:03<39:10, 156.68s/it] 81%|████████▏ | 61/75 [2:39:40<36:35, 156.81s/it] 83%|████████▎ | 62/75 [2:42:16<33:56, 156.66s/it] 84%|████████▍ | 63/75 [2:44:52<31:17, 156.49s/it] 85%|████████▌ | 64/75 [2:47:29<28:41, 156.54s/it] 87%|████████▋ | 65/75 [2:50:07<26:09, 156.97s/it] 88%|████████▊ | 66/75 [2:52:45<23:37, 157.46s/it] 89%|████████▉ | 67/75 [2:55:23<20:59, 157.42s/it] 91%|█████████ | 68/75 [2:57:59<18:20, 157.23s/it] 92%|█████████▏| 69/75 [3:00:37<15:44, 157.40s/it] 93%|█████████▎| 70/75 [3:03:14<13:06, 157.21s/it]                                                   93%|█████████▎| 70/75 [3:03:14<13:06, 157.21s/it] 95%|█████████▍| 71/75 [3:05:51<10:28, 157.15s/it] 96%|█████████▌| 72/75 [3:08:27<07:50, 156.81s/it] 97%|█████████▋| 73/75 [3:11:03<05:13, 156.55s/it] 99%|█████████▊| 74/75 [3:13:39<02:36, 156.49s/it]100%|██████████| 75/75 [3:16:16<00:00, 156.60s/it]                                                  100%|██████████| 75/75 [3:16:16<00:00, 156.60s/it]100%|██████████| 75/75 [3:16:16<00:00, 157.02s/it]
Traceback (most recent call last):
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/phivision/multistage/schmuck_ms.py", line 863, in <module>
    main()
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/phivision/multistage/schmuck_ms.py", line 690, in main
    trainer_stage2.train()
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/transformers/trainer.py", line 2122, in train
    return inner_training_loop(
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/transformers/trainer.py", line 2381, in _inner_training_loop
    self.control = self.callback_handler.on_train_begin(args, self.state, self.control)
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/transformers/trainer_callback.py", line 468, in on_train_begin
    return self.call_event("on_train_begin", args, state, control)
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/transformers/trainer_callback.py", line 518, in call_event
    result = getattr(callback, event)(
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/transformers/trainer_callback.py", line 693, in on_train_begin
    assert args.load_best_model_at_end, "EarlyStoppingCallback requires load_best_model_at_end = True"
AssertionError: EarlyStoppingCallback requires load_best_model_at_end = True
