### Starting TaskPrologue of job 1457152 on tg074 at Fri Dec  5 05:36:22 PM CET 2025
Running on cores 4-5,12-13,20-21,28-29 with governor ondemand
Fri Dec  5 17:36:22 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.195.03             Driver Version: 570.195.03     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-PCIE-32GB           On  |   00000000:86:00.0 Off |                    0 |
| N/A   32C    P0             26W /  250W |       0MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
### Finished TaskPrologue

Starting training at: Fri Dec  5 05:36:24 PM CET 2025
   âœ… Processor loaded

ğŸ“Š Loading STAIRCASE datasets...
   ğŸ“ Training dataset:
   ğŸ“Š Loaded 115 valid samples (out of 115 total)
   ğŸ”„ Data augmentation ENABLED
   ğŸ“ Validation dataset:
   ğŸ“Š Loaded 25 valid samples (out of 25 total)
   ğŸ“Š Validation samples for CER computation: 25

================================================================================
ğŸ” Starting / Resuming Optuna HPO (hyperparameters only)
================================================================================
   â€¢ Storage: sqlite:////home/hpc/iwi5/iwi5298h/Uddipan-Thesis/vlmmodels.db
   â€¢ Study name: phi vision
   â€¢ Target total trials: 25
   â€¢ Completed trials so far: 0
   â€¢ Remaining trials to run: 25

================================================================================
PHI-3.5-VISION FINE-TUNING (HPO TRIAL) - STAIRCASE DATASET
BitsAndBytes QLoRA 4-bit (Memory-Optimized)
================================================================================

ğŸ“‚ Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/phi/hpo_stair/trials/trial_0
   â€¢ Training epochs: 8
   â€¢ Batch size: 1
   â€¢ Gradient accumulation: 8
   â€¢ Learning rate: 0.0001680720977739039
   â€¢ Weight decay: 0.08927180304353628
   â€¢ LoRA r=8, alpha=32, dropout=0.052058449429580246

ğŸ›¡ï¸  Memory Optimization:
   â€¢ 4-bit NF4 Quantization: True
   â€¢ Nested Quantization: True

ğŸ”§ Anti-Repetition:
   â€¢ First-JSON extraction: enabled
   â€¢ Using temperature=0.0 for deterministic generation

â³ Loading Phi-3.5-Vision with 4-bit quantization...
   âœ… Model loaded with 4-bit quantization
   ğŸ“Š GPU Memory - Allocated: 2.27 GB, Reserved: 2.37 GB

ğŸ“ Preparing model for LoRA training...
   âœ… LoRA applied successfully
   ğŸ“Š Trainable params: 12,582,912 / 4,159,204,352 (0.30%)
ğŸš€ Starting QLoRA training on STAIRCASE dataset (HPO trial)...

================================================================================
{'loss': 5.6318, 'grad_norm': 3.4297289848327637, 'learning_rate': 0.00014006008147825325, 'epoch': 0.7}
{'eval_loss': 0.3994884490966797, 'eval_runtime': 110.1938, 'eval_samples_per_second': 0.227, 'eval_steps_per_second': 0.227, 'epoch': 0.97}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 0)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 0): 0.8370 (83.70%)
   ğŸ¯ NEW BEST CER: 0.8370 (improved by inf)
================================================================================

{'loss': 3.1774, 'grad_norm': 2.630329132080078, 'learning_rate': 0.00016543195076663606, 'epoch': 1.39}
{'eval_loss': 0.16564340889453888, 'eval_runtime': 110.1377, 'eval_samples_per_second': 0.227, 'eval_steps_per_second': 0.227, 'epoch': 1.95}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 1)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 1): 0.2722 (27.22%)
   ğŸ¯ NEW BEST CER: 0.2722 (improved by 0.5648)
================================================================================

{'loss': 1.5304, 'grad_norm': 1.76460599899292, 'learning_rate': 0.00015499003171105802, 'epoch': 2.09}
{'loss': 0.9477, 'grad_norm': 2.1737208366394043, 'learning_rate': 0.0001376026424511888, 'epoch': 2.78}
{'eval_loss': 0.11784345656633377, 'eval_runtime': 109.7829, 'eval_samples_per_second': 0.228, 'eval_steps_per_second': 0.228, 'epoch': 2.99}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 2)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 2): 0.0874 (8.74%)
   ğŸ¯ NEW BEST CER: 0.0874 (improved by 0.1847)
================================================================================

{'loss': 0.7895, 'grad_norm': 1.3011070489883423, 'learning_rate': 0.00011497178179284888, 'epoch': 3.48}
{'eval_loss': 0.11353611946105957, 'eval_runtime': 110.2319, 'eval_samples_per_second': 0.227, 'eval_steps_per_second': 0.227, 'epoch': 3.97}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 3)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 3): 0.0768 (7.68%)
   ğŸ¯ NEW BEST CER: 0.0768 (improved by 0.0106)
================================================================================

{'loss': 0.5649, 'grad_norm': 1.2256649732589722, 'learning_rate': 8.931271605575445e-05, 'epoch': 4.17}
{'loss': 0.508, 'grad_norm': 1.7028770446777344, 'learning_rate': 6.313713337147566e-05, 'epoch': 4.87}
{'eval_loss': 0.11063997447490692, 'eval_runtime': 110.26, 'eval_samples_per_second': 0.227, 'eval_steps_per_second': 0.227, 'epoch': 4.94}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 4)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 4): 0.0613 (6.13%)
   ğŸ¯ NEW BEST CER: 0.0613 (improved by 0.0155)
================================================================================

{'loss': 0.3966, 'grad_norm': 1.318640112876892, 'learning_rate': 3.9007282149158185e-05, 'epoch': 5.57}
{'eval_loss': 0.11421194672584534, 'eval_runtime': 109.8177, 'eval_samples_per_second': 0.228, 'eval_steps_per_second': 0.228, 'epoch': 5.98}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 5)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 5): 0.1055 (10.55%)
   ğŸ“Š No improvement. Best CER remains: 0.0613
================================================================================

{'loss': 0.3429, 'grad_norm': 1.8062936067581177, 'learning_rate': 1.9285160349001857e-05, 'epoch': 6.26}
{'loss': 0.2764, 'grad_norm': 1.2553602457046509, 'learning_rate': 5.90130666490847e-06, 'epoch': 6.96}
{'eval_loss': 0.11602701246738434, 'eval_runtime': 109.3548, 'eval_samples_per_second': 0.229, 'eval_steps_per_second': 0.229, 'epoch': 6.96}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 6)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 6): 0.0878 (8.78%)
   ğŸ“Š No improvement. Best CER remains: 0.0613
================================================================================

{'loss': 0.2755, 'grad_norm': 1.3830187320709229, 'learning_rate': 1.6582594626900378e-07, 'epoch': 7.65}
{'eval_loss': 0.11652407795190811, 'eval_runtime': 109.7639, 'eval_samples_per_second': 0.228, 'eval_steps_per_second': 0.228, 'epoch': 7.79}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 7)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 7): 0.0807 (8.07%)
   ğŸ“Š No improvement. Best CER remains: 0.0613
================================================================================

{'train_runtime': 28990.5651, 'train_samples_per_second': 0.032, 'train_steps_per_second': 0.004, 'train_loss': 1.294709177421672, 'epoch': 7.79}

================================================================================
âœ… TRIAL TRAINING COMPLETED!
================================================================================
   ğŸ¯ Best Validation CER in this trial: 0.0613 (6.13%)
================================================================================

================================================================================
PHI-3.5-VISION FINE-TUNING (HPO TRIAL) - STAIRCASE DATASET
BitsAndBytes QLoRA 4-bit (Memory-Optimized)
================================================================================

ğŸ“‚ Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/phi/hpo_stair/trials/trial_1
   â€¢ Training epochs: 8
   â€¢ Batch size: 1
   â€¢ Gradient accumulation: 24
   â€¢ Learning rate: 0.00012894975389587306
   â€¢ Weight decay: 0.02014847788415866
   â€¢ LoRA r=32, alpha=64, dropout=0.12851759613930136

ğŸ›¡ï¸  Memory Optimization:
   â€¢ 4-bit NF4 Quantization: True
   â€¢ Nested Quantization: True

ğŸ”§ Anti-Repetition:
   â€¢ First-JSON extraction: enabled
   â€¢ Using temperature=0.0 for deterministic generation

â³ Loading Phi-3.5-Vision with 4-bit quantization...
   âœ… Model loaded with 4-bit quantization
   ğŸ“Š GPU Memory - Allocated: 2.28 GB, Reserved: 2.39 GB

ğŸ“ Preparing model for LoRA training...
   âœ… LoRA applied successfully
   ğŸ“Š Trainable params: 50,331,648 / 4,196,953,088 (1.20%)
ğŸš€ Starting QLoRA training on STAIRCASE dataset (HPO trial)...

================================================================================
{'eval_loss': 0.6279032230377197, 'eval_runtime': 110.1203, 'eval_samples_per_second': 0.227, 'eval_steps_per_second': 0.227, 'epoch': 0.83}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 0)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 0): 0.7952 (79.52%)
   ğŸ¯ NEW BEST CER: 0.7952 (improved by inf)
================================================================================

{'eval_loss': 0.3828650712966919, 'eval_runtime': 109.8153, 'eval_samples_per_second': 0.228, 'eval_steps_per_second': 0.228, 'epoch': 1.88}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 1)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 1): 0.7368 (73.68%)
   ğŸ¯ NEW BEST CER: 0.7368 (improved by 0.0584)
================================================================================

{'loss': 14.2898, 'grad_norm': 4.472492694854736, 'learning_rate': 0.00011488336557408555, 'epoch': 2.09}
{'eval_loss': 0.2456500232219696, 'eval_runtime': 109.9725, 'eval_samples_per_second': 0.227, 'eval_steps_per_second': 0.227, 'epoch': 2.92}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 2)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 2): 0.7300 (73.00%)
   ğŸ¯ NEW BEST CER: 0.7300 (improved by 0.0068)
================================================================================

{'eval_loss': 0.18855734169483185, 'eval_runtime': 109.9147, 'eval_samples_per_second': 0.227, 'eval_steps_per_second': 0.227, 'epoch': 3.97}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 3)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 3): 0.6001 (60.01%)
   ğŸ¯ NEW BEST CER: 0.6001 (improved by 0.1299)
================================================================================

{'loss': 5.8874, 'grad_norm': 3.1485610008239746, 'learning_rate': 5.012786711276325e-05, 'epoch': 4.17}
{'eval_loss': 0.16569370031356812, 'eval_runtime': 110.1188, 'eval_samples_per_second': 0.227, 'eval_steps_per_second': 0.227, 'epoch': 4.8}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 4)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 4): 0.2154 (21.54%)
   ğŸ¯ NEW BEST CER: 0.2154 (improved by 0.3847)
================================================================================

{'eval_loss': 0.1553560495376587, 'eval_runtime': 110.1695, 'eval_samples_per_second': 0.227, 'eval_steps_per_second': 0.227, 'epoch': 5.84}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 5)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 5): 0.2441 (24.41%)
   ğŸ“Š No improvement. Best CER remains: 0.2154
================================================================================

{'loss': 3.6256, 'grad_norm': 2.3198814392089844, 'learning_rate': 1.6165197769047805e-06, 'epoch': 6.26}
{'eval_loss': 0.15407529473304749, 'eval_runtime': 110.3691, 'eval_samples_per_second': 0.227, 'eval_steps_per_second': 0.227, 'epoch': 6.68}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 6)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 6): 0.2425 (24.25%)
   ğŸ“Š No improvement. Best CER remains: 0.2154
================================================================================

{'train_runtime': 24269.6745, 'train_samples_per_second': 0.038, 'train_steps_per_second': 0.001, 'train_loss': 7.651368096470833, 'epoch': 6.68}

================================================================================
âœ… TRIAL TRAINING COMPLETED!
================================================================================
   ğŸ¯ Best Validation CER in this trial: 0.2154 (21.54%)
================================================================================

================================================================================
PHI-3.5-VISION FINE-TUNING (HPO TRIAL) - STAIRCASE DATASET
BitsAndBytes QLoRA 4-bit (Memory-Optimized)
================================================================================

ğŸ“‚ Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/phi/hpo_stair/trials/trial_2
   â€¢ Training epochs: 9
   â€¢ Batch size: 1
   â€¢ Gradient accumulation: 24
   â€¢ Learning rate: 0.00023215521736070897
   â€¢ Weight decay: 0.014808945119975192
   â€¢ LoRA r=24, alpha=48, dropout=0.06220382348447789

ğŸ›¡ï¸  Memory Optimization:
   â€¢ 4-bit NF4 Quantization: True
   â€¢ Nested Quantization: True

ğŸ”§ Anti-Repetition:
   â€¢ First-JSON extraction: enabled
   â€¢ Using temperature=0.0 for deterministic generation

â³ Loading Phi-3.5-Vision with 4-bit quantization...
   âœ… Model loaded with 4-bit quantization
   ğŸ“Š GPU Memory - Allocated: 2.28 GB, Reserved: 2.39 GB

ğŸ“ Preparing model for LoRA training...
   âœ… LoRA applied successfully
   ğŸ“Š Trainable params: 37,748,736 / 4,184,370,176 (0.90%)
ğŸš€ Starting QLoRA training on STAIRCASE dataset (HPO trial)...

================================================================================
{'eval_loss': 0.5925864577293396, 'eval_runtime': 110.0282, 'eval_samples_per_second': 0.227, 'eval_steps_per_second': 0.227, 'epoch': 0.83}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 0)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 0): 0.8098 (80.98%)
   ğŸ¯ NEW BEST CER: 0.8098 (improved by inf)
================================================================================

{'eval_loss': 0.3088383376598358, 'eval_runtime': 109.8405, 'eval_samples_per_second': 0.228, 'eval_steps_per_second': 0.228, 'epoch': 1.88}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 1)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 1): 0.8044 (80.44%)
   ğŸ¯ NEW BEST CER: 0.8044 (improved by 0.0054)
================================================================================

{'loss': 13.3869, 'grad_norm': 3.91599178314209, 'learning_rate': 0.0002125926129668154, 'epoch': 2.09}
{'eval_loss': 0.18915727734565735, 'eval_runtime': 109.6708, 'eval_samples_per_second': 0.228, 'eval_steps_per_second': 0.228, 'epoch': 2.92}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 2)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 2): 0.6520 (65.20%)
   ğŸ¯ NEW BEST CER: 0.6520 (improved by 0.1524)
================================================================================

{'eval_loss': 0.1402011662721634, 'eval_runtime': 109.8017, 'eval_samples_per_second': 0.228, 'eval_steps_per_second': 0.228, 'epoch': 3.97}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 3)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 3): 0.2308 (23.08%)
   ğŸ¯ NEW BEST CER: 0.2308 (improved by 0.4212)
================================================================================

{'loss': 4.3402, 'grad_norm': 2.2705957889556885, 'learning_rate': 0.00011607760868035448, 'epoch': 4.17}
{'eval_loss': 0.12374032288789749, 'eval_runtime': 109.9332, 'eval_samples_per_second': 0.227, 'eval_steps_per_second': 0.227, 'epoch': 4.8}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 4)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 4): 0.0715 (7.15%)
   ğŸ¯ NEW BEST CER: 0.0715 (improved by 0.1594)
================================================================================

{'eval_loss': 0.11763527244329453, 'eval_runtime': 109.8535, 'eval_samples_per_second': 0.228, 'eval_steps_per_second': 0.228, 'epoch': 5.84}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 5)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 5): 0.0741 (7.41%)
   ğŸ“Š No improvement. Best CER remains: 0.0715
================================================================================

{'loss': 2.3745, 'grad_norm': 1.8444006443023682, 'learning_rate': 1.956260439389357e-05, 'epoch': 6.26}
{'eval_loss': 0.11577606201171875, 'eval_runtime': 109.9712, 'eval_samples_per_second': 0.227, 'eval_steps_per_second': 0.227, 'epoch': 6.89}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 6)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 6): 0.0829 (8.29%)
   ğŸ“Š No improvement. Best CER remains: 0.0715
================================================================================

{'eval_loss': 0.115765780210495, 'eval_runtime': 109.9372, 'eval_samples_per_second': 0.227, 'eval_steps_per_second': 0.227, 'epoch': 7.51}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 7)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 7): 0.0821 (8.21%)
   ğŸ“Š No improvement. Best CER remains: 0.0715
================================================================================

{'train_runtime': 28018.9385, 'train_samples_per_second': 0.037, 'train_steps_per_second': 0.001, 'train_loss': 5.9227935208214655, 'epoch': 7.51}

================================================================================
âœ… TRIAL TRAINING COMPLETED!
================================================================================
   ğŸ¯ Best Validation CER in this trial: 0.0715 (7.15%)
================================================================================

================================================================================
PHI-3.5-VISION FINE-TUNING (HPO TRIAL) - STAIRCASE DATASET
BitsAndBytes QLoRA 4-bit (Memory-Optimized)
================================================================================

ğŸ“‚ Trial output directory: /home/vault/iwi5/iwi5298h/models_image_text/phi/hpo_stair/trials/trial_3
   â€¢ Training epochs: 9
   â€¢ Batch size: 1
   â€¢ Gradient accumulation: 16
   â€¢ Learning rate: 0.00025054062747526944
   â€¢ Weight decay: 0.020497980520950188
   â€¢ LoRA r=32, alpha=32, dropout=0.14218742350231167

ğŸ›¡ï¸  Memory Optimization:
   â€¢ 4-bit NF4 Quantization: True
   â€¢ Nested Quantization: True

ğŸ”§ Anti-Repetition:
   â€¢ First-JSON extraction: enabled
   â€¢ Using temperature=0.0 for deterministic generation

â³ Loading Phi-3.5-Vision with 4-bit quantization...
   âœ… Model loaded with 4-bit quantization
   ğŸ“Š GPU Memory - Allocated: 2.28 GB, Reserved: 2.39 GB

ğŸ“ Preparing model for LoRA training...
   âœ… LoRA applied successfully
   ğŸ“Š Trainable params: 50,331,648 / 4,196,953,088 (1.20%)
ğŸš€ Starting QLoRA training on STAIRCASE dataset (HPO trial)...

================================================================================
{'eval_loss': 0.5178084373474121, 'eval_runtime': 109.8188, 'eval_samples_per_second': 0.228, 'eval_steps_per_second': 0.228, 'epoch': 0.97}

================================================================================
ğŸ” COMPUTING CER ON VALIDATION SET (Epoch 0)
================================================================================
   Validating 1/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (150).jpg   Validating 2/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (110).jpg   Validating 3/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (156).jpg   Validating 4/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (82).jpg   Validating 5/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (93).jpg   Validating 6/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (74).jpg   Validating 7/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (80).jpg   Validating 8/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (118).jpg   Validating 9/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (91).jpg   Validating 10/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (147).jpg   Validating 11/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (86).jpg   Validating 12/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (72).jpg   Validating 13/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (119).jpg   Validating 14/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (1).jpg   Validating 15/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (98).jpg   Validating 16/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (90).jpg   Validating 17/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (2).jpg   Validating 18/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (96).jpg   Validating 19/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (162).jpg   Validating 20/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (9).jpg   Validating 21/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (61).jpg   Validating 22/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (50).jpg   Validating 23/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (63).jpg   Validating 24/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (127).jpg   Validating 25/25: FMIS_FormblaÌˆtterMielke_gefÃ¼llt (39).jpg
   âœ… Validation CER (Epoch 0): 0.9250 (92.50%)
   ğŸ¯ NEW BEST CER: 0.9250 (improved by inf)
================================================================================

{'loss': 10.1301, 'grad_norm': 2.3524112701416016, 'learning_rate': 0.00024877068553225563, 'epoch': 1.39}
=== JOB_STATISTICS ===
=== current date     : Sat Dec  6 05:36:41 PM CET 2025
= Job-ID             : 1457152 on tinygpu
= Job-Name           : phi_stair_with_hpo
= Job-Command        : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles/job_phi.sh
= Initial workdir    : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles
= Queue/Partition    : v100
= Slurm account      : iwi5 with QOS=normal
= Requested resources:  for 1-00:00:00
= Elapsed runtime    : 1-00:00:17
= Total RAM usage    : 10.7 GiB of requested  GiB (%)   
= Node list          : tg074
= Subm/Elig/Start/End: 2025-12-05T17:36:21 / 2025-12-05T17:36:21 / 2025-12-05T17:36:22 / 2025-12-06T17:36:39
======================
=== Quota infos ======
    Path                 Used     SoftQ    HardQ    Gracetime  Filec    FileQ    FiHaQ    FileGrace    
    /home/hpc              88.3G   104.9G   209.7G        N/A  28,354      500K   1,000K        N/A    
    /home/woody           208.9G  1000.0G  1500.0G        N/A     939K   5,000K   7,500K        N/A    
======================
=== GPU utilization ==
gpu_name, gpu_bus_id, pid, gpu_utilization [%], mem_utilization [%], max_memory_usage [MiB], time [ms]
Tesla V100-PCIE-32GB, 00000000:86:00.0, 235452, 65 %, 26 %, 11858 MiB, 86400003 ms
