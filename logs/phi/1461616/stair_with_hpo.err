/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/transformers/models/auto/image_processing_auto.py:520: FutureWarning: The image_processor_class argument is deprecated and will be removed in v4.42. Please use `slow_image_processor_class`, or `fast_image_processor_class` instead
  warnings.warn(
/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/optuna/_experimental.py:32: ExperimentalWarning: Argument ``multivariate`` is an experimental feature. The interface can change in the future.
  warnings.warn(
/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/optuna/_experimental.py:32: ExperimentalWarning: Argument ``group`` is an experimental feature. The interface can change in the future.
  warnings.warn(
[I 2025-12-10 00:36:04,498] Using an existing study with name 'phi_vision_stair' instead of creating a new one.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:48<00:48, 48.05s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:18<00:00, 37.67s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:18<00:00, 39.23s/it]
  0%|          | 0/70 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
You are not running the flash-attention implementation, expect numerical differences.
  1%|▏         | 1/70 [00:54<1:02:52, 54.67s/it]  3%|▎         | 2/70 [01:48<1:01:27, 54.23s/it]  4%|▍         | 3/70 [02:43<1:01:05, 54.71s/it]  6%|▌         | 4/70 [03:37<59:50, 54.40s/it]    7%|▋         | 5/70 [04:32<59:11, 54.64s/it]  9%|▊         | 6/70 [05:27<58:07, 54.50s/it] 10%|█         | 7/70 [06:21<57:20, 54.61s/it] 11%|█▏        | 8/70 [07:16<56:26, 54.62s/it] 13%|█▎        | 9/70 [08:10<55:18, 54.40s/it] 14%|█▍        | 10/70 [09:04<54:13, 54.22s/it] 16%|█▌        | 11/70 [09:57<53:09, 54.06s/it] 17%|█▋        | 12/70 [10:53<52:37, 54.44s/it] 19%|█▊        | 13/70 [11:47<51:31, 54.24s/it] 20%|██        | 14/70 [12:41<50:37, 54.24s/it] 21%|██▏       | 15/70 [13:36<49:58, 54.52s/it] 23%|██▎       | 16/70 [14:30<48:51, 54.29s/it] 24%|██▍       | 17/70 [15:24<47:50, 54.17s/it] 26%|██▌       | 18/70 [16:18<46:58, 54.20s/it] 27%|██▋       | 19/70 [17:12<46:08, 54.28s/it] 29%|██▊       | 20/70 [18:07<45:19, 54.39s/it]                                                29%|██▊       | 20/70 [18:07<45:19, 54.39s/it] 30%|███       | 21/70 [19:02<44:26, 54.42s/it] 31%|███▏      | 22/70 [19:55<43:23, 54.23s/it] 33%|███▎      | 23/70 [20:50<42:32, 54.31s/it] 34%|███▍      | 24/70 [21:43<41:29, 54.11s/it] 36%|███▌      | 25/70 [22:38<40:37, 54.17s/it] 37%|███▋      | 26/70 [23:33<39:51, 54.34s/it] 39%|███▊      | 27/70 [24:27<38:58, 54.40s/it] 40%|████      | 28/70 [25:21<38:04, 54.39s/it] 41%|████▏     | 29/70 [26:17<37:19, 54.63s/it] 43%|████▎     | 30/70 [27:11<36:21, 54.53s/it] 44%|████▍     | 31/70 [28:04<35:15, 54.24s/it] 46%|████▌     | 32/70 [28:58<34:16, 54.11s/it] 47%|████▋     | 33/70 [29:52<33:21, 54.09s/it] 49%|████▊     | 34/70 [30:47<32:28, 54.13s/it] 50%|█████     | 35/70 [31:41<31:34, 54.14s/it] 51%|█████▏    | 36/70 [32:35<30:41, 54.15s/it] 53%|█████▎    | 37/70 [33:29<29:46, 54.14s/it] 54%|█████▍    | 38/70 [34:24<29:03, 54.47s/it] 56%|█████▌    | 39/70 [35:18<28:05, 54.39s/it] 57%|█████▋    | 40/70 [36:13<27:11, 54.39s/it]                                                57%|█████▋    | 40/70 [36:13<27:11, 54.39s/it] 59%|█████▊    | 41/70 [37:07<26:19, 54.47s/it] 60%|██████    | 42/70 [38:01<25:21, 54.34s/it] 61%|██████▏   | 43/70 [38:55<24:20, 54.09s/it] 63%|██████▎   | 44/70 [39:50<23:36, 54.48s/it] 64%|██████▍   | 45/70 [40:45<22:41, 54.46s/it] 66%|██████▌   | 46/70 [41:38<21:40, 54.19s/it] 67%|██████▋   | 47/70 [42:33<20:48, 54.28s/it] 69%|██████▊   | 48/70 [43:27<19:52, 54.19s/it] 70%|███████   | 49/70 [44:22<19:03, 54.46s/it] 71%|███████▏  | 50/70 [45:17<18:09, 54.49s/it] 73%|███████▎  | 51/70 [46:11<17:17, 54.61s/it] 74%|███████▍  | 52/70 [47:06<16:20, 54.46s/it] 76%|███████▌  | 53/70 [48:00<15:25, 54.43s/it] 77%|███████▋  | 54/70 [48:54<14:28, 54.31s/it] 79%|███████▊  | 55/70 [49:48<13:32, 54.15s/it] 80%|████████  | 56/70 [50:42<12:38, 54.18s/it] 81%|████████▏ | 57/70 [51:36<11:42, 54.03s/it] 83%|████████▎ | 58/70 [52:31<10:53, 54.47s/it] 84%|████████▍ | 59/70 [53:25<09:57, 54.30s/it] 86%|████████▌ | 60/70 [54:19<09:03, 54.35s/it]                                                86%|████████▌ | 60/70 [54:19<09:03, 54.35s/it] 87%|████████▋ | 61/70 [55:14<08:10, 54.51s/it] 89%|████████▊ | 62/70 [56:08<07:15, 54.38s/it] 90%|█████████ | 63/70 [57:03<06:20, 54.32s/it] 91%|█████████▏| 64/70 [57:57<05:26, 54.43s/it] 93%|█████████▎| 65/70 [58:51<04:31, 54.36s/it] 94%|█████████▍| 66/70 [59:45<03:36, 54.16s/it] 96%|█████████▌| 67/70 [1:00:40<02:42, 54.33s/it] 97%|█████████▋| 68/70 [1:01:34<01:48, 54.34s/it] 99%|█████████▊| 69/70 [1:02:29<00:54, 54.36s/it]100%|██████████| 70/70 [1:03:23<00:00, 54.22s/it]                                                 100%|██████████| 70/70 [1:03:23<00:00, 54.22s/it]100%|██████████| 70/70 [1:03:23<00:00, 54.33s/it]
/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:590: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
The `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
`get_max_cache()` is deprecated for all Cache classes. Use `get_max_cache_shape()` instead. Calling `get_max_cache()` will raise error from v4.48
[I 2025-12-10 01:55:22,640] Trial 20 finished with value: 0.0685855707151872 and parameters: {'learning_rate': 0.00037241480817131855, 'weight_decay': 0.07175552379497577, 'lora_r': 32, 'lora_alpha': 32, 'lora_dropout': 0.12209115696783587, 'gradient_accumulation_steps': 8}. Best is trial 13 with value: 0.059932771827097955.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:45<00:45, 45.57s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 36.81s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 38.13s/it]
  0%|          | 0/35 [00:00<?, ?it/s]/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  3%|▎         | 1/35 [01:47<1:00:48, 107.30s/it]  6%|▌         | 2/35 [03:35<59:23, 107.99s/it]    9%|▊         | 3/35 [05:24<57:44, 108.27s/it] 11%|█▏        | 4/35 [07:13<56:04, 108.54s/it] 14%|█▍        | 5/35 [09:00<54:00, 108.02s/it] 17%|█▋        | 6/35 [10:48<52:16, 108.16s/it] 20%|██        | 7/35 [12:36<50:21, 107.90s/it] 23%|██▎       | 8/35 [14:24<48:36, 108.02s/it] 26%|██▌       | 9/35 [16:12<46:45, 107.90s/it] 29%|██▊       | 10/35 [18:00<45:03, 108.14s/it] 31%|███▏      | 11/35 [19:48<43:12, 108.03s/it] 34%|███▍      | 12/35 [21:36<41:21, 107.91s/it] 37%|███▋      | 13/35 [23:24<39:37, 108.07s/it] 40%|████      | 14/35 [25:13<37:51, 108.17s/it] 43%|████▎     | 15/35 [27:02<36:08, 108.42s/it] 46%|████▌     | 16/35 [28:48<34:10, 107.93s/it] 49%|████▊     | 17/35 [30:36<32:21, 107.87s/it] 51%|█████▏    | 18/35 [32:24<30:33, 107.87s/it] 54%|█████▍    | 19/35 [34:13<28:50, 108.15s/it] 57%|█████▋    | 20/35 [36:01<27:01, 108.12s/it]                                                 57%|█████▋    | 20/35 [36:01<27:01, 108.12s/it] 60%|██████    | 21/35 [37:49<25:13, 108.14s/it] 63%|██████▎   | 22/35 [39:39<23:32, 108.65s/it] 66%|██████▌   | 23/35 [41:26<21:39, 108.29s/it] 69%|██████▊   | 24/35 [43:14<19:50, 108.19s/it] 71%|███████▏  | 25/35 [45:03<18:04, 108.47s/it] 74%|███████▍  | 26/35 [46:52<16:16, 108.45s/it] 77%|███████▋  | 27/35 [48:40<14:26, 108.29s/it] 80%|████████  | 28/35 [50:27<12:36, 108.01s/it] 83%|████████▎ | 29/35 [52:15<10:48, 108.04s/it] 86%|████████▌ | 30/35 [54:03<08:59, 108.00s/it] 89%|████████▊ | 31/35 [55:51<07:12, 108.10s/it] 91%|█████████▏| 32/35 [57:40<05:24, 108.15s/it] 94%|█████████▍| 33/35 [59:27<03:35, 107.91s/it] 97%|█████████▋| 34/35 [1:01:16<01:48, 108.19s/it]100%|██████████| 35/35 [1:03:04<00:00, 108.15s/it]                                                  100%|██████████| 35/35 [1:03:04<00:00, 108.15s/it]100%|██████████| 35/35 [1:03:04<00:00, 108.13s/it]
/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:590: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
[I 2025-12-10 03:14:40,798] Trial 21 finished with value: 0.10956394641346481 and parameters: {'learning_rate': 0.0002573136135493254, 'weight_decay': 0.060744156175545204, 'lora_r': 24, 'lora_alpha': 48, 'lora_dropout': 0.11322970618853301, 'gradient_accumulation_steps': 16}. Best is trial 13 with value: 0.059932771827097955.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:45<00:45, 45.38s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:17<00:00, 37.61s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:17<00:00, 38.77s/it]
  0%|          | 0/70 [00:00<?, ?it/s]/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|▏         | 1/70 [00:53<1:01:34, 53.55s/it]  3%|▎         | 2/70 [01:46<1:00:37, 53.49s/it]  4%|▍         | 3/70 [02:41<1:00:20, 54.04s/it]  6%|▌         | 4/70 [03:35<59:10, 53.80s/it]    7%|▋         | 5/70 [04:29<58:41, 54.17s/it]  9%|▊         | 6/70 [05:23<57:36, 54.00s/it] 10%|█         | 7/70 [06:17<56:49, 54.12s/it] 11%|█▏        | 8/70 [07:12<55:58, 54.16s/it] 13%|█▎        | 9/70 [08:05<54:50, 53.95s/it] 14%|█▍        | 10/70 [08:59<53:45, 53.76s/it] 16%|█▌        | 11/70 [09:52<52:43, 53.62s/it] 17%|█▋        | 12/70 [10:47<52:11, 53.99s/it] 19%|█▊        | 13/70 [11:40<51:05, 53.78s/it] 20%|██        | 14/70 [12:34<50:10, 53.75s/it] 21%|██▏       | 15/70 [13:28<49:31, 54.03s/it] 23%|██▎       | 16/70 [14:22<48:23, 53.78s/it] 24%|██▍       | 17/70 [15:15<47:23, 53.65s/it] 26%|██▌       | 18/70 [16:09<46:31, 53.69s/it] 27%|██▋       | 19/70 [17:03<45:43, 53.79s/it] 29%|██▊       | 20/70 [17:57<44:54, 53.90s/it]                                                29%|██▊       | 20/70 [17:57<44:54, 53.90s/it] 30%|███       | 21/70 [18:51<44:02, 53.93s/it] 31%|███▏      | 22/70 [19:44<42:59, 53.75s/it] 33%|███▎      | 23/70 [20:38<42:09, 53.82s/it] 34%|███▍      | 24/70 [21:31<41:06, 53.63s/it] 36%|███▌      | 25/70 [22:25<40:15, 53.68s/it] 37%|███▋      | 26/70 [23:19<39:29, 53.85s/it] 39%|███▊      | 27/70 [24:13<38:38, 53.91s/it] 40%|████      | 28/70 [25:07<37:44, 53.91s/it] 41%|████▏     | 29/70 [26:02<36:59, 54.14s/it] 43%|████▎     | 30/70 [26:56<36:02, 54.06s/it] 44%|████▍     | 31/70 [27:49<34:56, 53.76s/it] 46%|████▌     | 32/70 [28:42<33:57, 53.63s/it] 47%|████▋     | 33/70 [29:36<33:03, 53.60s/it] 49%|████▊     | 34/70 [30:30<32:10, 53.64s/it] 50%|█████     | 35/70 [31:23<31:17, 53.64s/it] 51%|█████▏    | 36/70 [32:17<30:24, 53.67s/it] 53%|█████▎    | 37/70 [33:11<29:30, 53.66s/it] 54%|█████▍    | 38/70 [34:05<28:47, 53.99s/it] 56%|█████▌    | 39/70 [34:59<27:51, 53.92s/it] 57%|█████▋    | 40/70 [35:53<26:58, 53.93s/it]                                                57%|█████▋    | 40/70 [35:53<26:58, 53.93s/it] 59%|█████▊    | 41/70 [36:47<26:06, 54.02s/it] 60%|██████    | 42/70 [37:41<25:09, 53.90s/it] 61%|██████▏   | 43/70 [38:34<24:08, 53.66s/it] 63%|██████▎   | 44/70 [39:29<23:25, 54.05s/it] 64%|██████▍   | 45/70 [40:23<22:30, 54.03s/it] 66%|██████▌   | 46/70 [41:16<21:29, 53.73s/it] 67%|██████▋   | 47/70 [42:10<20:37, 53.82s/it] 69%|██████▊   | 48/70 [43:03<19:41, 53.72s/it] 70%|███████   | 49/70 [43:58<18:54, 54.01s/it] 71%|███████▏  | 50/70 [44:52<18:00, 54.05s/it] 73%|███████▎  | 51/70 [45:47<17:09, 54.17s/it] 74%|███████▍  | 52/70 [46:40<16:12, 54.01s/it] 76%|███████▌  | 53/70 [47:34<15:17, 53.98s/it] 77%|███████▋  | 54/70 [48:28<14:21, 53.84s/it] 79%|███████▊  | 55/70 [49:21<13:24, 53.66s/it] 80%|████████  | 56/70 [50:15<12:32, 53.72s/it] 81%|████████▏ | 57/70 [51:08<11:36, 53.56s/it] 83%|████████▎ | 58/70 [52:03<10:46, 53.85s/it] 84%|████████▍ | 59/70 [52:56<09:50, 53.71s/it] 86%|████████▌ | 60/70 [53:50<08:57, 53.78s/it]                                                86%|████████▌ | 60/70 [53:50<08:57, 53.78s/it] 87%|████████▋ | 61/70 [54:44<08:05, 53.98s/it] 89%|████████▊ | 62/70 [55:38<07:11, 53.88s/it] 90%|█████████ | 63/70 [56:32<06:16, 53.83s/it] 91%|█████████▏| 64/70 [57:26<05:23, 53.92s/it] 93%|█████████▎| 65/70 [58:20<04:29, 53.88s/it] 94%|█████████▍| 66/70 [59:13<03:34, 53.67s/it] 96%|█████████▌| 67/70 [1:00:07<02:41, 53.85s/it] 97%|█████████▋| 68/70 [1:01:01<01:47, 53.88s/it] 99%|█████████▊| 69/70 [1:01:55<00:53, 53.89s/it]100%|██████████| 70/70 [1:02:48<00:00, 53.76s/it]                                                 100%|██████████| 70/70 [1:02:48<00:00, 53.76s/it]100%|██████████| 70/70 [1:02:48<00:00, 53.84s/it]
/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:590: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
[I 2025-12-10 04:33:33,532] Trial 22 finished with value: 0.05955545994784158 and parameters: {'learning_rate': 0.00034400132558662724, 'weight_decay': 0.04018574300324156, 'lora_r': 8, 'lora_alpha': 64, 'lora_dropout': 0.13404054837617638, 'gradient_accumulation_steps': 8}. Best is trial 22 with value: 0.05955545994784158.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.96s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.57s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.62s/it]
  0%|          | 0/70 [00:00<?, ?it/s]/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|▏         | 1/70 [00:53<1:01:34, 53.54s/it]  3%|▎         | 2/70 [01:46<1:00:33, 53.43s/it]  4%|▍         | 3/70 [02:41<1:00:16, 53.98s/it]  6%|▌         | 4/70 [03:34<59:07, 53.75s/it]    7%|▋         | 5/70 [04:29<58:32, 54.04s/it]  9%|▊         | 6/70 [05:23<57:31, 53.93s/it] 10%|█         | 7/70 [06:17<56:46, 54.07s/it] 11%|█▏        | 8/70 [07:11<55:55, 54.11s/it] 13%|█▎        | 9/70 [08:05<54:48, 53.91s/it] 14%|█▍        | 10/70 [08:58<53:43, 53.72s/it] 16%|█▌        | 11/70 [09:51<52:41, 53.58s/it] 17%|█▋        | 12/70 [10:46<52:09, 53.95s/it] 19%|█▊        | 13/70 [11:39<51:04, 53.76s/it] 20%|██        | 14/70 [12:33<50:09, 53.73s/it] 21%|██▏       | 15/70 [13:28<49:30, 54.01s/it] 23%|██▎       | 16/70 [14:21<48:24, 53.79s/it] 24%|██▍       | 17/70 [15:14<47:24, 53.68s/it] 26%|██▌       | 18/70 [16:08<46:33, 53.72s/it] 27%|██▋       | 19/70 [17:02<45:44, 53.80s/it] 29%|██▊       | 20/70 [17:56<44:55, 53.92s/it]                                                29%|██▊       | 20/70 [17:56<44:55, 53.92s/it] 30%|███       | 21/70 [18:51<44:04, 53.97s/it] 31%|███▏      | 22/70 [19:44<43:02, 53.79s/it] 33%|███▎      | 23/70 [20:38<42:10, 53.84s/it] 34%|███▍      | 24/70 [21:31<41:07, 53.64s/it] 36%|███▌      | 25/70 [22:25<40:16, 53.70s/it] 37%|███▋      | 26/70 [23:19<39:30, 53.87s/it] 39%|███▊      | 27/70 [24:13<38:39, 53.94s/it] 40%|████      | 28/70 [25:07<37:45, 53.94s/it] 41%|████▏     | 29/70 [26:02<37:01, 54.17s/it] 43%|████▎     | 30/70 [26:56<36:03, 54.08s/it] 44%|████▍     | 31/70 [27:49<34:57, 53.77s/it] 46%|████▌     | 32/70 [28:42<33:58, 53.64s/it] 47%|████▋     | 33/70 [29:36<33:03, 53.61s/it] 49%|████▊     | 34/70 [30:29<32:11, 53.66s/it] 50%|█████     | 35/70 [31:23<31:17, 53.65s/it] 51%|█████▏    | 36/70 [32:17<30:25, 53.68s/it] 53%|█████▎    | 37/70 [33:11<29:31, 53.68s/it] 54%|█████▍    | 38/70 [34:05<28:48, 54.01s/it] 56%|█████▌    | 39/70 [34:59<27:51, 53.93s/it] 57%|█████▋    | 40/70 [35:53<26:57, 53.93s/it]                                                57%|█████▋    | 40/70 [35:53<26:57, 53.93s/it] 59%|█████▊    | 41/70 [36:47<26:06, 54.00s/it] 60%|██████    | 42/70 [37:41<25:08, 53.88s/it] 61%|██████▏   | 43/70 [38:34<24:08, 53.63s/it] 63%|██████▎   | 44/70 [39:29<23:24, 54.01s/it] 64%|██████▍   | 45/70 [40:23<22:29, 53.99s/it] 66%|██████▌   | 46/70 [41:16<21:28, 53.71s/it] 67%|██████▋   | 47/70 [42:10<20:37, 53.79s/it] 69%|██████▊   | 48/70 [43:03<19:41, 53.70s/it] 70%|███████   | 49/70 [43:58<18:53, 53.99s/it] 71%|███████▏  | 50/70 [44:52<18:00, 54.04s/it] 73%|███████▎  | 51/70 [45:46<17:09, 54.16s/it] 74%|███████▍  | 52/70 [46:40<16:12, 54.01s/it] 76%|███████▌  | 53/70 [47:34<15:17, 53.97s/it] 77%|███████▋  | 54/70 [48:28<14:21, 53.86s/it] 79%|███████▊  | 55/70 [49:21<13:25, 53.69s/it] 80%|████████  | 56/70 [50:15<12:31, 53.71s/it] 81%|████████▏ | 57/70 [51:08<11:36, 53.56s/it] 83%|████████▎ | 58/70 [52:02<10:46, 53.85s/it] 84%|████████▍ | 59/70 [52:56<09:50, 53.71s/it] 86%|████████▌ | 60/70 [53:50<08:57, 53.79s/it]                                                86%|████████▌ | 60/70 [53:50<08:57, 53.79s/it] 87%|████████▋ | 61/70 [54:44<08:05, 53.98s/it] 89%|████████▊ | 62/70 [55:38<07:10, 53.86s/it] 90%|█████████ | 63/70 [56:31<06:16, 53.81s/it] 91%|█████████▏| 64/70 [57:26<05:23, 53.91s/it] 93%|█████████▎| 65/70 [58:19<04:29, 53.87s/it] 94%|█████████▍| 66/70 [59:12<03:34, 53.67s/it] 96%|█████████▌| 67/70 [1:00:07<02:41, 53.83s/it] 97%|█████████▋| 68/70 [1:01:01<01:47, 53.87s/it] 99%|█████████▊| 69/70 [1:01:55<00:53, 53.89s/it]100%|██████████| 70/70 [1:02:48<00:00, 53.75s/it]                                                 100%|██████████| 70/70 [1:02:48<00:00, 53.75s/it]100%|██████████| 70/70 [1:02:48<00:00, 53.84s/it]
/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:590: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
[I 2025-12-10 05:51:16,410] Trial 23 finished with value: 0.06333144423604539 and parameters: {'learning_rate': 0.00021633711126361436, 'weight_decay': 0.037354164622519066, 'lora_r': 8, 'lora_alpha': 64, 'lora_dropout': 0.13715159798420698, 'gradient_accumulation_steps': 8}. Best is trial 22 with value: 0.05955545994784158.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.94s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.55s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.61s/it]
  0%|          | 0/70 [00:00<?, ?it/s]/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|▏         | 1/70 [00:53<1:01:52, 53.81s/it]  3%|▎         | 2/70 [01:47<1:00:50, 53.69s/it]  4%|▍         | 3/70 [02:42<1:00:34, 54.24s/it]  6%|▌         | 4/70 [03:35<59:25, 54.02s/it]    7%|▋         | 5/70 [04:30<58:48, 54.29s/it]  9%|▊         | 6/70 [05:24<57:45, 54.15s/it] 10%|█         | 7/70 [06:19<56:59, 54.28s/it] 11%|█▏        | 8/70 [07:13<56:07, 54.32s/it] 13%|█▎        | 9/70 [08:07<55:00, 54.11s/it] 14%|█▍        | 10/70 [09:00<53:55, 53.93s/it] 16%|█▌        | 11/70 [09:54<52:52, 53.77s/it] 17%|█▋        | 12/70 [10:49<52:20, 54.15s/it] 19%|█▊        | 13/70 [11:42<51:15, 53.96s/it] 20%|██        | 14/70 [12:36<50:21, 53.95s/it] 21%|██▏       | 15/70 [13:31<49:41, 54.21s/it] 23%|██▎       | 16/70 [14:24<48:35, 53.99s/it] 24%|██▍       | 17/70 [15:18<47:35, 53.88s/it] 26%|██▌       | 18/70 [16:12<46:43, 53.92s/it] 27%|██▋       | 19/70 [17:06<45:54, 54.01s/it] 29%|██▊       | 20/70 [18:01<45:06, 54.12s/it]                                                29%|██▊       | 20/70 [18:01<45:06, 54.12s/it] 30%|███       | 21/70 [18:55<44:14, 54.17s/it] 31%|███▏      | 22/70 [19:49<43:11, 53.98s/it] 33%|███▎      | 23/70 [20:43<42:20, 54.05s/it] 34%|███▍      | 24/70 [21:36<41:17, 53.86s/it] 36%|███▌      | 25/70 [22:30<40:25, 53.90s/it] 37%|███▋      | 26/70 [23:25<39:39, 54.07s/it] 39%|███▊      | 27/70 [24:19<38:47, 54.13s/it] 40%|████      | 28/70 [25:13<37:54, 54.15s/it] 41%|████▏     | 29/70 [26:08<37:09, 54.39s/it] 43%|████▎     | 30/70 [27:02<36:11, 54.29s/it] 44%|████▍     | 31/70 [27:55<35:05, 53.98s/it] 46%|████▌     | 32/70 [28:49<34:05, 53.84s/it] 47%|████▋     | 33/70 [29:43<33:11, 53.82s/it] 49%|████▊     | 34/70 [30:37<32:19, 53.86s/it] 50%|█████     | 35/70 [31:30<31:25, 53.87s/it] 51%|█████▏    | 36/70 [32:24<30:32, 53.90s/it] 53%|█████▎    | 37/70 [33:18<29:38, 53.89s/it] 54%|█████▍    | 38/70 [34:13<28:55, 54.22s/it] 56%|█████▌    | 39/70 [35:07<27:58, 54.16s/it] 57%|█████▋    | 40/70 [36:01<27:04, 54.16s/it]                                                57%|█████▋    | 40/70 [36:01<27:04, 54.16s/it] 59%|█████▊    | 41/70 [36:56<26:12, 54.24s/it] 60%|██████    | 42/70 [37:50<25:15, 54.11s/it] 61%|██████▏   | 43/70 [38:44<24:23, 54.22s/it] 63%|██████▎   | 44/70 [39:39<23:36, 54.49s/it] 64%|██████▍   | 45/70 [40:33<22:39, 54.38s/it] 66%|██████▌   | 46/70 [41:27<21:37, 54.05s/it] 67%|██████▋   | 47/70 [42:21<20:44, 54.10s/it] 69%|██████▊   | 48/70 [43:15<19:47, 53.99s/it] 70%|███████   | 49/70 [44:10<18:59, 54.26s/it] 71%|███████▏  | 50/70 [45:04<18:06, 54.30s/it] 73%|███████▎  | 51/70 [45:59<17:13, 54.42s/it] 74%|███████▍  | 52/70 [46:53<16:16, 54.26s/it] 76%|███████▌  | 53/70 [47:47<15:21, 54.20s/it] 77%|███████▋  | 54/70 [48:40<14:25, 54.08s/it] 79%|███████▊  | 55/70 [49:34<13:28, 53.92s/it] 80%|████████  | 56/70 [50:28<12:35, 53.94s/it] 81%|████████▏ | 57/70 [51:21<11:39, 53.80s/it] 83%|████████▎ | 58/70 [52:16<10:48, 54.07s/it] 84%|████████▍ | 59/70 [53:10<09:53, 53.93s/it] 86%|████████▌ | 60/70 [54:04<09:00, 54.00s/it]                                                86%|████████▌ | 60/70 [54:04<09:00, 54.00s/it] 87%|████████▋ | 61/70 [54:58<08:07, 54.19s/it] 89%|████████▊ | 62/70 [55:52<07:12, 54.08s/it] 90%|█████████ | 63/70 [56:46<06:18, 54.03s/it] 91%|█████████▏| 64/70 [57:41<05:24, 54.13s/it] 93%|█████████▎| 65/70 [58:35<04:30, 54.09s/it] 94%|█████████▍| 66/70 [59:28<03:35, 53.90s/it] 96%|█████████▌| 67/70 [1:00:23<02:42, 54.07s/it] 97%|█████████▋| 68/70 [1:01:17<01:48, 54.11s/it] 99%|█████████▊| 69/70 [1:02:11<00:54, 54.13s/it]100%|██████████| 70/70 [1:03:05<00:00, 53.99s/it]                                                 100%|██████████| 70/70 [1:03:05<00:00, 53.99s/it]100%|██████████| 70/70 [1:03:05<00:00, 54.07s/it]
/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:590: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
[I 2025-12-10 07:09:18,891] Trial 24 finished with value: 0.06602333130351676 and parameters: {'learning_rate': 0.00031338833653403176, 'weight_decay': 0.03307015267847087, 'lora_r': 24, 'lora_alpha': 64, 'lora_dropout': 0.13292842433505922, 'gradient_accumulation_steps': 8}. Best is trial 22 with value: 0.05955545994784158.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.00s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.60s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.66s/it]
  0%|          | 0/70 [00:00<?, ?it/s]/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|▏         | 1/70 [00:53<1:01:29, 53.46s/it]  3%|▎         | 2/70 [01:46<1:00:32, 53.41s/it]  4%|▍         | 3/70 [02:41<1:00:16, 53.98s/it]  6%|▌         | 4/70 [03:34<59:09, 53.78s/it]    7%|▋         | 5/70 [04:29<58:33, 54.06s/it]  9%|▊         | 6/70 [05:23<57:32, 53.94s/it] 10%|█         | 7/70 [06:17<56:46, 54.08s/it] 11%|█▏        | 8/70 [07:11<55:54, 54.11s/it] 13%|█▎        | 9/70 [08:05<54:47, 53.90s/it] 14%|█▍        | 10/70 [08:58<53:42, 53.70s/it] 16%|█▌        | 11/70 [09:51<52:40, 53.56s/it] 17%|█▋        | 12/70 [10:46<52:07, 53.93s/it] 19%|█▊        | 13/70 [11:39<51:03, 53.74s/it] 20%|██        | 14/70 [12:33<50:08, 53.73s/it] 21%|██▏       | 15/70 [13:28<49:29, 53.98s/it] 23%|██▎       | 16/70 [14:21<48:22, 53.75s/it] 24%|██▍       | 17/70 [15:14<47:22, 53.63s/it] 26%|██▌       | 18/70 [16:08<46:30, 53.67s/it] 27%|██▋       | 19/70 [17:02<45:42, 53.77s/it] 29%|██▊       | 20/70 [17:56<44:54, 53.89s/it]                                                29%|██▊       | 20/70 [17:56<44:54, 53.89s/it] 30%|███       | 21/70 [18:50<44:03, 53.94s/it] 31%|███▏      | 22/70 [19:43<43:00, 53.76s/it] 33%|███▎      | 23/70 [20:38<42:14, 53.92s/it] 34%|███▍      | 24/70 [21:31<41:09, 53.70s/it] 36%|███▌      | 25/70 [22:25<40:17, 53.73s/it] 37%|███▋      | 26/70 [23:19<39:30, 53.88s/it] 39%|███▊      | 27/70 [24:13<38:39, 53.94s/it] 40%|████      | 28/70 [25:07<37:44, 53.93s/it] 41%|████▏     | 29/70 [26:02<37:00, 54.16s/it] 43%|████▎     | 30/70 [26:55<36:02, 54.06s/it] 44%|████▍     | 31/70 [27:49<34:56, 53.75s/it] 46%|████▌     | 32/70 [28:42<33:57, 53.62s/it] 47%|████▋     | 33/70 [29:35<33:02, 53.58s/it] 49%|████▊     | 34/70 [30:29<32:10, 53.62s/it] 50%|█████     | 35/70 [31:23<31:17, 53.63s/it] 51%|█████▏    | 36/70 [32:16<30:24, 53.66s/it] 53%|█████▎    | 37/70 [33:10<29:30, 53.64s/it] 54%|█████▍    | 38/70 [34:05<28:47, 53.98s/it] 56%|█████▌    | 39/70 [34:58<27:50, 53.89s/it] 57%|█████▋    | 40/70 [35:52<26:57, 53.91s/it]                                                57%|█████▋    | 40/70 [35:52<26:57, 53.91s/it] 59%|█████▊    | 41/70 [36:47<26:05, 53.99s/it] 60%|██████    | 42/70 [37:40<25:08, 53.88s/it] 61%|██████▏   | 43/70 [38:33<24:08, 53.64s/it] 63%|██████▎   | 44/70 [39:28<23:24, 54.03s/it] 64%|██████▍   | 45/70 [40:22<22:30, 54.01s/it] 66%|██████▌   | 46/70 [41:15<21:29, 53.72s/it] 67%|██████▋   | 47/70 [42:09<20:37, 53.81s/it] 69%|██████▊   | 48/70 [43:03<19:41, 53.71s/it] 70%|███████   | 49/70 [43:57<18:53, 54.00s/it] 71%|███████▏  | 50/70 [44:51<18:00, 54.02s/it] 73%|███████▎  | 51/70 [45:46<17:08, 54.13s/it] 74%|███████▍  | 52/70 [46:39<16:11, 53.98s/it] 76%|███████▌  | 53/70 [47:33<15:16, 53.94s/it] 77%|███████▋  | 54/70 [48:27<14:21, 53.82s/it] 79%|███████▊  | 55/70 [49:20<13:24, 53.65s/it] 80%|████████  | 56/70 [50:14<12:31, 53.68s/it] 81%|████████▏ | 57/70 [51:07<11:35, 53.53s/it] 83%|████████▎ | 58/70 [52:02<10:45, 53.82s/it] 84%|████████▍ | 59/70 [52:55<09:50, 53.69s/it] 86%|████████▌ | 60/70 [53:49<08:57, 53.77s/it]                                                86%|████████▌ | 60/70 [53:49<08:57, 53.77s/it] 87%|████████▋ | 61/70 [54:43<08:05, 53.96s/it] 89%|████████▊ | 62/70 [55:37<07:10, 53.85s/it] 90%|█████████ | 63/70 [56:31<06:16, 53.80s/it] 91%|█████████▏| 64/70 [57:25<05:23, 53.90s/it] 93%|█████████▎| 65/70 [58:18<04:29, 53.86s/it] 94%|█████████▍| 66/70 [59:12<03:34, 53.66s/it] 96%|█████████▌| 67/70 [1:00:06<02:41, 53.84s/it] 97%|█████████▋| 68/70 [1:01:00<01:47, 53.86s/it] 99%|█████████▊| 69/70 [1:01:54<00:53, 53.87s/it]100%|██████████| 70/70 [1:02:47<00:00, 53.75s/it]                                                 100%|██████████| 70/70 [1:02:47<00:00, 53.75s/it]100%|██████████| 70/70 [1:02:47<00:00, 53.82s/it]
/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:590: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
[I 2025-12-10 08:26:57,204] Trial 25 finished with value: 0.06495759512175289 and parameters: {'learning_rate': 0.00037676638641132986, 'weight_decay': 0.04048799265109865, 'lora_r': 8, 'lora_alpha': 32, 'lora_dropout': 0.1327875075419971, 'gradient_accumulation_steps': 8}. Best is trial 22 with value: 0.05955545994784158.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  2.00s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.60s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.66s/it]
  0%|          | 0/35 [00:00<?, ?it/s]/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  3%|▎         | 1/35 [01:47<1:01:07, 107.88s/it]  6%|▌         | 2/35 [03:36<59:42, 108.55s/it]    9%|▊         | 3/35 [05:26<58:11, 109.10s/it] 11%|█▏        | 4/35 [07:16<56:27, 109.27s/it] 14%|█▍        | 5/35 [09:03<54:21, 108.70s/it] 17%|█▋        | 6/35 [10:52<52:34, 108.76s/it] 20%|██        | 7/35 [12:40<50:36, 108.46s/it] 23%|██▎       | 8/35 [14:29<48:51, 108.56s/it] 26%|██▌       | 9/35 [16:17<46:58, 108.41s/it] 29%|██▊       | 10/35 [18:06<45:15, 108.62s/it] 31%|███▏      | 11/35 [19:54<43:24, 108.53s/it] 34%|███▍      | 12/35 [21:43<41:33, 108.42s/it] 37%|███▋      | 13/35 [23:32<39:51, 108.72s/it] 40%|████      | 14/35 [25:21<38:06, 108.89s/it] 43%|████▎     | 15/35 [27:11<36:23, 109.15s/it] 46%|████▌     | 16/35 [28:59<34:24, 108.67s/it] 49%|████▊     | 17/35 [30:47<32:35, 108.62s/it] 51%|█████▏    | 18/35 [32:36<30:46, 108.63s/it] 54%|█████▍    | 19/35 [34:25<29:02, 108.89s/it] 57%|█████▋    | 20/35 [36:14<27:12, 108.81s/it]                                                 57%|█████▋    | 20/35 [36:14<27:12, 108.81s/it] 60%|██████    | 21/35 [38:03<25:23, 108.80s/it] 63%|██████▎   | 22/35 [39:53<23:39, 109.23s/it] 66%|██████▌   | 23/35 [41:41<21:46, 108.86s/it] 69%|██████▊   | 24/35 [43:29<19:55, 108.72s/it] 71%|███████▏  | 25/35 [45:19<18:10, 109.03s/it] 74%|███████▍  | 26/35 [47:08<16:21, 109.00s/it] 77%|███████▋  | 27/35 [48:56<14:30, 108.82s/it] 80%|████████  | 28/35 [50:44<12:39, 108.55s/it] 83%|████████▎ | 29/35 [52:33<10:51, 108.58s/it] 86%|████████▌ | 30/35 [54:21<09:02, 108.53s/it] 89%|████████▊ | 31/35 [56:10<07:14, 108.60s/it] 91%|█████████▏| 32/35 [57:59<05:25, 108.65s/it] 94%|█████████▍| 33/35 [59:47<03:36, 108.42s/it] 97%|█████████▋| 34/35 [1:01:36<01:48, 108.61s/it]100%|██████████| 35/35 [1:03:24<00:00, 108.52s/it]                                                  100%|██████████| 35/35 [1:03:24<00:00, 108.52s/it]100%|██████████| 35/35 [1:03:24<00:00, 108.70s/it]
/home/woody/iwi5/iwi5298h/software/private/conda/envs/phi_ocr/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:590: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
[I 2025-12-10 09:45:17,816] Trial 26 finished with value: 0.07033004236223214 and parameters: {'learning_rate': 0.0002958158903421939, 'weight_decay': 0.061246901324965526, 'lora_r': 32, 'lora_alpha': 64, 'lora_dropout': 0.1289477066319465, 'gradient_accumulation_steps': 16}. Best is trial 22 with value: 0.05955545994784158.
