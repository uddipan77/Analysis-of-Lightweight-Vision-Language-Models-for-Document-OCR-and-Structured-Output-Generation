### Starting TaskPrologue of job 1241821 on tg074 at Wed Oct 15 02:55:02 AM CEST 2025
Running on cores 0-1,8-9,16-17,24-25 with governor ondemand
Wed Oct 15 02:55:02 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.172.08             Driver Version: 570.172.08     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-PCIE-32GB           On  |   00000000:18:00.0 Off |                    0 |
| N/A   34C    P0             26W /  250W |       0MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
### Finished TaskPrologue

Starting Florence 2 inference...
Job ID: 1241821
Log Directory: /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/logs/Florence2/1241821
Job started at: Wed Oct 15 02:55:03 AM CEST 2025
============================================================
FLORENCE-2 IMPROVED LORA FINETUNING
============================================================

Loading datasets...
✓ Loaded 213 training samples
✓ Loaded 47 validation samples
✓ Loaded 48 test samples

Initializing improved LoRA trainer...
trainable params: 3,538,944 || all params: 780,004,352 || trainable%: 0.4537

Starting training...
{'loss': 4.3634, 'grad_norm': 2.6429944038391113, 'learning_rate': 4.878048780487805e-07, 'epoch': 0.04}
{'loss': 4.4162, 'grad_norm': 2.234764575958252, 'learning_rate': 2.4390243902439027e-06, 'epoch': 0.19}
{'loss': 4.3368, 'grad_norm': 2.4455485343933105, 'learning_rate': 4.8780487804878055e-06, 'epoch': 0.37}
{'loss': 4.4102, 'grad_norm': 2.326632499694824, 'learning_rate': 7.317073170731707e-06, 'epoch': 0.56}
{'loss': 4.3861, 'grad_norm': 2.2651844024658203, 'learning_rate': 9.756097560975611e-06, 'epoch': 0.74}
{'loss': 4.2292, 'grad_norm': 2.058206796646118, 'learning_rate': 1.2195121951219513e-05, 'epoch': 0.93}
{'eval_cer': 0.5672735228883113, 'eval_perfect_matches': 0.0, 'eval_json_valid_rate': 0.0, 'eval_loss': 4.026243686676025, 'eval_runtime': 7.7533, 'eval_samples_per_second': 6.062, 'eval_steps_per_second': 1.548, 'epoch': 1.0}
{'loss': 4.4866, 'grad_norm': 2.1661133766174316, 'learning_rate': 1.4634146341463415e-05, 'epoch': 1.11}
{'loss': 4.0443, 'grad_norm': 1.8936131000518799, 'learning_rate': 1.7073170731707317e-05, 'epoch': 1.3}
{'loss': 4.117, 'grad_norm': 1.7417552471160889, 'learning_rate': 1.9512195121951222e-05, 'epoch': 1.48}
{'loss': 3.9799, 'grad_norm': 1.5225569009780884, 'learning_rate': 1.9994041405510705e-05, 'epoch': 1.67}
{'loss': 3.7914, 'grad_norm': 1.276697039604187, 'learning_rate': 1.9969846785003134e-05, 'epoch': 1.85}
{'eval_cer': 0.5784116254166048, 'eval_perfect_matches': 0.0, 'eval_json_valid_rate': 0.0, 'eval_loss': 3.4767072200775146, 'eval_runtime': 7.8512, 'eval_samples_per_second': 5.986, 'eval_steps_per_second': 1.528, 'epoch': 2.0}
{'loss': 3.6005, 'grad_norm': 1.1368252038955688, 'learning_rate': 1.992708874098054e-05, 'epoch': 2.04}
{'loss': 3.6217, 'grad_norm': 1.06255304813385, 'learning_rate': 1.9865846887071596e-05, 'epoch': 2.22}
{'loss': 3.5447, 'grad_norm': 1.2139004468917847, 'learning_rate': 1.9786235252959555e-05, 'epoch': 2.41}
{'loss': 3.5289, 'grad_norm': 0.9186913371086121, 'learning_rate': 1.9688402072063905e-05, 'epoch': 2.59}
{'loss': 3.3563, 'grad_norm': 0.9127592444419861, 'learning_rate': 1.957252950553616e-05, 'epoch': 2.78}
{'loss': 3.4956, 'grad_norm': 0.8320553302764893, 'learning_rate': 1.9438833303083677e-05, 'epoch': 2.96}
{'eval_cer': 0.6243224169763529, 'eval_perfect_matches': 0.0, 'eval_json_valid_rate': 0.0, 'eval_loss': 3.1146538257598877, 'eval_runtime': 7.7341, 'eval_samples_per_second': 6.077, 'eval_steps_per_second': 1.552, 'epoch': 3.0}
{'loss': 3.4756, 'grad_norm': 0.929512083530426, 'learning_rate': 1.9287562401253023e-05, 'epoch': 3.15}
{'loss': 3.3205, 'grad_norm': 0.9701265096664429, 'learning_rate': 1.91189984599209e-05, 'epoch': 3.33}
{'loss': 3.1253, 'grad_norm': 0.9379120469093323, 'learning_rate': 1.8933455337855633e-05, 'epoch': 3.52}
{'loss': 3.1471, 'grad_norm': 0.9942159652709961, 'learning_rate': 1.873127850832571e-05, 'epoch': 3.7}
{'loss': 3.2107, 'grad_norm': 0.854170024394989, 'learning_rate': 1.8512844415843514e-05, 'epoch': 3.89}
{'eval_cer': 0.7029119797522917, 'eval_perfect_matches': 0.0, 'eval_json_valid_rate': 0.0, 'eval_loss': 2.872328042984009, 'eval_runtime': 7.7382, 'eval_samples_per_second': 6.074, 'eval_steps_per_second': 1.551, 'epoch': 4.0}
{'train_runtime': 118.797, 'train_samples_per_second': 26.895, 'train_steps_per_second': 3.409, 'train_loss': 3.772713855460838, 'epoch': 4.0}

Best validation CER: 0.5673

Running test evaluation...

============================================================
IMPROVED LORA FINETUNING COMPLETED!
============================================================
Results saved in: /home/vault/iwi5/iwi5298h/models_image_text/florence2/inventory/lora_improved_20251015_025519
============================================================

Job completed at: Wed Oct 15 03:02:45 AM CEST 2025
=== JOB_STATISTICS ===
=== current date     : Wed Oct 15 03:02:45 AM CEST 2025
= Job-ID             : 1241821 on tinygpu
= Job-Name           : Florence2_inventory3
= Job-Command        : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles/job_florence_inference.sh
= Initial workdir    : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles
= Queue/Partition    : v100
= Slurm account      : iwi5 with QOS=normal
= Requested resources:  for 12:00:00
= Elapsed runtime    : 00:07:43
= Total RAM usage    : 7.6 GiB of requested  GiB (%)   
= Node list          : tg074
= Subm/Elig/Start/End: 2025-10-15T02:55:21 / 2025-10-15T02:55:21 / 2025-10-15T02:55:22 / 2025-10-15T03:03:05
======================
=== Quota infos ======
    Path                 Used     SoftQ    HardQ    Gracetime  Filec    FileQ    FiHaQ    FileGrace    
    /home/woody           113.6G  1000.0G  1500.0G        N/A     529K   5,000K   7,500K        N/A    
!!! /home/hpc             116.3G   104.9G   209.7G  -29328days  31,843      500K   1,000K        N/A !!!
    /home/vault           785.1G  1048.6G  2097.2G        N/A   4,769      200K     400K        N/A    
======================
=== GPU utilization ==
gpu_name, gpu_bus_id, pid, gpu_utilization [%], mem_utilization [%], max_memory_usage [MiB], time [ms]
Tesla V100-PCIE-32GB, 00000000:18:00.0, 1296073, 37 %, 16 %, 32488 MiB, 445929 ms
