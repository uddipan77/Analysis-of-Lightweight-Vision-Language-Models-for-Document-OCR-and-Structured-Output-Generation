Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:51<00:51, 51.68s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:20<00:00, 38.20s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:20<00:00, 40.23s/it]
The image processor of type `Qwen2VLImageProcessor` is now loaded as a fast processor by default, even if the model checkpoint was saved with a slow processor. This is a breaking change and may produce slightly different outputs. To continue using the slow processor, instantiate this class with `use_fast=False`. Note that this behavior will be extended to all models in a future release.
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'bos_token_id': None}.
  0%|          | 0/108 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
  1%|          | 1/108 [00:09<16:43,  9.38s/it]  2%|▏         | 2/108 [00:16<13:54,  7.88s/it]  3%|▎         | 3/108 [00:22<12:45,  7.29s/it]  4%|▎         | 4/108 [00:29<12:01,  6.94s/it]  5%|▍         | 5/108 [00:35<11:37,  6.77s/it]  6%|▌         | 6/108 [00:42<11:22,  6.69s/it]  6%|▋         | 7/108 [00:48<11:14,  6.68s/it]  7%|▋         | 8/108 [00:55<11:10,  6.71s/it]  8%|▊         | 9/108 [01:02<11:03,  6.70s/it]  9%|▉         | 10/108 [01:08<10:51,  6.65s/it]                                                  9%|▉         | 10/108 [01:08<10:51,  6.65s/it] 10%|█         | 11/108 [01:15<10:50,  6.70s/it] 11%|█         | 12/108 [01:22<10:40,  6.67s/it] 12%|█▏        | 13/108 [01:29<10:44,  6.78s/it] 13%|█▎        | 14/108 [01:35<10:23,  6.63s/it] 14%|█▍        | 15/108 [01:42<10:22,  6.70s/it] 15%|█▍        | 16/108 [01:49<10:12,  6.66s/it] 16%|█▌        | 17/108 [01:55<09:57,  6.57s/it] 17%|█▋        | 18/108 [02:01<09:45,  6.50s/it] 18%|█▊        | 19/108 [02:08<09:36,  6.47s/it] 19%|█▊        | 20/108 [02:15<09:43,  6.63s/it]                                                 19%|█▊        | 20/108 [02:15<09:43,  6.63s/it] 19%|█▉        | 21/108 [02:21<09:37,  6.63s/it] 20%|██        | 22/108 [02:28<09:29,  6.63s/it] 21%|██▏       | 23/108 [02:34<09:20,  6.59s/it] 22%|██▏       | 24/108 [02:41<09:04,  6.48s/it] 23%|██▎       | 25/108 [02:47<08:58,  6.49s/it] 24%|██▍       | 26/108 [02:54<08:54,  6.52s/it] 25%|██▌       | 27/108 [03:00<08:49,  6.54s/it] 26%|██▌       | 28/108 [03:07<08:43,  6.54s/it] 27%|██▋       | 29/108 [03:14<08:39,  6.58s/it] 28%|██▊       | 30/108 [03:20<08:35,  6.61s/it]                                                 28%|██▊       | 30/108 [03:20<08:35,  6.61s/it] 29%|██▊       | 31/108 [03:27<08:33,  6.67s/it] 30%|██▉       | 32/108 [03:34<08:24,  6.64s/it] 31%|███       | 33/108 [03:40<08:18,  6.65s/it] 31%|███▏      | 34/108 [03:47<08:13,  6.67s/it] 32%|███▏      | 35/108 [03:54<08:13,  6.76s/it] 33%|███▎      | 36/108 [04:01<08:05,  6.74s/it] 34%|███▍      | 37/108 [04:07<07:54,  6.69s/it] 35%|███▌      | 38/108 [04:14<07:47,  6.68s/it] 36%|███▌      | 39/108 [04:21<07:41,  6.69s/it] 37%|███▋      | 40/108 [04:27<07:35,  6.69s/it]                                                 37%|███▋      | 40/108 [04:27<07:35,  6.69s/it] 38%|███▊      | 41/108 [04:34<07:23,  6.61s/it] 39%|███▉      | 42/108 [04:40<07:15,  6.60s/it] 40%|███▉      | 43/108 [04:47<07:04,  6.54s/it] 41%|████      | 44/108 [04:53<06:54,  6.48s/it] 42%|████▏     | 45/108 [05:00<06:48,  6.49s/it] 43%|████▎     | 46/108 [05:06<06:41,  6.48s/it] 44%|████▎     | 47/108 [05:12<06:35,  6.48s/it] 44%|████▍     | 48/108 [05:19<06:26,  6.43s/it] 45%|████▌     | 49/108 [05:25<06:22,  6.49s/it] 46%|████▋     | 50/108 [05:32<06:20,  6.57s/it]                                                 46%|████▋     | 50/108 [05:32<06:20,  6.57s/it] 47%|████▋     | 51/108 [05:39<06:11,  6.52s/it] 48%|████▊     | 52/108 [05:45<06:05,  6.52s/it] 49%|████▉     | 53/108 [05:51<05:56,  6.49s/it] 50%|█████     | 54/108 [05:53<04:32,  5.05s/it] 51%|█████     | 55/108 [06:03<05:49,  6.59s/it] 52%|█████▏    | 56/108 [06:10<05:39,  6.53s/it] 53%|█████▎    | 57/108 [06:16<05:30,  6.48s/it] 54%|█████▎    | 58/108 [06:23<05:26,  6.52s/it] 55%|█████▍    | 59/108 [06:29<05:22,  6.58s/it] 56%|█████▌    | 60/108 [06:36<05:19,  6.66s/it]                                                 56%|█████▌    | 60/108 [06:37<05:19,  6.66s/it] 56%|█████▋    | 61/108 [06:44<05:22,  6.86s/it] 57%|█████▋    | 62/108 [06:50<05:10,  6.75s/it] 58%|█████▊    | 63/108 [06:56<04:58,  6.63s/it] 59%|█████▉    | 64/108 [07:03<04:50,  6.61s/it] 60%|██████    | 65/108 [07:09<04:41,  6.55s/it] 61%|██████    | 66/108 [07:16<04:34,  6.55s/it] 62%|██████▏   | 67/108 [07:23<04:29,  6.57s/it] 63%|██████▎   | 68/108 [07:29<04:24,  6.61s/it] 64%|██████▍   | 69/108 [07:36<04:16,  6.57s/it] 65%|██████▍   | 70/108 [07:42<04:10,  6.58s/it]                                                 65%|██████▍   | 70/108 [07:42<04:10,  6.58s/it] 66%|██████▌   | 71/108 [07:49<04:03,  6.57s/it] 67%|██████▋   | 72/108 [07:55<03:55,  6.54s/it] 68%|██████▊   | 73/108 [08:02<03:49,  6.56s/it] 69%|██████▊   | 74/108 [08:09<03:45,  6.62s/it] 69%|██████▉   | 75/108 [08:15<03:38,  6.62s/it] 70%|███████   | 76/108 [08:22<03:30,  6.57s/it] 71%|███████▏  | 77/108 [08:28<03:21,  6.49s/it] 72%|███████▏  | 78/108 [08:35<03:15,  6.52s/it] 73%|███████▎  | 79/108 [08:42<03:12,  6.63s/it] 74%|███████▍  | 80/108 [08:48<03:05,  6.63s/it]                                                 74%|███████▍  | 80/108 [08:48<03:05,  6.63s/it] 75%|███████▌  | 81/108 [08:55<02:58,  6.63s/it] 76%|███████▌  | 82/108 [09:01<02:52,  6.62s/it] 77%|███████▋  | 83/108 [09:08<02:44,  6.60s/it] 78%|███████▊  | 84/108 [09:15<02:38,  6.58s/it] 79%|███████▊  | 85/108 [09:21<02:31,  6.60s/it] 80%|███████▉  | 86/108 [09:28<02:26,  6.67s/it] 81%|████████  | 87/108 [09:35<02:19,  6.64s/it] 81%|████████▏ | 88/108 [09:41<02:13,  6.69s/it] 82%|████████▏ | 89/108 [09:48<02:06,  6.68s/it] 83%|████████▎ | 90/108 [09:55<01:59,  6.64s/it]                                                 83%|████████▎ | 90/108 [09:55<01:59,  6.64s/it] 84%|████████▍ | 91/108 [10:01<01:53,  6.65s/it] 85%|████████▌ | 92/108 [10:08<01:45,  6.60s/it] 86%|████████▌ | 93/108 [10:14<01:38,  6.55s/it] 87%|████████▋ | 94/108 [10:21<01:32,  6.59s/it] 88%|████████▊ | 95/108 [10:28<01:25,  6.59s/it] 89%|████████▉ | 96/108 [10:34<01:18,  6.52s/it] 90%|████████▉ | 97/108 [10:40<01:11,  6.48s/it] 91%|█████████ | 98/108 [10:47<01:05,  6.52s/it] 92%|█████████▏| 99/108 [10:53<00:58,  6.52s/it] 93%|█████████▎| 100/108 [11:00<00:52,  6.53s/it]                                                  93%|█████████▎| 100/108 [11:00<00:52,  6.53s/it] 94%|█████████▎| 101/108 [11:06<00:45,  6.49s/it] 94%|█████████▍| 102/108 [11:13<00:39,  6.56s/it] 95%|█████████▌| 103/108 [11:20<00:32,  6.60s/it] 96%|█████████▋| 104/108 [11:26<00:25,  6.48s/it] 97%|█████████▋| 105/108 [11:33<00:19,  6.52s/it] 98%|█████████▊| 106/108 [11:39<00:13,  6.60s/it] 99%|█████████▉| 107/108 [11:46<00:06,  6.66s/it]100%|██████████| 108/108 [11:48<00:00,  5.17s/it]                                                 100%|██████████| 108/108 [11:51<00:00,  5.17s/it]100%|██████████| 108/108 [11:51<00:00,  6.59s/it]
Traceback (most recent call last):
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/nanonets/multi/inven_ms2.py", line 1026, in <module>
    main()
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/nanonets/multi/inven_ms2.py", line 976, in main
    trainer, cer_callback = finetuner.train_model(
                            ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/nanonets/multi/inven_ms2.py", line 620, in train_model
    trainer_stage2 = trainer_cls(
                     ^^^^^^^^^^^^
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/nanonets/multi/inven_ms2.py", line 54, in __init__
    super().__init__(*args, **kwargs)
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/nanonets/lib/python3.11/site-packages/unsloth/trainer.py", line 209, in new_init
    original_init(self, *args, **kwargs)
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/nanonets/multi/unsloth_compiled_cache/UnslothSFTTrainer.py", line 1172, in __init__
    super().__init__(
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/nanonets/lib/python3.11/site-packages/transformers/utils/deprecation.py", line 172, in wrapped_func
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/nanonets/multi/unsloth_compiled_cache/UnslothSFTTrainer.py", line 599, in __init__
    super().__init__(
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/nanonets/lib/python3.11/site-packages/transformers/utils/deprecation.py", line 172, in wrapped_func
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/nanonets/lib/python3.11/site-packages/transformers/trainer.py", line 807, in __init__
    self.control = self.callback_handler.on_init_end(self.args, self.state, self.control)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/nanonets/lib/python3.11/site-packages/transformers/trainer_callback.py", line 502, in on_init_end
    return self.call_event("on_init_end", args, state, control)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/nanonets/lib/python3.11/site-packages/transformers/trainer_callback.py", line 556, in call_event
    result = getattr(callback, event)(
             ^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'CERTrackingCallback' object has no attribute 'on_init_end'
