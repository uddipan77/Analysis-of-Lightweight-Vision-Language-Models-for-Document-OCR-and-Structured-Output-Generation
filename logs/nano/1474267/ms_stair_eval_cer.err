Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:51<00:51, 51.90s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:20<00:00, 37.95s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:20<00:00, 40.04s/it]
The image processor of type `Qwen2VLImageProcessor` is now loaded as a fast processor by default, even if the model checkpoint was saved with a slow processor. This is a breaking change and may produce slightly different outputs. To continue using the slow processor, instantiate this class with `use_fast=False`. Note that this behavior will be extended to all models in a future release.
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'bos_token_id': None}.
  0%|          | 0/220 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
  0%|          | 1/220 [00:14<52:35, 14.41s/it]  1%|          | 2/220 [00:24<43:18, 11.92s/it]  1%|▏         | 3/220 [00:35<41:27, 11.46s/it]  2%|▏         | 4/220 [00:45<39:35, 11.00s/it]  2%|▏         | 5/220 [00:56<39:38, 11.06s/it]  3%|▎         | 6/220 [01:06<37:57, 10.64s/it]  3%|▎         | 7/220 [01:17<37:24, 10.54s/it]  4%|▎         | 8/220 [01:27<36:47, 10.41s/it]  4%|▍         | 9/220 [01:37<36:05, 10.26s/it]  5%|▍         | 10/220 [01:47<35:34, 10.17s/it]                                                  5%|▍         | 10/220 [01:47<35:34, 10.17s/it]  5%|▌         | 11/220 [01:57<35:43, 10.25s/it]  5%|▌         | 12/220 [02:08<36:00, 10.39s/it]  6%|▌         | 13/220 [02:19<37:00, 10.73s/it]  6%|▋         | 14/220 [02:30<36:51, 10.74s/it]  7%|▋         | 15/220 [02:39<34:41, 10.15s/it]  7%|▋         | 16/220 [02:49<34:41, 10.20s/it]  8%|▊         | 17/220 [03:00<34:47, 10.29s/it]  8%|▊         | 18/220 [03:10<34:41, 10.31s/it]  9%|▊         | 19/220 [03:20<34:37, 10.34s/it]  9%|▉         | 20/220 [03:31<35:02, 10.51s/it]                                                  9%|▉         | 20/220 [03:31<35:02, 10.51s/it] 10%|▉         | 21/220 [03:42<34:49, 10.50s/it] 10%|█         | 22/220 [03:53<35:38, 10.80s/it] 10%|█         | 23/220 [04:03<34:41, 10.57s/it] 11%|█         | 24/220 [04:14<34:49, 10.66s/it] 11%|█▏        | 25/220 [04:25<34:48, 10.71s/it] 12%|█▏        | 26/220 [04:36<34:42, 10.73s/it] 12%|█▏        | 27/220 [04:46<33:50, 10.52s/it] 13%|█▎        | 28/220 [04:57<33:52, 10.59s/it] 13%|█▎        | 29/220 [05:06<32:56, 10.35s/it] 14%|█▎        | 30/220 [05:17<33:06, 10.46s/it]                                                 14%|█▎        | 30/220 [05:17<33:06, 10.46s/it] 14%|█▍        | 31/220 [05:28<32:54, 10.45s/it] 15%|█▍        | 32/220 [05:38<32:33, 10.39s/it] 15%|█▌        | 33/220 [05:49<33:04, 10.61s/it] 15%|█▌        | 34/220 [05:58<31:41, 10.22s/it] 16%|█▌        | 35/220 [06:09<31:57, 10.37s/it] 16%|█▋        | 36/220 [06:20<32:01, 10.44s/it] 17%|█▋        | 37/220 [06:30<31:57, 10.48s/it] 17%|█▋        | 38/220 [06:39<30:27, 10.04s/it] 18%|█▊        | 39/220 [06:50<30:49, 10.22s/it] 18%|█▊        | 40/220 [07:00<30:57, 10.32s/it]                                                 18%|█▊        | 40/220 [07:00<30:57, 10.32s/it] 19%|█▊        | 41/220 [07:11<30:49, 10.33s/it] 19%|█▉        | 42/220 [07:21<30:36, 10.32s/it] 20%|█▉        | 43/220 [07:32<31:02, 10.52s/it] 20%|██        | 44/220 [07:34<23:03,  7.86s/it] 20%|██        | 45/220 [07:44<25:23,  8.70s/it] 21%|██        | 46/220 [07:54<26:12,  9.04s/it] 21%|██▏       | 47/220 [08:04<26:23,  9.15s/it] 22%|██▏       | 48/220 [08:13<26:46,  9.34s/it] 22%|██▏       | 49/220 [08:24<27:57,  9.81s/it] 23%|██▎       | 50/220 [08:35<28:54, 10.21s/it]                                                 23%|██▎       | 50/220 [08:35<28:54, 10.21s/it] 23%|██▎       | 51/220 [08:44<27:50,  9.88s/it] 24%|██▎       | 52/220 [08:55<27:51,  9.95s/it] 24%|██▍       | 53/220 [09:06<28:32, 10.26s/it] 25%|██▍       | 54/220 [09:16<28:22, 10.26s/it] 25%|██▌       | 55/220 [09:27<29:12, 10.62s/it] 25%|██▌       | 56/220 [09:39<29:43, 10.87s/it] 26%|██▌       | 57/220 [09:49<29:07, 10.72s/it] 26%|██▋       | 58/220 [10:00<29:14, 10.83s/it] 27%|██▋       | 59/220 [10:11<29:11, 10.88s/it] 27%|██▋       | 60/220 [10:22<28:50, 10.81s/it]                                                 27%|██▋       | 60/220 [10:22<28:50, 10.81s/it] 28%|██▊       | 61/220 [10:32<28:16, 10.67s/it] 28%|██▊       | 62/220 [10:43<28:15, 10.73s/it] 29%|██▊       | 63/220 [10:54<28:04, 10.73s/it] 29%|██▉       | 64/220 [11:05<28:06, 10.81s/it] 30%|██▉       | 65/220 [11:15<27:15, 10.55s/it] 30%|███       | 66/220 [11:25<26:54, 10.48s/it] 30%|███       | 67/220 [11:35<26:02, 10.22s/it] 31%|███       | 68/220 [11:45<25:41, 10.14s/it] 31%|███▏      | 69/220 [11:55<25:22, 10.09s/it] 32%|███▏      | 70/220 [12:04<24:41,  9.88s/it]                                                 32%|███▏      | 70/220 [12:04<24:41,  9.88s/it] 32%|███▏      | 71/220 [12:14<24:36,  9.91s/it] 33%|███▎      | 72/220 [12:24<24:52, 10.09s/it] 33%|███▎      | 73/220 [12:34<24:33, 10.03s/it] 34%|███▎      | 74/220 [12:44<24:15,  9.97s/it] 34%|███▍      | 75/220 [12:54<24:13, 10.03s/it] 35%|███▍      | 76/220 [13:05<24:14, 10.10s/it] 35%|███▌      | 77/220 [13:15<24:30, 10.29s/it] 35%|███▌      | 78/220 [13:25<23:53, 10.09s/it] 36%|███▌      | 79/220 [13:36<24:21, 10.36s/it] 36%|███▋      | 80/220 [13:46<23:55, 10.26s/it]                                                 36%|███▋      | 80/220 [13:46<23:55, 10.26s/it] 37%|███▋      | 81/220 [13:57<24:07, 10.41s/it] 37%|███▋      | 82/220 [14:07<24:10, 10.51s/it] 38%|███▊      | 83/220 [14:17<23:35, 10.33s/it] 38%|███▊      | 84/220 [14:28<23:28, 10.35s/it] 39%|███▊      | 85/220 [14:38<22:59, 10.21s/it] 39%|███▉      | 86/220 [14:49<23:24, 10.48s/it] 40%|███▉      | 87/220 [14:59<22:57, 10.36s/it] 40%|████      | 88/220 [15:01<17:04,  7.76s/it] 40%|████      | 89/220 [15:10<18:15,  8.36s/it] 41%|████      | 90/220 [15:20<19:04,  8.80s/it]                                                 41%|████      | 90/220 [15:20<19:04,  8.80s/it] 41%|████▏     | 91/220 [15:31<20:18,  9.45s/it] 42%|████▏     | 92/220 [15:41<20:45,  9.73s/it] 42%|████▏     | 93/220 [15:51<20:27,  9.67s/it] 43%|████▎     | 94/220 [16:01<20:33,  9.79s/it] 43%|████▎     | 95/220 [16:11<20:42,  9.94s/it] 44%|████▎     | 96/220 [16:21<20:18,  9.83s/it] 44%|████▍     | 97/220 [16:32<20:44, 10.12s/it] 45%|████▍     | 98/220 [16:42<20:27, 10.06s/it] 45%|████▌     | 99/220 [16:52<20:44, 10.28s/it] 45%|████▌     | 100/220 [17:03<21:00, 10.50s/it]                                                  45%|████▌     | 100/220 [17:03<21:00, 10.50s/it] 46%|████▌     | 101/220 [17:14<20:54, 10.54s/it] 46%|████▋     | 102/220 [17:25<20:53, 10.62s/it] 47%|████▋     | 103/220 [17:36<20:47, 10.66s/it] 47%|████▋     | 104/220 [17:46<20:14, 10.47s/it] 48%|████▊     | 105/220 [17:56<20:09, 10.52s/it] 48%|████▊     | 106/220 [18:07<19:50, 10.44s/it] 49%|████▊     | 107/220 [18:16<19:17, 10.24s/it] 49%|████▉     | 108/220 [18:26<18:51, 10.10s/it] 50%|████▉     | 109/220 [18:37<19:12, 10.38s/it] 50%|█████     | 110/220 [18:48<19:09, 10.45s/it]                                                  50%|█████     | 110/220 [18:48<19:09, 10.45s/it] 50%|█████     | 111/220 [18:58<18:44, 10.32s/it] 51%|█████     | 112/220 [19:08<18:36, 10.34s/it] 51%|█████▏    | 113/220 [19:18<18:15, 10.24s/it] 52%|█████▏    | 114/220 [19:28<18:06, 10.25s/it] 52%|█████▏    | 115/220 [19:39<18:02, 10.31s/it] 53%|█████▎    | 116/220 [19:50<18:02, 10.41s/it] 53%|█████▎    | 117/220 [20:00<18:00, 10.49s/it] 54%|█████▎    | 118/220 [20:10<17:19, 10.20s/it] 54%|█████▍    | 119/220 [20:21<17:31, 10.41s/it] 55%|█████▍    | 120/220 [20:32<17:41, 10.62s/it]                                                  55%|█████▍    | 120/220 [20:36<17:41, 10.62s/it] 55%|█████▌    | 121/220 [20:46<19:31, 11.83s/it] 55%|█████▌    | 122/220 [20:57<18:53, 11.57s/it] 56%|█████▌    | 123/220 [21:08<18:08, 11.22s/it] 56%|█████▋    | 124/220 [21:17<17:10, 10.73s/it] 57%|█████▋    | 125/220 [21:28<17:00, 10.74s/it] 57%|█████▋    | 126/220 [21:40<17:13, 10.99s/it] 58%|█████▊    | 127/220 [21:50<16:41, 10.77s/it] 58%|█████▊    | 128/220 [22:01<16:43, 10.91s/it] 59%|█████▊    | 129/220 [22:12<16:27, 10.85s/it] 59%|█████▉    | 130/220 [22:21<15:41, 10.46s/it]                                                  59%|█████▉    | 130/220 [22:21<15:41, 10.46s/it] 60%|█████▉    | 131/220 [22:31<15:09, 10.21s/it] 60%|██████    | 132/220 [22:33<11:08,  7.60s/it] 60%|██████    | 133/220 [22:44<12:44,  8.79s/it] 61%|██████    | 134/220 [22:54<12:57,  9.04s/it] 61%|██████▏   | 135/220 [23:04<13:08,  9.27s/it] 62%|██████▏   | 136/220 [23:14<13:21,  9.54s/it] 62%|██████▏   | 137/220 [23:24<13:22,  9.67s/it] 63%|██████▎   | 138/220 [23:34<13:32,  9.91s/it] 63%|██████▎   | 139/220 [23:45<13:37, 10.10s/it] 64%|██████▎   | 140/220 [23:55<13:22, 10.04s/it]                                                  64%|██████▎   | 140/220 [23:55<13:22, 10.04s/it] 64%|██████▍   | 141/220 [24:06<13:34, 10.30s/it] 65%|██████▍   | 142/220 [24:16<13:34, 10.44s/it] 65%|██████▌   | 143/220 [24:25<12:50, 10.01s/it] 65%|██████▌   | 144/220 [24:36<12:52, 10.16s/it] 66%|██████▌   | 145/220 [24:46<12:42, 10.17s/it] 66%|██████▋   | 146/220 [24:56<12:34, 10.20s/it] 67%|██████▋   | 147/220 [25:07<12:27, 10.24s/it] 67%|██████▋   | 148/220 [25:18<12:36, 10.50s/it] 68%|██████▊   | 149/220 [25:29<12:37, 10.66s/it] 68%|██████▊   | 150/220 [25:40<12:34, 10.78s/it]                                                  68%|██████▊   | 150/220 [25:40<12:34, 10.78s/it] 69%|██████▊   | 151/220 [25:50<12:04, 10.50s/it] 69%|██████▉   | 152/220 [26:00<11:58, 10.57s/it] 70%|██████▉   | 153/220 [26:10<11:34, 10.37s/it] 70%|███████   | 154/220 [26:21<11:31, 10.48s/it] 70%|███████   | 155/220 [26:32<11:26, 10.57s/it] 71%|███████   | 156/220 [26:42<11:12, 10.51s/it] 71%|███████▏  | 157/220 [26:52<10:42, 10.20s/it] 72%|███████▏  | 158/220 [27:02<10:31, 10.19s/it] 72%|███████▏  | 159/220 [27:12<10:24, 10.24s/it] 73%|███████▎  | 160/220 [27:23<10:21, 10.36s/it]                                                  73%|███████▎  | 160/220 [27:23<10:21, 10.36s/it] 73%|███████▎  | 161/220 [27:33<10:01, 10.19s/it] 74%|███████▎  | 162/220 [27:42<09:45, 10.09s/it] 74%|███████▍  | 163/220 [27:53<09:45, 10.27s/it] 75%|███████▍  | 164/220 [28:04<09:48, 10.51s/it] 75%|███████▌  | 165/220 [28:14<09:24, 10.27s/it] 75%|███████▌  | 166/220 [28:25<09:21, 10.40s/it] 76%|███████▌  | 167/220 [28:35<09:09, 10.36s/it] 76%|███████▋  | 168/220 [28:45<08:59, 10.37s/it] 77%|███████▋  | 169/220 [28:56<09:00, 10.60s/it] 77%|███████▋  | 170/220 [29:08<08:58, 10.77s/it]                                                  77%|███████▋  | 170/220 [29:08<08:58, 10.77s/it] 78%|███████▊  | 171/220 [29:17<08:25, 10.31s/it] 78%|███████▊  | 172/220 [29:27<08:13, 10.28s/it] 79%|███████▊  | 173/220 [29:37<08:03, 10.28s/it] 79%|███████▉  | 174/220 [29:48<08:03, 10.52s/it] 80%|███████▉  | 175/220 [29:59<07:54, 10.55s/it] 80%|████████  | 176/220 [30:01<05:46,  7.88s/it] 80%|████████  | 177/220 [30:12<06:20,  8.84s/it] 81%|████████  | 178/220 [30:22<06:30,  9.30s/it] 81%|████████▏ | 179/220 [30:33<06:38,  9.72s/it] 82%|████████▏ | 180/220 [30:44<06:45, 10.14s/it]                                                  82%|████████▏ | 180/220 [30:44<06:45, 10.14s/it] 82%|████████▏ | 181/220 [30:55<06:42, 10.31s/it] 83%|████████▎ | 182/220 [31:05<06:33, 10.34s/it] 83%|████████▎ | 183/220 [31:15<06:15, 10.14s/it] 84%|████████▎ | 184/220 [31:24<05:56,  9.90s/it] 84%|████████▍ | 185/220 [31:33<05:33,  9.53s/it] 85%|████████▍ | 186/220 [31:43<05:33,  9.81s/it] 85%|████████▌ | 187/220 [31:54<05:29,  9.98s/it] 85%|████████▌ | 188/220 [32:04<05:22, 10.07s/it] 86%|████████▌ | 189/220 [32:15<05:21, 10.37s/it] 86%|████████▋ | 190/220 [32:24<05:02, 10.07s/it]                                                  86%|████████▋ | 190/220 [32:24<05:02, 10.07s/it] 87%|████████▋ | 191/220 [32:36<05:04, 10.49s/it] 87%|████████▋ | 192/220 [32:47<04:57, 10.64s/it] 88%|████████▊ | 193/220 [32:57<04:44, 10.54s/it] 88%|████████▊ | 194/220 [33:07<04:30, 10.40s/it] 89%|████████▊ | 195/220 [33:18<04:24, 10.56s/it] 89%|████████▉ | 196/220 [33:28<04:07, 10.29s/it] 90%|████████▉ | 197/220 [33:38<03:57, 10.31s/it] 90%|█████████ | 198/220 [33:49<03:51, 10.52s/it] 90%|█████████ | 199/220 [34:00<03:42, 10.58s/it] 91%|█████████ | 200/220 [34:09<03:24, 10.24s/it]                                                  91%|█████████ | 200/220 [34:09<03:24, 10.24s/it] 91%|█████████▏| 201/220 [34:20<03:16, 10.36s/it] 92%|█████████▏| 202/220 [34:30<03:06, 10.38s/it] 92%|█████████▏| 203/220 [34:41<02:58, 10.47s/it] 93%|█████████▎| 204/220 [34:50<02:42, 10.16s/it] 93%|█████████▎| 205/220 [35:00<02:31, 10.08s/it] 94%|█████████▎| 206/220 [35:12<02:26, 10.47s/it] 94%|█████████▍| 207/220 [35:23<02:18, 10.68s/it] 95%|█████████▍| 208/220 [35:33<02:07, 10.62s/it] 95%|█████████▌| 209/220 [35:43<01:53, 10.35s/it] 95%|█████████▌| 210/220 [35:52<01:39,  9.96s/it]                                                  95%|█████████▌| 210/220 [35:52<01:39,  9.96s/it] 96%|█████████▌| 211/220 [36:02<01:30, 10.07s/it] 96%|█████████▋| 212/220 [36:13<01:20, 10.10s/it] 97%|█████████▋| 213/220 [36:23<01:11, 10.18s/it] 97%|█████████▋| 214/220 [36:34<01:03, 10.52s/it] 98%|█████████▊| 215/220 [36:44<00:51, 10.24s/it] 98%|█████████▊| 216/220 [36:54<00:41, 10.28s/it] 99%|█████████▊| 217/220 [37:05<00:31, 10.54s/it] 99%|█████████▉| 218/220 [37:16<00:21, 10.64s/it]100%|█████████▉| 219/220 [37:26<00:10, 10.41s/it]100%|██████████| 220/220 [37:28<00:00,  7.80s/it]                                                 100%|██████████| 220/220 [37:28<00:00,  7.80s/it]                                                 100%|██████████| 220/220 [37:28<00:00,  7.80s/it]100%|██████████| 220/220 [37:28<00:00, 10.22s/it]
Using EarlyStoppingCallback without load_best_model_at_end=True. Once training is finished, the best model will not be loaded automatically.
Traceback (most recent call last):
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/nanonets/multi/ms_stair_eval_cer.py", line 1093, in <module>
    main()
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/nanonets/multi/ms_stair_eval_cer.py", line 1014, in main
    trainer, cer_callback = finetuner.train_model(
                            ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/nanonets/multi/ms_stair_eval_cer.py", line 681, in train_model
    trainer_stats = trainer_stage2.train()
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/nanonets/multi/unsloth_compiled_cache/UnslothSFTTrainer.py", line 53, in wrapper
    output = f(self, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/nanonets/lib/python3.11/site-packages/transformers/trainer.py", line 2328, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/nanonets/lib/python3.11/site-packages/transformers/trainer.py", line 2578, in _inner_training_loop
    self.control = self.callback_handler.on_train_begin(args, self.state, self.control)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/nanonets/lib/python3.11/site-packages/transformers/trainer_callback.py", line 506, in on_train_begin
    return self.call_event("on_train_begin", args, state, control)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/nanonets/lib/python3.11/site-packages/transformers/trainer_callback.py", line 556, in call_event
    result = getattr(callback, event)(
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/nanonets/lib/python3.11/site-packages/transformers/trainer_callback.py", line 752, in on_train_begin
    assert args.metric_for_best_model is not None, (
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: EarlyStoppingCallback requires metric_for_best_model to be defined
