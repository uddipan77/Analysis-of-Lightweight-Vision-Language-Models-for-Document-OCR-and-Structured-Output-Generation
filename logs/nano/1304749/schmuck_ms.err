Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:50<00:50, 50.36s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:17<00:00, 36.59s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:17<00:00, 38.65s/it]
The image processor of type `Qwen2VLImageProcessor` is now loaded as a fast processor by default, even if the model checkpoint was saved with a slow processor. This is a breaking change and may produce slightly different outputs. To continue using the slow processor, instantiate this class with `use_fast=False`. Note that this behavior will be extended to all models in a future release.
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'bos_token_id': None}.
  0%|          | 0/156 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
  1%|          | 1/156 [00:12<32:44, 12.67s/it]  1%|▏         | 2/156 [00:22<28:58, 11.29s/it]  2%|▏         | 3/156 [00:32<26:59, 10.59s/it]  3%|▎         | 4/156 [00:42<25:56, 10.24s/it]  3%|▎         | 5/156 [00:52<25:37, 10.18s/it]  4%|▍         | 6/156 [01:02<25:04, 10.03s/it]  4%|▍         | 7/156 [01:12<24:56, 10.04s/it]  5%|▌         | 8/156 [01:22<24:44, 10.03s/it]  6%|▌         | 9/156 [01:32<24:23,  9.96s/it]  6%|▋         | 10/156 [01:42<24:14,  9.96s/it]                                                  6%|▋         | 10/156 [01:42<24:14,  9.96s/it]  7%|▋         | 11/156 [01:52<24:08,  9.99s/it]  8%|▊         | 12/156 [02:02<23:54,  9.96s/it]  8%|▊         | 13/156 [02:12<23:46,  9.97s/it]  9%|▉         | 14/156 [02:21<23:19,  9.86s/it] 10%|▉         | 15/156 [02:31<23:28,  9.99s/it] 10%|█         | 16/156 [02:42<23:21, 10.01s/it] 11%|█         | 17/156 [02:52<23:28, 10.14s/it] 12%|█▏        | 18/156 [03:02<23:21, 10.15s/it] 12%|█▏        | 19/156 [03:13<23:39, 10.36s/it] 13%|█▎        | 20/156 [03:24<23:37, 10.43s/it]                                                 13%|█▎        | 20/156 [03:24<23:37, 10.43s/it] 13%|█▎        | 21/156 [03:34<23:41, 10.53s/it] 14%|█▍        | 22/156 [03:45<23:25, 10.49s/it] 15%|█▍        | 23/156 [03:56<23:34, 10.64s/it] 15%|█▌        | 24/156 [04:07<23:48, 10.82s/it] 16%|█▌        | 25/156 [04:17<23:19, 10.68s/it] 17%|█▋        | 26/156 [04:28<22:51, 10.55s/it] 17%|█▋        | 27/156 [04:38<22:42, 10.56s/it] 18%|█▊        | 28/156 [04:49<22:32, 10.56s/it] 19%|█▊        | 29/156 [05:00<22:51, 10.80s/it] 19%|█▉        | 30/156 [05:10<22:23, 10.66s/it]                                                 19%|█▉        | 30/156 [05:10<22:23, 10.66s/it] 20%|█▉        | 31/156 [05:21<22:04, 10.60s/it] 21%|██        | 32/156 [05:31<21:42, 10.50s/it] 21%|██        | 33/156 [05:42<21:29, 10.48s/it] 22%|██▏       | 34/156 [05:52<21:22, 10.51s/it] 22%|██▏       | 35/156 [06:02<21:03, 10.44s/it] 23%|██▎       | 36/156 [06:12<20:32, 10.27s/it] 24%|██▎       | 37/156 [06:22<20:00, 10.09s/it] 24%|██▍       | 38/156 [06:32<19:43, 10.03s/it] 25%|██▌       | 39/156 [06:41<19:19,  9.91s/it] 26%|██▌       | 40/156 [06:51<19:06,  9.88s/it]                                                 26%|██▌       | 40/156 [06:51<19:06,  9.88s/it] 26%|██▋       | 41/156 [07:01<19:07,  9.98s/it] 27%|██▋       | 42/156 [07:11<18:57,  9.97s/it] 28%|██▊       | 43/156 [07:21<18:48,  9.98s/it] 28%|██▊       | 44/156 [07:31<18:30,  9.92s/it] 29%|██▉       | 45/156 [07:41<18:21,  9.92s/it] 29%|██▉       | 46/156 [07:52<18:28, 10.08s/it] 30%|███       | 47/156 [08:01<18:11, 10.01s/it] 31%|███       | 48/156 [08:11<17:53,  9.94s/it] 31%|███▏      | 49/156 [08:21<17:44,  9.95s/it] 32%|███▏      | 50/156 [08:31<17:39, 10.00s/it]                                                 32%|███▏      | 50/156 [08:31<17:39, 10.00s/it] 33%|███▎      | 51/156 [08:42<17:41, 10.11s/it] 33%|███▎      | 52/156 [08:48<15:22,  8.87s/it] 34%|███▍      | 53/156 [08:58<15:53,  9.26s/it] 35%|███▍      | 54/156 [09:08<16:14,  9.55s/it] 35%|███▌      | 55/156 [09:18<16:08,  9.59s/it] 36%|███▌      | 56/156 [09:28<16:16,  9.76s/it] 37%|███▋      | 57/156 [09:38<16:05,  9.75s/it] 37%|███▋      | 58/156 [09:48<16:02,  9.83s/it] 38%|███▊      | 59/156 [09:58<15:55,  9.85s/it] 38%|███▊      | 60/156 [10:07<15:48,  9.88s/it]                                                 38%|███▊      | 60/156 [10:07<15:48,  9.88s/it] 39%|███▉      | 61/156 [10:17<15:37,  9.87s/it] 40%|███▉      | 62/156 [10:27<15:24,  9.83s/it] 40%|████      | 63/156 [10:37<15:17,  9.87s/it] 41%|████      | 64/156 [10:47<15:03,  9.82s/it] 42%|████▏     | 65/156 [10:57<14:58,  9.87s/it] 42%|████▏     | 66/156 [11:07<14:54,  9.94s/it] 43%|████▎     | 67/156 [11:17<14:40,  9.89s/it] 44%|████▎     | 68/156 [11:27<14:35,  9.95s/it] 44%|████▍     | 69/156 [11:37<14:27,  9.97s/it] 45%|████▍     | 70/156 [11:46<14:08,  9.87s/it]                                                 45%|████▍     | 70/156 [11:46<14:08,  9.87s/it] 46%|████▌     | 71/156 [11:56<14:05,  9.95s/it] 46%|████▌     | 72/156 [12:06<13:55,  9.94s/it] 47%|████▋     | 73/156 [12:16<13:38,  9.86s/it] 47%|████▋     | 74/156 [12:26<13:34,  9.93s/it] 48%|████▊     | 75/156 [12:36<13:20,  9.89s/it] 49%|████▊     | 76/156 [12:46<13:13,  9.92s/it] 49%|████▉     | 77/156 [12:56<13:07,  9.97s/it] 50%|█████     | 78/156 [13:06<13:01, 10.02s/it] 51%|█████     | 79/156 [13:16<12:45,  9.94s/it] 51%|█████▏    | 80/156 [13:26<12:40, 10.01s/it]                                                 51%|█████▏    | 80/156 [13:26<12:40, 10.01s/it] 52%|█████▏    | 81/156 [13:36<12:25,  9.94s/it] 53%|█████▎    | 82/156 [13:46<12:15,  9.94s/it] 53%|█████▎    | 83/156 [13:56<12:11, 10.02s/it] 54%|█████▍    | 84/156 [14:06<11:59,  9.99s/it] 54%|█████▍    | 85/156 [14:16<11:46,  9.95s/it] 55%|█████▌    | 86/156 [14:26<11:37,  9.97s/it] 56%|█████▌    | 87/156 [14:36<11:31, 10.03s/it] 56%|█████▋    | 88/156 [14:46<11:15,  9.94s/it] 57%|█████▋    | 89/156 [14:56<11:03,  9.91s/it] 58%|█████▊    | 90/156 [15:06<10:58,  9.98s/it]                                                 58%|█████▊    | 90/156 [15:06<10:58,  9.98s/it] 58%|█████▊    | 91/156 [15:16<10:47,  9.96s/it] 59%|█████▉    | 92/156 [15:26<10:40, 10.00s/it] 60%|█████▉    | 93/156 [15:36<10:36, 10.10s/it] 60%|██████    | 94/156 [15:46<10:20, 10.01s/it] 61%|██████    | 95/156 [15:56<10:07,  9.96s/it] 62%|██████▏   | 96/156 [16:05<09:54,  9.91s/it] 62%|██████▏   | 97/156 [16:15<09:45,  9.93s/it] 63%|██████▎   | 98/156 [16:26<09:39, 10.00s/it] 63%|██████▎   | 99/156 [16:35<09:27,  9.96s/it] 64%|██████▍   | 100/156 [16:46<09:24, 10.08s/it]                                                  64%|██████▍   | 100/156 [16:46<09:24, 10.08s/it] 65%|██████▍   | 101/156 [16:56<09:12, 10.04s/it] 65%|██████▌   | 102/156 [17:06<09:00, 10.01s/it] 66%|██████▌   | 103/156 [17:16<08:51, 10.03s/it] 67%|██████▋   | 104/156 [17:22<07:38,  8.83s/it] 67%|██████▋   | 105/156 [17:32<07:46,  9.14s/it] 68%|██████▊   | 106/156 [17:42<07:47,  9.35s/it] 69%|██████▊   | 107/156 [17:52<07:50,  9.60s/it] 69%|██████▉   | 108/156 [18:02<07:48,  9.77s/it] 70%|██████▉   | 109/156 [18:12<07:43,  9.86s/it] 71%|███████   | 110/156 [18:22<07:34,  9.88s/it]                                                  71%|███████   | 110/156 [18:22<07:34,  9.88s/it] 71%|███████   | 111/156 [18:32<07:25,  9.90s/it] 72%|███████▏  | 112/156 [18:42<07:14,  9.87s/it] 72%|███████▏  | 113/156 [18:51<07:04,  9.87s/it] 73%|███████▎  | 114/156 [19:01<06:53,  9.84s/it] 74%|███████▎  | 115/156 [19:11<06:44,  9.86s/it] 74%|███████▍  | 116/156 [19:22<06:41, 10.05s/it] 75%|███████▌  | 117/156 [19:32<06:33, 10.08s/it] 76%|███████▌  | 118/156 [19:42<06:19,  9.99s/it] 76%|███████▋  | 119/156 [19:52<06:11, 10.05s/it] 77%|███████▋  | 120/156 [20:02<06:03, 10.09s/it]                                                  77%|███████▋  | 120/156 [20:02<06:03, 10.09s/it] 78%|███████▊  | 121/156 [20:12<05:52, 10.06s/it] 78%|███████▊  | 122/156 [20:22<05:39, 10.00s/it] 79%|███████▉  | 123/156 [20:32<05:29,  9.98s/it] 79%|███████▉  | 124/156 [20:41<05:17,  9.91s/it] 80%|████████  | 125/156 [20:51<05:06,  9.88s/it] 81%|████████  | 126/156 [21:01<04:56,  9.87s/it] 81%|████████▏ | 127/156 [21:11<04:48,  9.95s/it] 82%|████████▏ | 128/156 [21:21<04:37,  9.90s/it] 83%|████████▎ | 129/156 [21:31<04:26,  9.86s/it] 83%|████████▎ | 130/156 [21:41<04:19,  9.97s/it]                                                  83%|████████▎ | 130/156 [21:41<04:19,  9.97s/it] 84%|████████▍ | 131/156 [21:51<04:09,  9.96s/it] 85%|████████▍ | 132/156 [22:01<03:59,  9.99s/it] 85%|████████▌ | 133/156 [22:11<03:47,  9.91s/it] 86%|████████▌ | 134/156 [22:21<03:36,  9.86s/it] 87%|████████▋ | 135/156 [22:30<03:26,  9.83s/it] 87%|████████▋ | 136/156 [22:40<03:17,  9.85s/it] 88%|████████▊ | 137/156 [22:50<03:08,  9.94s/it] 88%|████████▊ | 138/156 [23:00<02:59,  9.99s/it] 89%|████████▉ | 139/156 [23:10<02:49,  9.98s/it] 90%|████████▉ | 140/156 [23:20<02:39,  9.98s/it]                                                  90%|████████▉ | 140/156 [23:20<02:39,  9.98s/it] 90%|█████████ | 141/156 [23:30<02:28,  9.90s/it] 91%|█████████ | 142/156 [23:40<02:18,  9.91s/it] 92%|█████████▏| 143/156 [23:50<02:08,  9.90s/it] 92%|█████████▏| 144/156 [24:00<01:59,  9.95s/it] 93%|█████████▎| 145/156 [24:10<01:50, 10.02s/it] 94%|█████████▎| 146/156 [24:20<01:39, 10.00s/it] 94%|█████████▍| 147/156 [24:30<01:30, 10.04s/it] 95%|█████████▍| 148/156 [24:40<01:20, 10.07s/it] 96%|█████████▌| 149/156 [24:50<01:10, 10.08s/it] 96%|█████████▌| 150/156 [25:00<01:00, 10.02s/it]                                                  96%|█████████▌| 150/156 [25:00<01:00, 10.02s/it] 97%|█████████▋| 151/156 [25:10<00:50, 10.01s/it] 97%|█████████▋| 152/156 [25:20<00:39,  9.92s/it] 98%|█████████▊| 153/156 [25:30<00:29,  9.91s/it] 99%|█████████▊| 154/156 [25:40<00:19,  9.93s/it] 99%|█████████▉| 155/156 [25:50<00:09,  9.86s/it]100%|██████████| 156/156 [25:56<00:00,  8.71s/it]                                                 100%|██████████| 156/156 [25:56<00:00,  8.71s/it]100%|██████████| 156/156 [25:56<00:00,  9.98s/it]
Traceback (most recent call last):
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/nanonets/multi/schmuck_ms.py", line 757, in <module>
    main()
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/nanonets/multi/schmuck_ms.py", line 716, in main
    trainer = finetuner.train_model(
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/nanonets/multi/schmuck_ms.py", line 427, in train_model
    trainer_stage2 = SFTTrainer(
                     ^^^^^^^^^^^
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/nanonets/lib/python3.11/site-packages/unsloth/trainer.py", line 209, in new_init
    original_init(self, *args, **kwargs)
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/nanonets/multi/unsloth_compiled_cache/UnslothSFTTrainer.py", line 1172, in __init__
    super().__init__(
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/nanonets/lib/python3.11/site-packages/transformers/utils/deprecation.py", line 172, in wrapped_func
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/nanonets/multi/unsloth_compiled_cache/UnslothSFTTrainer.py", line 599, in __init__
    super().__init__(
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/nanonets/lib/python3.11/site-packages/transformers/utils/deprecation.py", line 172, in wrapped_func
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/woody/iwi5/iwi5298h/software/private/conda/envs/nanonets/lib/python3.11/site-packages/transformers/trainer.py", line 442, in __init__
    raise ValueError(
ValueError: When using `batch_eval_metrics`, your `compute_metrics` function must take a `compute_result` boolean argument which will be triggered after the last batch of the eval set to signal that the summary statistics should be returned by the function.
