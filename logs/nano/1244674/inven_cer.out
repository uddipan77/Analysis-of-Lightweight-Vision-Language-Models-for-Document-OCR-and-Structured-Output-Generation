### Starting TaskPrologue of job 1244674 on tg080 at Tue Oct 21 02:47:49 PM CEST 2025
Running on cores 4-5,20-21,36-37,52-53 with governor powersave
Tue Oct 21 14:47:50 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 580.95.05              Driver Version: 580.95.05      CUDA Version: 13.0     |
+-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 3080        On  |   00000000:3D:00.0 Off |                  N/A |
| 30%   34C    P8             20W /  300W |       1MiB /  10240MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
### Finished TaskPrologue

ðŸ¦¥ Unsloth: Will patch your computer to enable 2x faster free finetuning.
ðŸ¦¥ Unsloth Zoo will now patch everything to make training faster!

============================================================
NANONETS-OCR-S FINETUNING - INVENTORY DATASET
CER-BASED MODEL SELECTION
============================================================
Model: /home/vault/iwi5/iwi5298h/models/Nanonets-OCR-s
Output: /home/vault/iwi5/iwi5298h/models_image_text/nanonets/inven/run_20251021_144811_unsloth_cer
Augmentation: 1x
============================================================

============================================================
LOADING NANONETS-OCR-S WITH UNSLOTH FOR INVENTORY DATASET
============================================================
Model path: /home/vault/iwi5/iwi5298h/models/Nanonets-OCR-s
Augmentation factor: 1
Created temporary directory: /tmp/1244674.tinygpu/augmented_inventory_xtjd_5ys
âœ“ Model directory verified
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.10.7: Fast Qwen2_5_Vl patching. Transformers: 4.56.2.
   \\   /|    NVIDIA GeForce RTX 3080. Num GPUs = 1. Max memory: 9.644 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.8.0+cu128. CUDA: 8.6. CUDA Toolkit: 12.8. Triton: 3.4.0
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.32.post2. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Qwen2_5_Vl does not support SDPA - switching to fast eager.

âœ… Model loaded successfully!
Applying LoRA adaptors...
Unsloth: Making `model.base_model.model.model` require gradients
âœ… LoRA applied successfully!
============================================================


============================================================
PHASE 1: TRAINING WITH CER-BASED MODEL SELECTION
============================================================

Preparing datasets...
Preparing training data with augmentation factor: 1
Creating augmentation 1/1 for image 1/213: inventarbuch-265.jpg
Creating augmentation 1/1 for image 2/213: inventarbuch-189.jpg
Creating augmentation 1/1 for image 3/213: inventarbuch-026.jpg
Creating augmentation 1/1 for image 4/213: inventarbuch-021.jpg
Creating augmentation 1/1 for image 5/213: inventarbuch-281.jpg
Creating augmentation 1/1 for image 6/213: inventarbuch-167.jpg
Creating augmentation 1/1 for image 7/213: inventarbuch-280.jpg
Creating augmentation 1/1 for image 8/213: inventarbuch-057.jpg
Creating augmentation 1/1 for image 9/213: inventarbuch-159.jpg
Creating augmentation 1/1 for image 10/213: inventarbuch-094.jpg
Creating augmentation 1/1 for image 11/213: inventarbuch-040.jpg
Creating augmentation 1/1 for image 12/213: inventarbuch-305.jpg
Creating augmentation 1/1 for image 13/213: inventarbuch-220.jpg
Creating augmentation 1/1 for image 14/213: inventarbuch-226.jpg
Creating augmentation 1/1 for image 15/213: inventarbuch-264.jpg
Creating augmentation 1/1 for image 16/213: inventarbuch-089.jpg
Creating augmentation 1/1 for image 17/213: inventarbuch-002.jpg
Creating augmentation 1/1 for image 18/213: inventarbuch-290.jpg
Creating augmentation 1/1 for image 19/213: inventarbuch-109.jpg
Creating augmentation 1/1 for image 20/213: inventarbuch-144.jpg
Creating augmentation 1/1 for image 21/213: inventarbuch-075.jpg
Creating augmentation 1/1 for image 22/213: inventarbuch-239.jpg
Creating augmentation 1/1 for image 23/213: inventarbuch-145.jpg
Creating augmentation 1/1 for image 24/213: inventarbuch-091.jpg
Creating augmentation 1/1 for image 25/213: inventarbuch-007.jpg
Creating augmentation 1/1 for image 26/213: inventarbuch-285.jpg
Creating augmentation 1/1 for image 27/213: inventarbuch-247.jpg
Creating augmentation 1/1 for image 28/213: inventarbuch-117.jpg
Creating augmentation 1/1 for image 29/213: inventarbuch-288.jpg
Creating augmentation 1/1 for image 30/213: inventarbuch-050.jpg
Creating augmentation 1/1 for image 31/213: inventarbuch-063.jpg
Creating augmentation 1/1 for image 32/213: inventarbuch-249.jpg
Creating augmentation 1/1 for image 33/213: inventarbuch-204.jpg
Creating augmentation 1/1 for image 34/213: inventarbuch-172.jpg
Creating augmentation 1/1 for image 35/213: inventarbuch-088.jpg
Creating augmentation 1/1 for image 36/213: inventarbuch-039.jpg
Creating augmentation 1/1 for image 37/213: inventarbuch-300.jpg
Creating augmentation 1/1 for image 38/213: inventarbuch-286.jpg
Creating augmentation 1/1 for image 39/213: inventarbuch-192.jpg
Creating augmentation 1/1 for image 40/213: inventarbuch-085.jpg
Creating augmentation 1/1 for image 41/213: inventarbuch-241.jpg
Creating augmentation 1/1 for image 42/213: inventarbuch-270.jpg
Creating augmentation 1/1 for image 43/213: inventarbuch-180.jpg
Creating augmentation 1/1 for image 44/213: inventarbuch-202.jpg
Creating augmentation 1/1 for image 45/213: inventarbuch-140.jpg
Creating augmentation 1/1 for image 46/213: inventarbuch-008.jpg
Creating augmentation 1/1 for image 47/213: inventarbuch-258.jpg
Creating augmentation 1/1 for image 48/213: inventarbuch-028.jpg
Creating augmentation 1/1 for image 49/213: inventarbuch-209.jpg
Creating augmentation 1/1 for image 50/213: inventarbuch-228.jpg
Creating augmentation 1/1 for image 51/213: inventarbuch-306.jpg
Creating augmentation 1/1 for image 52/213: inventarbuch-277.jpg
Creating augmentation 1/1 for image 53/213: inventarbuch-184.jpg
Creating augmentation 1/1 for image 54/213: inventarbuch-289.jpg
Creating augmentation 1/1 for image 55/213: inventarbuch-067.jpg
Creating augmentation 1/1 for image 56/213: inventarbuch-036.jpg
Creating augmentation 1/1 for image 57/213: inventarbuch-292.jpg
Creating augmentation 1/1 for image 58/213: inventarbuch-092.jpg
Creating augmentation 1/1 for image 59/213: inventarbuch-231.jpg
Creating augmentation 1/1 for image 60/213: inventarbuch-246.jpg
Creating augmentation 1/1 for image 61/213: inventarbuch-081.jpg
Creating augmentation 1/1 for image 62/213: inventarbuch-034.jpg
Creating augmentation 1/1 for image 63/213: inventarbuch-175.jpg
Creating augmentation 1/1 for image 64/213: inventarbuch-044.jpg
Creating augmentation 1/1 for image 65/213: inventarbuch-006.jpg
Creating augmentation 1/1 for image 66/213: inventarbuch-154.jpg
Creating augmentation 1/1 for image 67/213: inventarbuch-234.jpg
Creating augmentation 1/1 for image 68/213: inventarbuch-111.jpg
Creating augmentation 1/1 for image 69/213: inventarbuch-011.jpg
Creating augmentation 1/1 for image 70/213: inventarbuch-126.jpg
Creating augmentation 1/1 for image 71/213: inventarbuch-157.jpg
Creating augmentation 1/1 for image 72/213: inventarbuch-152.jpg
Creating augmentation 1/1 for image 73/213: inventarbuch-190.jpg
Creating augmentation 1/1 for image 74/213: inventarbuch-304.jpg
Creating augmentation 1/1 for image 75/213: inventarbuch-217.jpg
Creating augmentation 1/1 for image 76/213: inventarbuch-103.jpg
Creating augmentation 1/1 for image 77/213: inventarbuch-207.jpg
Creating augmentation 1/1 for image 78/213: inventarbuch-267.jpg
Creating augmentation 1/1 for image 79/213: inventarbuch-297.jpg
Creating augmentation 1/1 for image 80/213: inventarbuch-308.jpg
Creating augmentation 1/1 for image 81/213: inventarbuch-068.jpg
Creating augmentation 1/1 for image 82/213: inventarbuch-259.jpg
Creating augmentation 1/1 for image 83/213: inventarbuch-276.jpg
Creating augmentation 1/1 for image 84/213: inventarbuch-053.jpg
Creating augmentation 1/1 for image 85/213: inventarbuch-269.jpg
Creating augmentation 1/1 for image 86/213: inventarbuch-236.jpg
Creating augmentation 1/1 for image 87/213: inventarbuch-129.jpg
Creating augmentation 1/1 for image 88/213: inventarbuch-138.jpg
Creating augmentation 1/1 for image 89/213: inventarbuch-193.jpg
Creating augmentation 1/1 for image 90/213: inventarbuch-080.jpg
Creating augmentation 1/1 for image 91/213: inventarbuch-125.jpg
Creating augmentation 1/1 for image 92/213: inventarbuch-035.jpg
Creating augmentation 1/1 for image 93/213: inventarbuch-023.jpg
Creating augmentation 1/1 for image 94/213: inventarbuch-072.jpg
Creating augmentation 1/1 for image 95/213: inventarbuch-062.jpg
Creating augmentation 1/1 for image 96/213: inventarbuch-087.jpg
Creating augmentation 1/1 for image 97/213: inventarbuch-128.jpg
Creating augmentation 1/1 for image 98/213: inventarbuch-160.jpg
Creating augmentation 1/1 for image 99/213: inventarbuch-150.jpg
Creating augmentation 1/1 for image 100/213: inventarbuch-218.jpg
Creating augmentation 1/1 for image 101/213: inventarbuch-201.jpg
Creating augmentation 1/1 for image 102/213: inventarbuch-119.jpg
Creating augmentation 1/1 for image 103/213: inventarbuch-237.jpg
Creating augmentation 1/1 for image 104/213: inventarbuch-108.jpg
Creating augmentation 1/1 for image 105/213: inventarbuch-012.jpg
Creating augmentation 1/1 for image 106/213: inventarbuch-074.jpg
Creating augmentation 1/1 for image 107/213: inventarbuch-162.jpg
Creating augmentation 1/1 for image 108/213: inventarbuch-009.jpg
Creating augmentation 1/1 for image 109/213: inventarbuch-032.jpg
Creating augmentation 1/1 for image 110/213: inventarbuch-156.jpg
Creating augmentation 1/1 for image 111/213: inventarbuch-106.jpg
Creating augmentation 1/1 for image 112/213: inventarbuch-110.jpg
Creating augmentation 1/1 for image 113/213: inventarbuch-048.jpg
Creating augmentation 1/1 for image 114/213: inventarbuch-275.jpg
Creating augmentation 1/1 for image 115/213: inventarbuch-250.jpg
Creating augmentation 1/1 for image 116/213: inventarbuch-214.jpg
Creating augmentation 1/1 for image 117/213: inventarbuch-213.jpg
Creating augmentation 1/1 for image 118/213: inventarbuch-137.jpg
Creating augmentation 1/1 for image 119/213: inventarbuch-215.jpg
Creating augmentation 1/1 for image 120/213: inventarbuch-186.jpg
Creating augmentation 1/1 for image 121/213: inventarbuch-216.jpg
Creating augmentation 1/1 for image 122/213: inventarbuch-212.jpg
Creating augmentation 1/1 for image 123/213: inventarbuch-102.jpg
Creating augmentation 1/1 for image 124/213: inventarbuch-127.jpg
Creating augmentation 1/1 for image 125/213: inventarbuch-210.jpg
Creating augmentation 1/1 for image 126/213: inventarbuch-240.jpg
Creating augmentation 1/1 for image 127/213: inventarbuch-219.jpg
Creating augmentation 1/1 for image 128/213: inventarbuch-098.jpg
Creating augmentation 1/1 for image 129/213: inventarbuch-257.jpg
Creating augmentation 1/1 for image 130/213: inventarbuch-052.jpg
Creating augmentation 1/1 for image 131/213: inventarbuch-139.jpg
Creating augmentation 1/1 for image 132/213: inventarbuch-079.jpg
Creating augmentation 1/1 for image 133/213: inventarbuch-029.jpg
Creating augmentation 1/1 for image 134/213: inventarbuch-135.jpg
Creating augmentation 1/1 for image 135/213: inventarbuch-047.jpg
Creating augmentation 1/1 for image 136/213: inventarbuch-133.jpg
Creating augmentation 1/1 for image 137/213: inventarbuch-284.jpg
Creating augmentation 1/1 for image 138/213: inventarbuch-001.jpg
Creating augmentation 1/1 for image 139/213: inventarbuch-233.jpg
Creating augmentation 1/1 for image 140/213: inventarbuch-163.jpg
Creating augmentation 1/1 for image 141/213: inventarbuch-295.jpg
Creating augmentation 1/1 for image 142/213: inventarbuch-261.jpg
Creating augmentation 1/1 for image 143/213: inventarbuch-165.jpg
Creating augmentation 1/1 for image 144/213: inventarbuch-090.jpg
Creating augmentation 1/1 for image 145/213: inventarbuch-198.jpg
Creating augmentation 1/1 for image 146/213: inventarbuch-278.jpg
Creating augmentation 1/1 for image 147/213: inventarbuch-031.jpg
Creating augmentation 1/1 for image 148/213: inventarbuch-003.jpg
Creating augmentation 1/1 for image 149/213: inventarbuch-262.jpg
Creating augmentation 1/1 for image 150/213: inventarbuch-066.jpg
Creating augmentation 1/1 for image 151/213: inventarbuch-271.jpg
Creating augmentation 1/1 for image 152/213: inventarbuch-301.jpg
Creating augmentation 1/1 for image 153/213: inventarbuch-211.jpg
Creating augmentation 1/1 for image 154/213: inventarbuch-101.jpg
Creating augmentation 1/1 for image 155/213: inventarbuch-196.jpg
Creating augmentation 1/1 for image 156/213: inventarbuch-158.jpg
Creating augmentation 1/1 for image 157/213: inventarbuch-112.jpg
Creating augmentation 1/1 for image 158/213: inventarbuch-042.jpg
Creating augmentation 1/1 for image 159/213: inventarbuch-041.jpg
Creating augmentation 1/1 for image 160/213: inventarbuch-030.jpg
Creating augmentation 1/1 for image 161/213: inventarbuch-307.jpg
Creating augmentation 1/1 for image 162/213: inventarbuch-025.jpg
Creating augmentation 1/1 for image 163/213: inventarbuch-131.jpg
Creating augmentation 1/1 for image 164/213: inventarbuch-136.jpg
Creating augmentation 1/1 for image 165/213: inventarbuch-205.jpg
Creating augmentation 1/1 for image 166/213: inventarbuch-242.jpg
Creating augmentation 1/1 for image 167/213: inventarbuch-251.jpg
Creating augmentation 1/1 for image 168/213: inventarbuch-199.jpg
Creating augmentation 1/1 for image 169/213: inventarbuch-177.jpg
Creating augmentation 1/1 for image 170/213: inventarbuch-113.jpg
Creating augmentation 1/1 for image 171/213: inventarbuch-155.jpg
Creating augmentation 1/1 for image 172/213: inventarbuch-208.jpg
Creating augmentation 1/1 for image 173/213: inventarbuch-268.jpg
Creating augmentation 1/1 for image 174/213: inventarbuch-149.jpg
Creating augmentation 1/1 for image 175/213: inventarbuch-065.jpg
Creating augmentation 1/1 for image 176/213: inventarbuch-037.jpg
Creating augmentation 1/1 for image 177/213: inventarbuch-069.jpg
Creating augmentation 1/1 for image 178/213: inventarbuch-038.jpg
Creating augmentation 1/1 for image 179/213: inventarbuch-122.jpg
Creating augmentation 1/1 for image 180/213: inventarbuch-170.jpg
Creating augmentation 1/1 for image 181/213: inventarbuch-291.jpg
Creating augmentation 1/1 for image 182/213: inventarbuch-132.jpg
Creating augmentation 1/1 for image 183/213: inventarbuch-174.jpg
Creating augmentation 1/1 for image 184/213: inventarbuch-195.jpg
Creating augmentation 1/1 for image 185/213: inventarbuch-200.jpg
Creating augmentation 1/1 for image 186/213: inventarbuch-273.jpg
Creating augmentation 1/1 for image 187/213: inventarbuch-151.jpg
Creating augmentation 1/1 for image 188/213: inventarbuch-056.jpg
Creating augmentation 1/1 for image 189/213: inventarbuch-298.jpg
Creating augmentation 1/1 for image 190/213: inventarbuch-224.jpg
Creating augmentation 1/1 for image 191/213: inventarbuch-105.jpg
Creating augmentation 1/1 for image 192/213: inventarbuch-083.jpg
Creating augmentation 1/1 for image 193/213: inventarbuch-010.jpg
Creating augmentation 1/1 for image 194/213: inventarbuch-243.jpg
Creating augmentation 1/1 for image 195/213: inventarbuch-016.jpg
Creating augmentation 1/1 for image 196/213: inventarbuch-086.jpg
Creating augmentation 1/1 for image 197/213: inventarbuch-182.jpg
Creating augmentation 1/1 for image 198/213: inventarbuch-058.jpg
Creating augmentation 1/1 for image 199/213: inventarbuch-282.jpg
Creating augmentation 1/1 for image 200/213: inventarbuch-293.jpg
Creating augmentation 1/1 for image 201/213: inventarbuch-169.jpg
Creating augmentation 1/1 for image 202/213: inventarbuch-071.jpg
Creating augmentation 1/1 for image 203/213: inventarbuch-255.jpg
Creating augmentation 1/1 for image 204/213: inventarbuch-123.jpg
Creating augmentation 1/1 for image 205/213: inventarbuch-254.jpg
Creating augmentation 1/1 for image 206/213: inventarbuch-005.jpg
Creating augmentation 1/1 for image 207/213: inventarbuch-077.jpg
Creating augmentation 1/1 for image 208/213: inventarbuch-107.jpg
Creating augmentation 1/1 for image 209/213: inventarbuch-121.jpg
Creating augmentation 1/1 for image 210/213: inventarbuch-134.jpg
Creating augmentation 1/1 for image 211/213: inventarbuch-173.jpg
Creating augmentation 1/1 for image 212/213: inventarbuch-185.jpg
Creating augmentation 1/1 for image 213/213: inventarbuch-197.jpg
Successfully created 213 augmented images
Total training samples: 426 (original: 213, augmented: 213)
Found 47 valid samples out of 47 total
Training: 426 samples, Validation: 47 samples

Unsloth: Model does not have a default image size - using 512

============================================================
GPU INFORMATION
============================================================
GPU: NVIDIA GeForce RTX 3080
Max memory: 9.644 GB
Reserved: 3.594 GB

âœ… UNSLOTH OPTIMIZATIONS:
   â€¢ 4-bit quantization
   â€¢ LoRA rank 16 (RSLoRA)
   â€¢ Gradient checkpointing
   â€¢ Data augmentation: 1x
   â€¢ Model selection: eval_cer_jiwer (best CER)
   â€¢ Batch size: 2, Grad accum: 4
============================================================

Starting training with CER-based model selection...
Unsloth: Will smartly offload gradients to save VRAM!
{'loss': 0.7893, 'grad_norm': 1.3194621801376343, 'learning_rate': 9e-06, 'epoch': 0.19}
{'loss': 0.7128, 'grad_norm': 0.47619178891181946, 'learning_rate': 1.9e-05, 'epoch': 0.38}
{'loss': 0.5731, 'grad_norm': 0.3446161150932312, 'learning_rate': 2.9e-05, 'epoch': 0.56}
{'loss': 0.4589, 'grad_norm': 0.34421297907829285, 'learning_rate': 3.9000000000000006e-05, 'epoch': 0.75}
{'loss': 0.2867, 'grad_norm': 0.2859604060649872, 'learning_rate': 4.9e-05, 'epoch': 0.94}
{'eval_loss': 0.8030351400375366, 'eval_runtime': 19.2853, 'eval_samples_per_second': 2.437, 'eval_steps_per_second': 1.244, 'epoch': 1.0}

============================================================
Computing CER on validation set (Epoch 1.0)...
============================================================
Validating 1/30Validating 2/30Validating 3/30Validating 4/30Validating 5/30Validating 6/30Validating 7/30Validating 8/30Validating 9/30Validating 10/30Validating 11/30Validating 12/30Validating 13/30Validating 14/30Validating 15/30Validating 16/30Validating 17/30Validating 18/30Validating 19/30Validating 20/30Validating 21/30Validating 22/30Validating 23/30Validating 24/30Validating 25/30Validating 26/30Validating 27/30Validating 28/30Validating 29/30Validating 30/30
âœ… Validation CER (Epoch 1.0): 2.9122 (291.22%)
ðŸŽ¯ New best CER: 2.9122
{'loss': 0.2581, 'grad_norm': 0.19472521543502808, 'learning_rate': 4.998270113931927e-05, 'epoch': 1.11}
{'loss': 0.1793, 'grad_norm': 0.1574075073003769, 'learning_rate': 4.99229333433282e-05, 'epoch': 1.3}
{'loss': 0.1787, 'grad_norm': 0.13092614710330963, 'learning_rate': 4.982058513379235e-05, 'epoch': 1.49}
{'loss': 0.1851, 'grad_norm': 0.13819827139377594, 'learning_rate': 4.967583137091085e-05, 'epoch': 1.68}
{'loss': 0.1569, 'grad_norm': 0.13517040014266968, 'learning_rate': 4.948891936405941e-05, 'epoch': 1.86}
{'eval_loss': 0.6845365762710571, 'eval_runtime': 19.16, 'eval_samples_per_second': 2.453, 'eval_steps_per_second': 1.253, 'epoch': 2.0}

============================================================
Computing CER on validation set (Epoch 2.0)...
============================================================
Validating 1/30Validating 2/30Validating 3/30Validating 4/30Validating 5/30Validating 6/30Validating 7/30Validating 8/30Validating 9/30Validating 10/30Validating 11/30Validating 12/30Validating 13/30Validating 14/30Validating 15/30Validating 16/30Validating 17/30Validating 18/30Validating 19/30Validating 20/30Validating 21/30Validating 22/30Validating 23/30Validating 24/30Validating 25/30Validating 26/30Validating 27/30Validating 28/30Validating 29/30Validating 30/30
âœ… Validation CER (Epoch 2.0): 0.2669 (26.69%)
ðŸŽ¯ New best CER: 0.2669
{'loss': 0.2101, 'grad_norm': 0.17821043729782104, 'learning_rate': 4.9260168449266335e-05, 'epoch': 2.04}
{'loss': 0.1522, 'grad_norm': 0.17487914860248566, 'learning_rate': 4.8989969443632366e-05, 'epoch': 2.23}
{'loss': 0.1509, 'grad_norm': 0.16406339406967163, 'learning_rate': 4.8678783977626155e-05, 'epoch': 2.41}
{'loss': 0.1389, 'grad_norm': 0.1708718091249466, 'learning_rate': 4.832714370639633e-05, 'epoch': 2.6}
{'loss': 0.1519, 'grad_norm': 0.18662762641906738, 'learning_rate': 4.793564940144769e-05, 'epoch': 2.79}
{'loss': 0.1391, 'grad_norm': 0.1940738558769226, 'learning_rate': 4.750496992423307e-05, 'epoch': 2.98}
{'eval_loss': 0.6608515381813049, 'eval_runtime': 18.8396, 'eval_samples_per_second': 2.495, 'eval_steps_per_second': 1.274, 'epoch': 3.0}

============================================================
Computing CER on validation set (Epoch 3.0)...
============================================================
Validating 1/30Validating 2/30Validating 3/30Validating 4/30Validating 5/30Validating 6/30Validating 7/30Validating 8/30Validating 9/30Validating 10/30Validating 11/30Validating 12/30Validating 13/30Validating 14/30Validating 15/30Validating 16/30Validating 17/30Validating 18/30Validating 19/30Validating 20/30Validating 21/30Validating 22/30Validating 23/30Validating 24/30Validating 25/30Validating 26/30Validating 27/30Validating 28/30Validating 29/30Validating 30/30
âœ… Validation CER (Epoch 3.0): 0.2416 (24.16%)
ðŸŽ¯ New best CER: 0.2416
{'loss': 0.1897, 'grad_norm': 0.1883629709482193, 'learning_rate': 4.703584108341481e-05, 'epoch': 3.15}
{'loss': 0.128, 'grad_norm': 0.2173764705657959, 'learning_rate': 4.652906437774799e-05, 'epoch': 3.34}
{'loss': 0.1368, 'grad_norm': 0.21906328201293945, 'learning_rate': 4.598550562673329e-05, 'epoch': 3.53}
{'loss': 0.1174, 'grad_norm': 0.21951745450496674, 'learning_rate': 4.5406093491378815e-05, 'epoch': 3.71}
{'loss': 0.1167, 'grad_norm': 0.2582978308200836, 'learning_rate': 4.479181788759842e-05, 'epoch': 3.9}
{'eval_loss': 0.6802045106887817, 'eval_runtime': 18.7088, 'eval_samples_per_second': 2.512, 'eval_steps_per_second': 1.283, 'epoch': 4.0}

============================================================
Computing CER on validation set (Epoch 4.0)...
============================================================
Validating 1/30Validating 2/30Validating 3/30Validating 4/30Validating 5/30Validating 6/30Validating 7/30Validating 8/30Validating 9/30Validating 10/30Validating 11/30Validating 12/30Validating 13/30Validating 14/30Validating 15/30Validating 16/30Validating 17/30Validating 18/30Validating 19/30Validating 20/30Validating 21/30Validating 22/30Validating 23/30Validating 24/30Validating 25/30Validating 26/30Validating 27/30Validating 28/30Validating 29/30Validating 30/30
âœ… Validation CER (Epoch 4.0): 0.2325 (23.25%)
ðŸŽ¯ New best CER: 0.2325
{'loss': 0.141, 'grad_norm': 0.2936849892139435, 'learning_rate': 4.414372829495693e-05, 'epoch': 4.08}
{'loss': 0.0996, 'grad_norm': 0.26791608333587646, 'learning_rate': 4.3462931963651934e-05, 'epoch': 4.26}
{'loss': 0.1027, 'grad_norm': 0.29043060541152954, 'learning_rate': 4.275059202279537e-05, 'epoch': 4.45}
{'loss': 0.0935, 'grad_norm': 0.32988882064819336, 'learning_rate': 4.200792549322698e-05, 'epoch': 4.64}
{'loss': 0.0926, 'grad_norm': 0.3004678189754486, 'learning_rate': 4.123620120825459e-05, 'epoch': 4.83}
{'loss': 0.1165, 'grad_norm': 2.8879554271698, 'learning_rate': 4.0436737645873715e-05, 'epoch': 5.0}
{'eval_loss': 0.7287920117378235, 'eval_runtime': 19.5115, 'eval_samples_per_second': 2.409, 'eval_steps_per_second': 1.23, 'epoch': 5.0}

============================================================
Computing CER on validation set (Epoch 5.0)...
============================================================
Validating 1/30Validating 2/30Validating 3/30Validating 4/30Validating 5/30Validating 6/30Validating 7/30Validating 8/30Validating 9/30Validating 10/30Validating 11/30Validating 12/30Validating 13/30Validating 14/30Validating 15/30Validating 16/30Validating 17/30Validating 18/30Validating 19/30Validating 20/30Validating 21/30Validating 22/30Validating 23/30Validating 24/30Validating 25/30Validating 26/30Validating 27/30Validating 28/30Validating 29/30Validating 30/30
âœ… Validation CER (Epoch 5.0): 0.2312 (23.12%)
ðŸŽ¯ New best CER: 0.2312
{'loss': 0.078, 'grad_norm': 0.3466193675994873, 'learning_rate': 3.961090067617e-05, 'epoch': 5.19}
{'loss': 0.0685, 'grad_norm': 0.43736085295677185, 'learning_rate': 3.876010122775309e-05, 'epoch': 5.38}
{'loss': 0.0676, 'grad_norm': 0.37392672896385193, 'learning_rate': 3.788579287720878e-05, 'epoch': 5.56}
{'loss': 0.0639, 'grad_norm': 0.3919490873813629, 'learning_rate': 3.698946936568782e-05, 'epoch': 5.75}
{'loss': 0.0648, 'grad_norm': 0.4473075866699219, 'learning_rate': 3.6072662046874146e-05, 'epoch': 5.94}
{'eval_loss': 0.8027095198631287, 'eval_runtime': 19.5855, 'eval_samples_per_second': 2.4, 'eval_steps_per_second': 1.225, 'epoch': 6.0}

============================================================
Computing CER on validation set (Epoch 6.0)...
============================================================
Validating 1/30Validating 2/30Validating 3/30Validating 4/30Validating 5/30Validating 6/30Validating 7/30Validating 8/30Validating 9/30Validating 10/30Validating 11/30Validating 12/30Validating 13/30Validating 14/30Validating 15/30Validating 16/30Validating 17/30Validating 18/30Validating 19/30Validating 20/30Validating 21/30Validating 22/30Validating 23/30Validating 24/30Validating 25/30Validating 26/30Validating 27/30Validating 28/30Validating 29/30Validating 30/30
âœ… Validation CER (Epoch 6.0): 0.2646 (26.46%)
{'loss': 0.0832, 'grad_norm': 0.47792544960975647, 'learning_rate': 3.513693727069289e-05, 'epoch': 6.11}
{'loss': 0.047, 'grad_norm': 0.4257652461528778, 'learning_rate': 3.418389370722775e-05, 'epoch': 6.3}
{'loss': 0.0409, 'grad_norm': 0.4277760982513428, 'learning_rate': 3.3215159615419975e-05, 'epoch': 6.49}
{'loss': 0.04, 'grad_norm': 0.53717440366745, 'learning_rate': 3.223239006121528e-05, 'epoch': 6.68}
{'loss': 0.0388, 'grad_norm': 0.4061760902404785, 'learning_rate': 3.1237264089911465e-05, 'epoch': 6.86}
{'eval_loss': 0.8568119406700134, 'eval_runtime': 18.2875, 'eval_samples_per_second': 2.57, 'eval_steps_per_second': 1.312, 'epoch': 7.0}

============================================================
Computing CER on validation set (Epoch 7.0)...
============================================================
Validating 1/30Validating 2/30Validating 3/30Validating 4/30Validating 5/30Validating 6/30Validating 7/30Validating 8/30Validating 9/30Validating 10/30Validating 11/30Validating 12/30Validating 13/30Validating 14/30Validating 15/30Validating 16/30Validating 17/30Validating 18/30Validating 19/30Validating 20/30Validating 21/30Validating 22/30Validating 23/30Validating 24/30Validating 25/30Validating 26/30Validating 27/30Validating 28/30Validating 29/30Validating 30/30
âœ… Validation CER (Epoch 7.0): 0.2356 (23.56%)
{'loss': 0.0508, 'grad_norm': 0.3363162577152252, 'learning_rate': 3.0231481857537665e-05, 'epoch': 7.04}
{'loss': 0.0254, 'grad_norm': 0.3619562089443207, 'learning_rate': 2.9216761726166287e-05, 'epoch': 7.23}
{'loss': 0.0255, 'grad_norm': 0.3406829237937927, 'learning_rate': 2.8194837328120256e-05, 'epoch': 7.41}
{'loss': 0.0232, 'grad_norm': 0.33597806096076965, 'learning_rate': 2.7167454604091248e-05, 'epoch': 7.6}
{'loss': 0.0224, 'grad_norm': 0.30240967869758606, 'learning_rate': 2.613636882022934e-05, 'epoch': 7.79}
{'loss': 0.0216, 'grad_norm': 0.3203834891319275, 'learning_rate': 2.5103341569300208e-05, 'epoch': 7.98}
{'eval_loss': 0.9501044750213623, 'eval_runtime': 18.2954, 'eval_samples_per_second': 2.569, 'eval_steps_per_second': 1.312, 'epoch': 8.0}

============================================================
Computing CER on validation set (Epoch 8.0)...
============================================================
Validating 1/30Validating 2/30Validating 3/30Validating 4/30Validating 5/30Validating 6/30Validating 7/30Validating 8/30Validating 9/30Validating 10/30Validating 11/30Validating 12/30Validating 13/30Validating 14/30Validating 15/30Validating 16/30Validating 17/30Validating 18/30Validating 19/30Validating 20/30Validating 21/30Validating 22/30Validating 23/30Validating 24/30Validating 25/30Validating 26/30Validating 27/30Validating 28/30Validating 29/30Validating 30/30
âœ… Validation CER (Epoch 8.0): 0.2761 (27.61%)
{'train_runtime': 14538.5523, 'train_samples_per_second': 0.44, 'train_steps_per_second': 0.056, 'train_loss': 0.15805126398939778, 'epoch': 8.0}

============================================================
TRAINING COMPLETED
============================================================
Runtime: 242.31 min
Peak memory: 8.762 GB
Training memory: 5.168 GB
Best validation CER: 0.2312 (23.12%)
============================================================


Saving best model (selected by CER) to /home/vault/iwi5/iwi5298h/models_image_text/nanonets/inven/run_20251021_144811_unsloth_cer...
âœ… Best model saved (CER-based selection)!

============================================================
PHASE 2: EVALUATION
============================================================

Starting evaluation on test set...
Loaded 48 test samples

Processing chunk 1/3 (20 images)
Processing test image 1/48: inventarbuch-022.jpg
  Processed successfully. CER: 0.381
Processing test image 2/48: inventarbuch-099.jpg
  Processed successfully. CER: 0.307
Processing test image 3/48: inventarbuch-245.jpg
  Processed successfully. CER: 0.440
Processing test image 4/48: inventarbuch-263.jpg
  Processed successfully. CER: 0.369
Processing test image 5/48: inventarbuch-033.jpg
  Processed successfully. CER: 0.456
Processing test image 6/48: inventarbuch-143.jpg
  Processed successfully. CER: 0.266
Processing test image 7/48: inventarbuch-244.jpg
  Processed successfully. CER: 0.547
Processing test image 8/48: inventarbuch-024.jpg
  Processed successfully. CER: 0.374
Processing test image 9/48: inventarbuch-141.jpg
  Processed successfully. CER: 0.209
Processing test image 10/48: inventarbuch-183.jpg
  Processed successfully. CER: 0.508
Processing test image 11/48: inventarbuch-191.jpg
  Processed successfully. CER: 0.351
Processing test image 12/48: inventarbuch-051.jpg
  Processed successfully. CER: 0.357
Processing test image 13/48: inventarbuch-203.jpg
  Processed successfully. CER: 0.270
Processing test image 14/48: inventarbuch-296.jpg
  Processed successfully. CER: 0.340
Processing test image 15/48: inventarbuch-302.jpg
  Processed successfully. CER: 1.714
Processing test image 16/48: inventarbuch-179.jpg
  Processed successfully. CER: 0.323
Processing test image 17/48: inventarbuch-114.jpg
  Processed successfully. CER: 0.364
Processing test image 18/48: inventarbuch-082.jpg
  Processed successfully. CER: 0.403
Processing test image 19/48: inventarbuch-287.jpg
  Processed successfully. CER: 0.512
Processing test image 20/48: inventarbuch-181.jpg
  Processed successfully. CER: 0.469

Processing chunk 2/3 (20 images)
Processing test image 21/48: inventarbuch-299.jpg
  Processed successfully. CER: 0.582
Processing test image 22/48: inventarbuch-084.jpg
  Processed successfully. CER: 0.516
Processing test image 23/48: inventarbuch-004.jpg
  Processed successfully. CER: 0.338
Processing test image 24/48: inventarbuch-148.jpg
  Processed successfully. CER: 0.233
Processing test image 25/48: inventarbuch-238.jpg
  Processed successfully. CER: 0.309
Processing test image 26/48: inventarbuch-116.jpg
  Processed successfully. CER: 0.390
Processing test image 27/48: inventarbuch-223.jpg
  Processed successfully. CER: 0.297
Processing test image 28/48: inventarbuch-104.jpg
  Processed successfully. CER: 0.349
Processing test image 29/48: inventarbuch-015.jpg
  Processed successfully. CER: 0.313
Processing test image 30/48: inventarbuch-272.jpg
  Processed successfully. CER: 0.378
Processing test image 31/48: inventarbuch-124.jpg
  Processed successfully. CER: 0.291
Processing test image 32/48: inventarbuch-115.jpg
  Processed successfully. CER: 0.316
Processing test image 33/48: inventarbuch-049.jpg
  Processed successfully. CER: 0.459
Processing test image 34/48: inventarbuch-017.jpg
  Processed successfully. CER: 0.380
Processing test image 35/48: inventarbuch-018.jpg
  Processed successfully. CER: 0.350
Processing test image 36/48: inventarbuch-225.jpg
  Processed successfully. CER: 0.530
Processing test image 37/48: inventarbuch-046.jpg
  Processed successfully. CER: 0.336
Processing test image 38/48: inventarbuch-294.jpg
  Processed successfully. CER: 0.278
Processing test image 39/48: inventarbuch-054.jpg
  Processed successfully. CER: 0.413
Processing test image 40/48: inventarbuch-073.jpg
  Processed successfully. CER: 0.420

Processing chunk 3/3 (8 images)
Processing test image 41/48: inventarbuch-118.jpg
  Processed successfully. CER: 0.345
Processing test image 42/48: inventarbuch-130.jpg
  Processed successfully. CER: 0.289
Processing test image 43/48: inventarbuch-146.jpg
  Processed successfully. CER: 0.334
Processing test image 44/48: inventarbuch-014.jpg
  Processed successfully. CER: 0.347
Processing test image 45/48: inventarbuch-059.jpg
  Processed successfully. CER: 0.369
Processing test image 46/48: inventarbuch-256.jpg
  Processed successfully. CER: 0.306
Processing test image 47/48: inventarbuch-260.jpg
  Processed successfully. CER: 0.317
Processing test image 48/48: inventarbuch-279.jpg
  Processed successfully. CER: 0.463

Results saved to: /home/vault/iwi5/iwi5298h/models_image_text/nanonets/inven/run_20251021_144811_unsloth_cer/cer_evaluation_results.txt

============================================================
FINAL RESULTS - CER-BASED MODEL SELECTION
============================================================
Model: Nanonets-OCR-s (finetuned, best CER checkpoint)
Dataset: Inventory (Anthropological-Prehistoric)

Metrics:
  Avg CER: 0.4002 (40.02%)
  Weighted CER: 0.3792 (37.92%)
  Median: 0.3543 | Std: 0.2087

Accuracy:
  Perfect: 0/48 (0.00%)
  Parsing: 0/48 (0.00%)

Saved to: /home/vault/iwi5/iwi5298h/models_image_text/nanonets/inven/run_20251021_144811_unsloth_cer
============================================================

Cleaned up temporary directory: /tmp/1244674.tinygpu/augmented_inventory_xtjd_5ys
Nano training completed at: Tue Oct 21 07:20:42 PM CEST 2025
=== JOB_STATISTICS ===
=== current date     : Tue Oct 21 07:20:43 PM CEST 2025
= Job-ID             : 1244674 on tinygpu
= Job-Name           : inven
= Job-Command        : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles/job_nano.sh
= Initial workdir    : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles
= Queue/Partition    : rtx3080
= Slurm account      : iwi5 with QOS=normal
= Requested resources:  for 10:00:00
= Elapsed runtime    : 04:32:55
= Total RAM usage    : 10.4 GiB of requested  GiB (%)   
= Node list          : tg080
= Subm/Elig/Start/End: 2025-10-21T14:47:46 / 2025-10-21T14:47:46 / 2025-10-21T14:47:47 / 2025-10-21T19:20:42
======================
=== Quota infos ======
    Path                 Used     SoftQ    HardQ    Gracetime  Filec    FileQ    FiHaQ    FileGrace    
    /home/woody           180.7G  1000.0G  1500.0G        N/A     802K   5,000K   7,500K        N/A    
    /home/hpc             101.0G   104.9G   209.7G        N/A  33,377      500K   1,000K        N/A    
    /home/vault           838.5G  1048.6G  2097.2G        N/A   4,277      200K     400K        N/A    
======================
=== GPU utilization ==
gpu_name, gpu_bus_id, pid, gpu_utilization [%], mem_utilization [%], max_memory_usage [MiB], time [ms]
NVIDIA GeForce RTX 3080, 00000000:3D:00.0, 1724404, 23 %, 9 %, 9274 MiB, 16368598 ms
