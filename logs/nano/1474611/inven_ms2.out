### Starting TaskPrologue of job 1474611 on tg074 at Fri Dec 26 10:49:09 PM CET 2025
Running on cores 4-5,12-13,20-21,28-29 with governor ondemand
Fri Dec 26 22:49:09 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.195.03             Driver Version: 570.195.03     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-PCIE-32GB           On  |   00000000:86:00.0 Off |                    0 |
| N/A   30C    P0             26W /  250W |       0MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
### Finished TaskPrologue

ü¶• Unsloth: Will patch your computer to enable 2x faster free finetuning.
ü¶• Unsloth Zoo will now patch everything to make training faster!

============================================================
NANONETS-OCR-S FINETUNING - INVENTORY DATASET (MULTI-STAGE)
ANTHROPOLOGICAL-PREHISTORIC COLLECTION
BEST MODEL BY VALIDATION CER (Stage 2) + TENSORBOARD CER CURVE
============================================================
Model: /home/vault/iwi5/iwi5298h/models/Nanonets-OCR-s
Output: /home/vault/iwi5/iwi5298h/models_image_text/nanonets/multistage/inven/run_20251226_224944_unsloth_evalcer
Augmentation: 1x
============================================================

============================================================
LOADING NANONETS-OCR-S WITH UNSLOTH FOR INVENTORY DATASET (MULTI-STAGE)
============================================================
Model path: /home/vault/iwi5/iwi5298h/models/Nanonets-OCR-s
Augmentation factor: 1
Created temporary directory: /tmp/1474611.tinygpu/augmented_inventory_fu0vapq5
‚úì Model directory verified
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.10.7: Fast Qwen2_5_Vl patching. Transformers: 4.56.2.
   \\   /|    Tesla V100-PCIE-32GB. Num GPUs = 1. Max memory: 31.733 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.8.0+cu128. CUDA: 7.0. CUDA Toolkit: 12.8. Triton: 3.4.0
\        /    Bfloat16 = FALSE. FA [Xformers = 0.0.32.post2. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Qwen2_5_Vl does not support SDPA - switching to fast eager.

‚úÖ Model loaded successfully!
Applying LoRA adaptors...
Unsloth: Making `model.base_model.model.model` require gradients
‚úÖ LoRA applied successfully!
============================================================


============================================================
PHASE 1: MULTI-STAGE TRAINING (teacher forcing, best by eval_cer)
============================================================

Preparing datasets...
Preparing training data with augmentation factor: 1
Creating augmentation 1/1 for image 1/213: inventarbuch-265.jpg
Creating augmentation 1/1 for image 2/213: inventarbuch-189.jpg
Creating augmentation 1/1 for image 3/213: inventarbuch-026.jpg
Creating augmentation 1/1 for image 4/213: inventarbuch-021.jpg
Creating augmentation 1/1 for image 5/213: inventarbuch-281.jpg
Creating augmentation 1/1 for image 6/213: inventarbuch-167.jpg
Creating augmentation 1/1 for image 7/213: inventarbuch-280.jpg
Creating augmentation 1/1 for image 8/213: inventarbuch-057.jpg
Creating augmentation 1/1 for image 9/213: inventarbuch-159.jpg
Creating augmentation 1/1 for image 10/213: inventarbuch-094.jpg
Creating augmentation 1/1 for image 11/213: inventarbuch-040.jpg
Creating augmentation 1/1 for image 12/213: inventarbuch-305.jpg
Creating augmentation 1/1 for image 13/213: inventarbuch-220.jpg
Creating augmentation 1/1 for image 14/213: inventarbuch-226.jpg
Creating augmentation 1/1 for image 15/213: inventarbuch-264.jpg
Creating augmentation 1/1 for image 16/213: inventarbuch-089.jpg
Creating augmentation 1/1 for image 17/213: inventarbuch-002.jpg
Creating augmentation 1/1 for image 18/213: inventarbuch-290.jpg
Creating augmentation 1/1 for image 19/213: inventarbuch-109.jpg
Creating augmentation 1/1 for image 20/213: inventarbuch-144.jpg
Creating augmentation 1/1 for image 21/213: inventarbuch-075.jpg
Creating augmentation 1/1 for image 22/213: inventarbuch-239.jpg
Creating augmentation 1/1 for image 23/213: inventarbuch-145.jpg
Creating augmentation 1/1 for image 24/213: inventarbuch-091.jpg
Creating augmentation 1/1 for image 25/213: inventarbuch-007.jpg
Creating augmentation 1/1 for image 26/213: inventarbuch-285.jpg
Creating augmentation 1/1 for image 27/213: inventarbuch-247.jpg
Creating augmentation 1/1 for image 28/213: inventarbuch-117.jpg
Creating augmentation 1/1 for image 29/213: inventarbuch-288.jpg
Creating augmentation 1/1 for image 30/213: inventarbuch-050.jpg
Creating augmentation 1/1 for image 31/213: inventarbuch-063.jpg
Creating augmentation 1/1 for image 32/213: inventarbuch-249.jpg
Creating augmentation 1/1 for image 33/213: inventarbuch-204.jpg
Creating augmentation 1/1 for image 34/213: inventarbuch-172.jpg
Creating augmentation 1/1 for image 35/213: inventarbuch-088.jpg
Creating augmentation 1/1 for image 36/213: inventarbuch-039.jpg
Creating augmentation 1/1 for image 37/213: inventarbuch-300.jpg
Creating augmentation 1/1 for image 38/213: inventarbuch-286.jpg
Creating augmentation 1/1 for image 39/213: inventarbuch-192.jpg
Creating augmentation 1/1 for image 40/213: inventarbuch-085.jpg
Creating augmentation 1/1 for image 41/213: inventarbuch-241.jpg
Creating augmentation 1/1 for image 42/213: inventarbuch-270.jpg
Creating augmentation 1/1 for image 43/213: inventarbuch-180.jpg
Creating augmentation 1/1 for image 44/213: inventarbuch-202.jpg
Creating augmentation 1/1 for image 45/213: inventarbuch-140.jpg
Creating augmentation 1/1 for image 46/213: inventarbuch-008.jpg
Creating augmentation 1/1 for image 47/213: inventarbuch-258.jpg
Creating augmentation 1/1 for image 48/213: inventarbuch-028.jpg
Creating augmentation 1/1 for image 49/213: inventarbuch-209.jpg
Creating augmentation 1/1 for image 50/213: inventarbuch-228.jpg
Creating augmentation 1/1 for image 51/213: inventarbuch-306.jpg
Creating augmentation 1/1 for image 52/213: inventarbuch-277.jpg
Creating augmentation 1/1 for image 53/213: inventarbuch-184.jpg
Creating augmentation 1/1 for image 54/213: inventarbuch-289.jpg
Creating augmentation 1/1 for image 55/213: inventarbuch-067.jpg
Creating augmentation 1/1 for image 56/213: inventarbuch-036.jpg
Creating augmentation 1/1 for image 57/213: inventarbuch-292.jpg
Creating augmentation 1/1 for image 58/213: inventarbuch-092.jpg
Creating augmentation 1/1 for image 59/213: inventarbuch-231.jpg
Creating augmentation 1/1 for image 60/213: inventarbuch-246.jpg
Creating augmentation 1/1 for image 61/213: inventarbuch-081.jpg
Creating augmentation 1/1 for image 62/213: inventarbuch-034.jpg
Creating augmentation 1/1 for image 63/213: inventarbuch-175.jpg
Creating augmentation 1/1 for image 64/213: inventarbuch-044.jpg
Creating augmentation 1/1 for image 65/213: inventarbuch-006.jpg
Creating augmentation 1/1 for image 66/213: inventarbuch-154.jpg
Creating augmentation 1/1 for image 67/213: inventarbuch-234.jpg
Creating augmentation 1/1 for image 68/213: inventarbuch-111.jpg
Creating augmentation 1/1 for image 69/213: inventarbuch-011.jpg
Creating augmentation 1/1 for image 70/213: inventarbuch-126.jpg
Creating augmentation 1/1 for image 71/213: inventarbuch-157.jpg
Creating augmentation 1/1 for image 72/213: inventarbuch-152.jpg
Creating augmentation 1/1 for image 73/213: inventarbuch-190.jpg
Creating augmentation 1/1 for image 74/213: inventarbuch-304.jpg
Creating augmentation 1/1 for image 75/213: inventarbuch-217.jpg
Creating augmentation 1/1 for image 76/213: inventarbuch-103.jpg
Creating augmentation 1/1 for image 77/213: inventarbuch-207.jpg
Creating augmentation 1/1 for image 78/213: inventarbuch-267.jpg
Creating augmentation 1/1 for image 79/213: inventarbuch-297.jpg
Creating augmentation 1/1 for image 80/213: inventarbuch-308.jpg
Creating augmentation 1/1 for image 81/213: inventarbuch-068.jpg
Creating augmentation 1/1 for image 82/213: inventarbuch-259.jpg
Creating augmentation 1/1 for image 83/213: inventarbuch-276.jpg
Creating augmentation 1/1 for image 84/213: inventarbuch-053.jpg
Creating augmentation 1/1 for image 85/213: inventarbuch-269.jpg
Creating augmentation 1/1 for image 86/213: inventarbuch-236.jpg
Creating augmentation 1/1 for image 87/213: inventarbuch-129.jpg
Creating augmentation 1/1 for image 88/213: inventarbuch-138.jpg
Creating augmentation 1/1 for image 89/213: inventarbuch-193.jpg
Creating augmentation 1/1 for image 90/213: inventarbuch-080.jpg
Creating augmentation 1/1 for image 91/213: inventarbuch-125.jpg
Creating augmentation 1/1 for image 92/213: inventarbuch-035.jpg
Creating augmentation 1/1 for image 93/213: inventarbuch-023.jpg
Creating augmentation 1/1 for image 94/213: inventarbuch-072.jpg
Creating augmentation 1/1 for image 95/213: inventarbuch-062.jpg
Creating augmentation 1/1 for image 96/213: inventarbuch-087.jpg
Creating augmentation 1/1 for image 97/213: inventarbuch-128.jpg
Creating augmentation 1/1 for image 98/213: inventarbuch-160.jpg
Creating augmentation 1/1 for image 99/213: inventarbuch-150.jpg
Creating augmentation 1/1 for image 100/213: inventarbuch-218.jpg
Creating augmentation 1/1 for image 101/213: inventarbuch-201.jpg
Creating augmentation 1/1 for image 102/213: inventarbuch-119.jpg
Creating augmentation 1/1 for image 103/213: inventarbuch-237.jpg
Creating augmentation 1/1 for image 104/213: inventarbuch-108.jpg
Creating augmentation 1/1 for image 105/213: inventarbuch-012.jpg
Creating augmentation 1/1 for image 106/213: inventarbuch-074.jpg
Creating augmentation 1/1 for image 107/213: inventarbuch-162.jpg
Creating augmentation 1/1 for image 108/213: inventarbuch-009.jpg
Creating augmentation 1/1 for image 109/213: inventarbuch-032.jpg
Creating augmentation 1/1 for image 110/213: inventarbuch-156.jpg
Creating augmentation 1/1 for image 111/213: inventarbuch-106.jpg
Creating augmentation 1/1 for image 112/213: inventarbuch-110.jpg
Creating augmentation 1/1 for image 113/213: inventarbuch-048.jpg
Creating augmentation 1/1 for image 114/213: inventarbuch-275.jpg
Creating augmentation 1/1 for image 115/213: inventarbuch-250.jpg
Creating augmentation 1/1 for image 116/213: inventarbuch-214.jpg
Creating augmentation 1/1 for image 117/213: inventarbuch-213.jpg
Creating augmentation 1/1 for image 118/213: inventarbuch-137.jpg
Creating augmentation 1/1 for image 119/213: inventarbuch-215.jpg
Creating augmentation 1/1 for image 120/213: inventarbuch-186.jpg
Creating augmentation 1/1 for image 121/213: inventarbuch-216.jpg
Creating augmentation 1/1 for image 122/213: inventarbuch-212.jpg
Creating augmentation 1/1 for image 123/213: inventarbuch-102.jpg
Creating augmentation 1/1 for image 124/213: inventarbuch-127.jpg
Creating augmentation 1/1 for image 125/213: inventarbuch-210.jpg
Creating augmentation 1/1 for image 126/213: inventarbuch-240.jpg
Creating augmentation 1/1 for image 127/213: inventarbuch-219.jpg
Creating augmentation 1/1 for image 128/213: inventarbuch-098.jpg
Creating augmentation 1/1 for image 129/213: inventarbuch-257.jpg
Creating augmentation 1/1 for image 130/213: inventarbuch-052.jpg
Creating augmentation 1/1 for image 131/213: inventarbuch-139.jpg
Creating augmentation 1/1 for image 132/213: inventarbuch-079.jpg
Creating augmentation 1/1 for image 133/213: inventarbuch-029.jpg
Creating augmentation 1/1 for image 134/213: inventarbuch-135.jpg
Creating augmentation 1/1 for image 135/213: inventarbuch-047.jpg
Creating augmentation 1/1 for image 136/213: inventarbuch-133.jpg
Creating augmentation 1/1 for image 137/213: inventarbuch-284.jpg
Creating augmentation 1/1 for image 138/213: inventarbuch-001.jpg
Creating augmentation 1/1 for image 139/213: inventarbuch-233.jpg
Creating augmentation 1/1 for image 140/213: inventarbuch-163.jpg
Creating augmentation 1/1 for image 141/213: inventarbuch-295.jpg
Creating augmentation 1/1 for image 142/213: inventarbuch-261.jpg
Creating augmentation 1/1 for image 143/213: inventarbuch-165.jpg
Creating augmentation 1/1 for image 144/213: inventarbuch-090.jpg
Creating augmentation 1/1 for image 145/213: inventarbuch-198.jpg
Creating augmentation 1/1 for image 146/213: inventarbuch-278.jpg
Creating augmentation 1/1 for image 147/213: inventarbuch-031.jpg
Creating augmentation 1/1 for image 148/213: inventarbuch-003.jpg
Creating augmentation 1/1 for image 149/213: inventarbuch-262.jpg
Creating augmentation 1/1 for image 150/213: inventarbuch-066.jpg
Creating augmentation 1/1 for image 151/213: inventarbuch-271.jpg
Creating augmentation 1/1 for image 152/213: inventarbuch-301.jpg
Creating augmentation 1/1 for image 153/213: inventarbuch-211.jpg
Creating augmentation 1/1 for image 154/213: inventarbuch-101.jpg
Creating augmentation 1/1 for image 155/213: inventarbuch-196.jpg
Creating augmentation 1/1 for image 156/213: inventarbuch-158.jpg
Creating augmentation 1/1 for image 157/213: inventarbuch-112.jpg
Creating augmentation 1/1 for image 158/213: inventarbuch-042.jpg
Creating augmentation 1/1 for image 159/213: inventarbuch-041.jpg
Creating augmentation 1/1 for image 160/213: inventarbuch-030.jpg
Creating augmentation 1/1 for image 161/213: inventarbuch-307.jpg
Creating augmentation 1/1 for image 162/213: inventarbuch-025.jpg
Creating augmentation 1/1 for image 163/213: inventarbuch-131.jpg
Creating augmentation 1/1 for image 164/213: inventarbuch-136.jpg
Creating augmentation 1/1 for image 165/213: inventarbuch-205.jpg
Creating augmentation 1/1 for image 166/213: inventarbuch-242.jpg
Creating augmentation 1/1 for image 167/213: inventarbuch-251.jpg
Creating augmentation 1/1 for image 168/213: inventarbuch-199.jpg
Creating augmentation 1/1 for image 169/213: inventarbuch-177.jpg
Creating augmentation 1/1 for image 170/213: inventarbuch-113.jpg
Creating augmentation 1/1 for image 171/213: inventarbuch-155.jpg
Creating augmentation 1/1 for image 172/213: inventarbuch-208.jpg
Creating augmentation 1/1 for image 173/213: inventarbuch-268.jpg
Creating augmentation 1/1 for image 174/213: inventarbuch-149.jpg
Creating augmentation 1/1 for image 175/213: inventarbuch-065.jpg
Creating augmentation 1/1 for image 176/213: inventarbuch-037.jpg
Creating augmentation 1/1 for image 177/213: inventarbuch-069.jpg
Creating augmentation 1/1 for image 178/213: inventarbuch-038.jpg
Creating augmentation 1/1 for image 179/213: inventarbuch-122.jpg
Creating augmentation 1/1 for image 180/213: inventarbuch-170.jpg
Creating augmentation 1/1 for image 181/213: inventarbuch-291.jpg
Creating augmentation 1/1 for image 182/213: inventarbuch-132.jpg
Creating augmentation 1/1 for image 183/213: inventarbuch-174.jpg
Creating augmentation 1/1 for image 184/213: inventarbuch-195.jpg
Creating augmentation 1/1 for image 185/213: inventarbuch-200.jpg
Creating augmentation 1/1 for image 186/213: inventarbuch-273.jpg
Creating augmentation 1/1 for image 187/213: inventarbuch-151.jpg
Creating augmentation 1/1 for image 188/213: inventarbuch-056.jpg
Creating augmentation 1/1 for image 189/213: inventarbuch-298.jpg
Creating augmentation 1/1 for image 190/213: inventarbuch-224.jpg
Creating augmentation 1/1 for image 191/213: inventarbuch-105.jpg
Creating augmentation 1/1 for image 192/213: inventarbuch-083.jpg
Creating augmentation 1/1 for image 193/213: inventarbuch-010.jpg
Creating augmentation 1/1 for image 194/213: inventarbuch-243.jpg
Creating augmentation 1/1 for image 195/213: inventarbuch-016.jpg
Creating augmentation 1/1 for image 196/213: inventarbuch-086.jpg
Creating augmentation 1/1 for image 197/213: inventarbuch-182.jpg
Creating augmentation 1/1 for image 198/213: inventarbuch-058.jpg
Creating augmentation 1/1 for image 199/213: inventarbuch-282.jpg
Creating augmentation 1/1 for image 200/213: inventarbuch-293.jpg
Creating augmentation 1/1 for image 201/213: inventarbuch-169.jpg
Creating augmentation 1/1 for image 202/213: inventarbuch-071.jpg
Creating augmentation 1/1 for image 203/213: inventarbuch-255.jpg
Creating augmentation 1/1 for image 204/213: inventarbuch-123.jpg
Creating augmentation 1/1 for image 205/213: inventarbuch-254.jpg
Creating augmentation 1/1 for image 206/213: inventarbuch-005.jpg
Creating augmentation 1/1 for image 207/213: inventarbuch-077.jpg
Creating augmentation 1/1 for image 208/213: inventarbuch-107.jpg
Creating augmentation 1/1 for image 209/213: inventarbuch-121.jpg
Creating augmentation 1/1 for image 210/213: inventarbuch-134.jpg
Creating augmentation 1/1 for image 211/213: inventarbuch-173.jpg
Creating augmentation 1/1 for image 212/213: inventarbuch-185.jpg
Creating augmentation 1/1 for image 213/213: inventarbuch-197.jpg
Successfully created 213 augmented images
Total training samples: 426 (original: 213, augmented: 213)
Found 47 valid samples out of 47 total
Training: 426 samples, Validation: 47 samples


============================================================
STAGE 1: decoder / adapters only (vision frozen) + teacher forcing
============================================================
‚ö†Ô∏è Could not find explicit vision encoder to freeze; Stage 1 will still train LoRA/text parts.
Unsloth: Model does not have a default image size - using 512
‚û°Ô∏è Starting Stage 1 training...
Unsloth: Will smartly offload gradients to save VRAM!
{'loss': 2.8781, 'grad_norm': 1.4950428009033203, 'learning_rate': 5.4000000000000005e-05, 'epoch': 0.19}
{'loss': 1.7624, 'grad_norm': 2.223979949951172, 'learning_rate': 0.000114, 'epoch': 0.38}
{'loss': 0.8378, 'grad_norm': 0.626947820186615, 'learning_rate': 0.00014914204391939165, 'epoch': 0.56}
{'loss': 0.7298, 'grad_norm': 0.6046206951141357, 'learning_rate': 0.00013971404872743174, 'epoch': 0.75}
{'loss': 0.598, 'grad_norm': 0.5783936381340027, 'learning_rate': 0.00012112488330134654, 'epoch': 0.94}
{'loss': 0.5358, 'grad_norm': 0.5623708963394165, 'learning_rate': 9.600610156686805e-05, 'epoch': 1.11}
{'loss': 0.534, 'grad_norm': 0.5954877138137817, 'learning_rate': 6.791361510839766e-05, 'epoch': 1.3}
{'loss': 0.5464, 'grad_norm': 0.5462737083435059, 'learning_rate': 4.082430461578189e-05, 'epoch': 1.49}
{'loss': 0.5671, 'grad_norm': 0.598188042640686, 'learning_rate': 1.8573037321531407e-05, 'epoch': 1.68}
{'loss': 0.4773, 'grad_norm': 0.5711180567741394, 'learning_rate': 4.309788410574553e-06, 'epoch': 1.86}
{'train_runtime': 710.7961, 'train_samples_per_second': 1.199, 'train_steps_per_second': 0.152, 'train_loss': 0.9132891650553103, 'epoch': 2.0}
‚úÖ Stage 1 done.

============================================================
STAGE 2: full model (vision unfrozen) + teacher forcing + eval + BEST BY EVAL_CER
============================================================
‚ö†Ô∏è Could not find explicit vision encoder to unfreeze; Stage 2 trains what is trainable.
Unsloth: Model does not have a default image size - using 512
‚û°Ô∏è Starting Stage 2 training...
{'loss': 0.544, 'grad_norm': 0.6319505572319031, 'learning_rate': 9e-06, 'epoch': 0.19}
{'loss': 0.4462, 'grad_norm': 0.5599479675292969, 'learning_rate': 1.9e-05, 'epoch': 0.38}
{'loss': 0.4864, 'grad_norm': 0.6700509190559387, 'learning_rate': 2.9e-05, 'epoch': 0.56}
{'loss': 0.4941, 'grad_norm': 0.6579757928848267, 'learning_rate': 3.9000000000000006e-05, 'epoch': 0.75}
{'loss': 0.4004, 'grad_norm': 0.714775562286377, 'learning_rate': 4.9e-05, 'epoch': 0.94}
{'eval_loss': 0.6804432272911072, 'eval_runtime': 16.4488, 'eval_samples_per_second': 2.857, 'eval_steps_per_second': 1.459, 'epoch': 1.0}

================================================================================
üîç COMPUTING VALIDATION CER (Epoch 1)
================================================================================
   ‚úÖ Validation CER (Epoch 1): 0.4303 (43.03%)
{'eval_cer': 0.4303047889744093, 'epoch': 1.0}
   üéØ NEW BEST CER: 0.4303 (improved by inf)
   üíæ Saving best model (LoRA adapter) to: /home/vault/iwi5/iwi5298h/models_image_text/nanonets/multistage/inven/run_20251226_224944_unsloth_evalcer/best_model
   ‚úÖ Best adapter + tokenizer saved.
================================================================================

{'loss': 0.3479, 'grad_norm': 1.0414966344833374, 'learning_rate': 4.997649655492925e-05, 'epoch': 1.11}
{'loss': 0.3619, 'grad_norm': 0.974055290222168, 'learning_rate': 4.989530681359751e-05, 'epoch': 1.3}
{'loss': 0.3979, 'grad_norm': 0.9932765364646912, 'learning_rate': 4.975632902618451e-05, 'epoch': 1.49}
{'loss': 0.4313, 'grad_norm': 1.080668330192566, 'learning_rate': 4.9559885793847307e-05, 'epoch': 1.68}
{'loss': 0.349, 'grad_norm': 1.042373776435852, 'learning_rate': 4.930643310898028e-05, 'epoch': 1.86}
{'eval_loss': 0.7134226560592651, 'eval_runtime': 16.0547, 'eval_samples_per_second': 2.927, 'eval_steps_per_second': 1.495, 'epoch': 2.0}

================================================================================
üîç COMPUTING VALIDATION CER (Epoch 2)
================================================================================
   ‚úÖ Validation CER (Epoch 2): 0.3867 (38.67%)
{'eval_cer': 0.38666470957642757, 'epoch': 2.0}
   üéØ NEW BEST CER: 0.3867 (improved by 0.04364007939798176)
   üíæ Saving best model (LoRA adapter) to: /home/vault/iwi5/iwi5298h/models_image_text/nanonets/multistage/inven/run_20251226_224944_unsloth_evalcer/best_model
   ‚úÖ Best adapter + tokenizer saved.
================================================================================

{'loss': 0.3521, 'grad_norm': 1.0202113389968872, 'learning_rate': 4.899655929674617e-05, 'epoch': 2.04}
{'loss': 0.2563, 'grad_norm': 1.2888017892837524, 'learning_rate': 4.863098364943065e-05, 'epoch': 2.23}
{'loss': 0.2558, 'grad_norm': 1.2133347988128662, 'learning_rate': 4.821055475679048e-05, 'epoch': 2.41}
{'loss': 0.224, 'grad_norm': 1.2539308071136475, 'learning_rate': 4.773624853627082e-05, 'epoch': 2.6}
{'loss': 0.2635, 'grad_norm': 1.4681942462921143, 'learning_rate': 4.720916596766408e-05, 'epoch': 2.79}
{'loss': 0.2194, 'grad_norm': 1.2973976135253906, 'learning_rate': 4.66305305374688e-05, 'epoch': 2.98}
{'eval_loss': 0.825474202632904, 'eval_runtime': 16.1491, 'eval_samples_per_second': 2.91, 'eval_steps_per_second': 1.486, 'epoch': 3.0}

================================================================================
üîç COMPUTING VALIDATION CER (Epoch 3)
================================================================================
   ‚úÖ Validation CER (Epoch 3): 0.4119 (41.19%)
{'eval_cer': 0.4119433871679044, 'epoch': 3.0}
   üìä No improvement. Best CER remains: 0.3867
   ‚è≥ Early-stop counter: 1/3
================================================================================

{'loss': 0.1657, 'grad_norm': 1.2481614351272583, 'learning_rate': 4.600168539888068e-05, 'epoch': 3.15}
{'loss': 0.1376, 'grad_norm': 1.293320655822754, 'learning_rate': 4.532409025400817e-05, 'epoch': 3.34}
{'loss': 0.154, 'grad_norm': 1.1125534772872925, 'learning_rate': 4.4599317965549836e-05, 'epoch': 3.53}
{'loss': 0.1262, 'grad_norm': 1.4921104907989502, 'learning_rate': 4.3829050905798474e-05, 'epoch': 3.71}
{'loss': 0.1243, 'grad_norm': 1.1794480085372925, 'learning_rate': 4.301507705144693e-05, 'epoch': 3.9}
{'eval_loss': 0.875946044921875, 'eval_runtime': 16.0987, 'eval_samples_per_second': 2.919, 'eval_steps_per_second': 1.491, 'epoch': 4.0}

================================================================================
üîç COMPUTING VALIDATION CER (Epoch 4)
================================================================================
   ‚úÖ Validation CER (Epoch 4): 0.3964 (39.64%)
{'eval_cer': 0.3963665689143584, 'epoch': 4.0}
   üìä No improvement. Best CER remains: 0.3867
   ‚è≥ Early-stop counter: 2/3
================================================================================

{'loss': 0.1123, 'grad_norm': 1.0264960527420044, 'learning_rate': 4.215928583326045e-05, 'epoch': 4.08}
{'loss': 0.0672, 'grad_norm': 0.7034400701522827, 'learning_rate': 4.126366375024959e-05, 'epoch': 4.26}
{'loss': 0.0707, 'grad_norm': 1.2985742092132568, 'learning_rate': 4.033028975852411e-05, 'epoch': 4.45}
{'loss': 0.0654, 'grad_norm': 1.1587424278259277, 'learning_rate': 3.936133044553154e-05, 'epoch': 4.64}
{'loss': 0.0623, 'grad_norm': 1.1398600339889526, 'learning_rate': 3.8359035000882174e-05, 'epoch': 4.83}
{'loss': 0.0702, 'grad_norm': 2.0408082008361816, 'learning_rate': 3.7325729995434367e-05, 'epoch': 5.0}
{'eval_loss': 0.9379912614822388, 'eval_runtime': 16.4934, 'eval_samples_per_second': 2.85, 'eval_steps_per_second': 1.455, 'epoch': 5.0}

================================================================================
üîç COMPUTING VALIDATION CER (Epoch 5)
================================================================================
   ‚úÖ Validation CER (Epoch 5): 0.3856 (38.56%)
{'eval_cer': 0.3856441673653488, 'epoch': 5.0}
   üéØ NEW BEST CER: 0.3856 (improved by 0.0010205422110787787)
   üíæ Saving best model (LoRA adapter) to: /home/vault/iwi5/iwi5298h/models_image_text/nanonets/multistage/inven/run_20251226_224944_unsloth_evalcer/best_model
   ‚úÖ Best adapter + tokenizer saved.
================================================================================

{'loss': 0.0391, 'grad_norm': 1.1814861297607422, 'learning_rate': 3.6263813980759215e-05, 'epoch': 5.19}
{'loss': 0.0339, 'grad_norm': 1.0054091215133667, 'learning_rate': 3.517575192152055e-05, 'epoch': 5.38}
{'loss': 0.0357, 'grad_norm': 0.639339804649353, 'learning_rate': 3.406406947369398e-05, 'epoch': 5.56}
{'loss': 0.0329, 'grad_norm': 0.8363590240478516, 'learning_rate': 3.293134712190674e-05, 'epoch': 5.75}
{'loss': 0.0355, 'grad_norm': 0.9455783367156982, 'learning_rate': 3.1780214189506894e-05, 'epoch': 5.94}
{'eval_loss': 1.0272133350372314, 'eval_runtime': 16.189, 'eval_samples_per_second': 2.903, 'eval_steps_per_second': 1.482, 'epoch': 6.0}

================================================================================
üîç COMPUTING VALIDATION CER (Epoch 6)
================================================================================
   ‚úÖ Validation CER (Epoch 6): 0.4098 (40.98%)
{'eval_cer': 0.40978978918340137, 'epoch': 6.0}
   üìä No improvement. Best CER remains: 0.3856
   ‚è≥ Early-stop counter: 1/3
================================================================================

{'loss': 0.0294, 'grad_norm': 0.7951945662498474, 'learning_rate': 3.061334273526606e-05, 'epoch': 6.11}
{'loss': 0.0208, 'grad_norm': 0.5706581473350525, 'learning_rate': 2.9433441350882803e-05, 'epoch': 6.3}
{'loss': 0.0197, 'grad_norm': 0.5969309210777283, 'learning_rate': 2.8243248873684275e-05, 'epoch': 6.49}
{'loss': 0.0185, 'grad_norm': 0.8026669025421143, 'learning_rate': 2.704552802912041e-05, 'epoch': 6.68}
{'loss': 0.0203, 'grad_norm': 0.4401508867740631, 'learning_rate': 2.584305901780799e-05, 'epoch': 6.86}
{'eval_loss': 1.076098918914795, 'eval_runtime': 16.1537, 'eval_samples_per_second': 2.91, 'eval_steps_per_second': 1.486, 'epoch': 7.0}

================================================================================
üîç COMPUTING VALIDATION CER (Epoch 7)
================================================================================
   ‚úÖ Validation CER (Epoch 7): 0.3965 (39.65%)
{'eval_cer': 0.3964850479378452, 'epoch': 7.0}
   üìä No improvement. Best CER remains: 0.3856
   ‚è≥ Early-stop counter: 2/3
================================================================================

{'loss': 0.0192, 'grad_norm': 0.33214902877807617, 'learning_rate': 2.463863306201062e-05, 'epoch': 7.04}
{'loss': 0.0132, 'grad_norm': 0.32037588953971863, 'learning_rate': 2.3435045926534723e-05, 'epoch': 7.23}
{'loss': 0.0131, 'grad_norm': 0.3930892050266266, 'learning_rate': 2.2235091429081316e-05, 'epoch': 7.41}
{'loss': 0.0136, 'grad_norm': 0.23306839168071747, 'learning_rate': 2.1041554955117346e-05, 'epoch': 7.6}
{'loss': 0.013, 'grad_norm': 0.3037935197353363, 'learning_rate': 1.9857206992320436e-05, 'epoch': 7.79}
{'loss': 0.0132, 'grad_norm': 0.5339494943618774, 'learning_rate': 1.868479669960485e-05, 'epoch': 7.98}
{'eval_loss': 1.1206477880477905, 'eval_runtime': 16.1017, 'eval_samples_per_second': 2.919, 'eval_steps_per_second': 1.491, 'epoch': 8.0}

================================================================================
üîç COMPUTING VALIDATION CER (Epoch 8)
================================================================================
   ‚úÖ Validation CER (Epoch 8): 0.4120 (41.20%)
{'eval_cer': 0.41195760317921837, 'epoch': 8.0}
   üìä No improvement. Best CER remains: 0.3856
   ‚è≥ Early-stop counter: 3/3
   üõë Early stopping triggered (no CER improvement).
================================================================================

{'train_runtime': 16003.4722, 'train_samples_per_second': 0.346, 'train_steps_per_second': 0.044, 'train_loss': 0.1703828035388142, 'epoch': 8.0}
‚úÖ Stage 2 done.

üîÅ Loading best CER adapter from: /home/vault/iwi5/iwi5298h/models_image_text/nanonets/multistage/inven/run_20251226_224944_unsloth_evalcer/best_model
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.10.7: Fast Qwen2_5_Vl patching. Transformers: 4.56.2.
   \\   /|    Tesla V100-PCIE-32GB. Num GPUs = 1. Max memory: 31.733 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.8.0+cu128. CUDA: 7.0. CUDA Toolkit: 12.8. Triton: 3.4.0
\        /    Bfloat16 = FALSE. FA [Xformers = 0.0.32.post2. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Qwen2_5_Vl does not support SDPA - switching to fast eager.
‚úÖ Best CER adapter loaded onto base model for evaluation.

GPU: Tesla V100-PCIE-32GB, Peak reserved: 8.662 GB

Saving model to /home/vault/iwi5/iwi5298h/models_image_text/nanonets/multistage/inven/run_20251226_224944_unsloth_evalcer...
‚úÖ Model saved!

============================================================
PHASE 2: EVALUATION (TEST SET) - USING BEST CER MODEL
============================================================

Starting evaluation on test set...
Loaded 48 test samples

Processing chunk 1/3 (20 images)
Processing test image 1/48: inventarbuch-022.jpg
  Processed successfully. CER: 0.394
Processing test image 2/48: inventarbuch-099.jpg
  Processed successfully. CER: 0.298
Processing test image 3/48: inventarbuch-245.jpg
  Processed successfully. CER: 0.441
Processing test image 4/48: inventarbuch-263.jpg
  Processed successfully. CER: 0.353
Processing test image 5/48: inventarbuch-033.jpg
  Processed successfully. CER: 0.481
Processing test image 6/48: inventarbuch-143.jpg
  Processed successfully. CER: 0.305
Processing test image 7/48: inventarbuch-244.jpg
  Processed successfully. CER: 0.570
Processing test image 8/48: inventarbuch-024.jpg
  Processed successfully. CER: 0.399
Processing test image 9/48: inventarbuch-141.jpg
  Processed successfully. CER: 0.248
Processing test image 10/48: inventarbuch-183.jpg
  Processed successfully. CER: 0.558
Processing test image 11/48: inventarbuch-191.jpg
  Processed successfully. CER: 0.468
Processing test image 12/48: inventarbuch-051.jpg
  Processed successfully. CER: 0.364
Processing test image 13/48: inventarbuch-203.jpg
  Processed successfully. CER: 0.360
Processing test image 14/48: inventarbuch-296.jpg
  Processed successfully. CER: 0.391
Processing test image 15/48: inventarbuch-302.jpg
  Processed successfully. CER: 0.343
Processing test image 16/48: inventarbuch-179.jpg
  Processed successfully. CER: 0.360
Processing test image 17/48: inventarbuch-114.jpg
  Processed successfully. CER: 0.337
Processing test image 18/48: inventarbuch-082.jpg
  Processed successfully. CER: 0.431
Processing test image 19/48: inventarbuch-287.jpg
  Processed successfully. CER: 0.458
Processing test image 20/48: inventarbuch-181.jpg
  Processed successfully. CER: 0.456

Processing chunk 2/3 (20 images)
Processing test image 21/48: inventarbuch-299.jpg
  Processed successfully. CER: 0.366
Processing test image 22/48: inventarbuch-084.jpg
  Processed successfully. CER: 0.506
Processing test image 23/48: inventarbuch-004.jpg
  Processed successfully. CER: 0.368
Processing test image 24/48: inventarbuch-148.jpg
  Processed successfully. CER: 0.234
Processing test image 25/48: inventarbuch-238.jpg
  Processed successfully. CER: 0.356
Processing test image 26/48: inventarbuch-116.jpg
  Processed successfully. CER: 0.375
Processing test image 27/48: inventarbuch-223.jpg
  Processed successfully. CER: 0.338
Processing test image 28/48: inventarbuch-104.jpg
  Processed successfully. CER: 0.379
Processing test image 29/48: inventarbuch-015.jpg
  Processed successfully. CER: 0.317
Processing test image 30/48: inventarbuch-272.jpg
  Processed successfully. CER: 0.395
Processing test image 31/48: inventarbuch-124.jpg
  Processed successfully. CER: 0.314
Processing test image 32/48: inventarbuch-115.jpg
  Processed successfully. CER: 0.340
Processing test image 33/48: inventarbuch-049.jpg
  Processed successfully. CER: 0.652
Processing test image 34/48: inventarbuch-017.jpg
  Processed successfully. CER: 0.418
Processing test image 35/48: inventarbuch-018.jpg
  Processed successfully. CER: 0.378
Processing test image 36/48: inventarbuch-225.jpg
  Processed successfully. CER: 0.501
Processing test image 37/48: inventarbuch-046.jpg
  Processed successfully. CER: 0.410
Processing test image 38/48: inventarbuch-294.jpg
  Processed successfully. CER: 0.272
Processing test image 39/48: inventarbuch-054.jpg
  Processed successfully. CER: 0.417
Processing test image 40/48: inventarbuch-073.jpg
  Processed successfully. CER: 0.446

Processing chunk 3/3 (8 images)
Processing test image 41/48: inventarbuch-118.jpg
  Processed successfully. CER: 0.343
Processing test image 42/48: inventarbuch-130.jpg
  Processed successfully. CER: 0.320
Processing test image 43/48: inventarbuch-146.jpg
  Processed successfully. CER: 0.356
Processing test image 44/48: inventarbuch-014.jpg
  Processed successfully. CER: 0.395
Processing test image 45/48: inventarbuch-059.jpg
  Processed successfully. CER: 0.370
Processing test image 46/48: inventarbuch-256.jpg
  Processed successfully. CER: 0.293
Processing test image 47/48: inventarbuch-260.jpg
  Processed successfully. CER: 0.355
Processing test image 48/48: inventarbuch-279.jpg
  Processed successfully. CER: 0.455

Results saved to: /home/vault/iwi5/iwi5298h/models_image_text/nanonets/multistage/inven/run_20251226_224944_unsloth_evalcer/cer_evaluation_results.txt

============================================================
FINAL RESULTS
============================================================
Model: Nanonets-OCR-s (finetuned, multi-stage, best by eval_cer)
Dataset: Inventory (Anthropological-Prehistoric)

Metrics:
  Avg CER: 0.3893 (38.93%)
  Weighted CER: 0.3857 (38.57%)
  Median: 0.3729 | Std: 0.0808

Accuracy:
  Perfect: 0/48 (0.00%)
  Parsing: 0/48 (0.00%)

Best Validation CER: 0.3856
Best model saved at: /home/vault/iwi5/iwi5298h/models_image_text/nanonets/multistage/inven/run_20251226_224944_unsloth_evalcer/best_model

Saved to: /home/vault/iwi5/iwi5298h/models_image_text/nanonets/multistage/inven/run_20251226_224944_unsloth_evalcer
============================================================

Cleaned up temporary directory: /tmp/1474611.tinygpu/augmented_inventory_fu0vapq5
Nano training completed at: Sat Dec 27 04:01:23 AM CET 2025
=== JOB_STATISTICS ===
=== current date     : Sat Dec 27 04:01:23 AM CET 2025
= Job-ID             : 1474611 on tinygpu
= Job-Name           : inven_ms2
= Job-Command        : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles/job_nano.sh
= Initial workdir    : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles
= Queue/Partition    : v100
= Slurm account      : iwi5 with QOS=normal
= Requested resources:  for 1-00:00:00
= Elapsed runtime    : 05:12:14
= Total RAM usage    : 10.9 GiB of requested  GiB (%)   
= Node list          : tg074
= Subm/Elig/Start/End: 2025-12-26T22:49:08 / 2025-12-26T22:49:08 / 2025-12-26T22:49:09 / 2025-12-27T04:01:23
======================
=== Quota infos ======
    Path                 Used     SoftQ    HardQ    Gracetime  Filec    FileQ    FiHaQ    FileGrace    
    /home/hpc              88.5G   104.9G   209.7G        N/A  29,245      500K   1,000K        N/A    
    /home/woody           219.6G  1000.0G  1500.0G        N/A   1,017K   5,000K   7,500K        N/A    
    /home/vault           962.1G  1048.6G  2097.2G        N/A   7,668      200K     400K        N/A    
======================
=== GPU utilization ==
gpu_name, gpu_bus_id, pid, gpu_utilization [%], mem_utilization [%], max_memory_usage [MiB], time [ms]
Tesla V100-PCIE-32GB, 00000000:86:00.0, 4175457, 25 %, 8 %, 9278 MiB, 18720186 ms
