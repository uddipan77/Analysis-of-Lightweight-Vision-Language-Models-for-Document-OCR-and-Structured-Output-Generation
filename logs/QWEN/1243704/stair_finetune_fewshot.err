Unsloth: KwargsForCausalLM cannot be inherited from TransformersKwargs since it's of type = <class 'type'>
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|â–ˆâ–ˆ        | 1/5 [01:07<04:30, 67.64s/it]Loading checkpoint shards:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:45<02:30, 50.22s/it]Loading checkpoint shards:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [02:23<01:29, 44.54s/it]Loading checkpoint shards:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [03:01<00:41, 41.89s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:10<00:00, 30.19s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:10<00:00, 38.14s/it]
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
  0%|          | 0/180 [00:00<?, ?it/s]Unsloth: Not an error, but Qwen2_5_VLForConditionalGeneration does not accept `num_items_in_batch`.
Using gradient accumulation will be very slightly less accurate.
Read more on gradient accumulation issues here: https://unsloth.ai/blog/gradient
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
  1%|          | 1/180 [00:20<59:48, 20.04s/it]  1%|          | 2/180 [00:39<58:16, 19.64s/it]  2%|â–         | 3/180 [00:58<57:43, 19.57s/it]  2%|â–         | 4/180 [01:17<55:50, 19.04s/it]  3%|â–Ž         | 5/180 [01:33<52:50, 18.12s/it]  3%|â–Ž         | 6/180 [01:50<51:44, 17.84s/it]  4%|â–         | 7/180 [02:08<51:39, 17.92s/it]  4%|â–         | 8/180 [02:26<51:25, 17.94s/it]  5%|â–Œ         | 9/180 [02:45<51:53, 18.21s/it]
  0%|          | 0/9 [00:00<?, ?it/s][A
 22%|â–ˆâ–ˆâ–       | 2/9 [00:01<00:03,  1.79it/s][A
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 3/9 [00:03<00:08,  1.35s/it][A
 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 4/9 [00:04<00:06,  1.27s/it][A
 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 5/9 [00:09<00:09,  2.33s/it][A
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 6/9 [00:10<00:05,  1.93s/it][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 7/9 [00:14<00:05,  2.73s/it][A
 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 8/9 [00:15<00:02,  2.22s/it][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 9/9 [00:20<00:00,  2.99s/it][A                                               
                                             [A  5%|â–Œ         | 9/180 [03:23<51:53, 18.21s/it]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 9/9 [00:25<00:00,  2.99s/it][A
                                             [A  6%|â–Œ         | 10/180 [03:49<1:31:31, 32.31s/it]                                                    6%|â–Œ         | 10/180 [03:49<1:31:31, 32.31s/it]  6%|â–Œ         | 11/180 [04:07<1:18:30, 27.88s/it]  7%|â–‹         | 12/180 [04:26<1:10:07, 25.04s/it]  7%|â–‹         | 13/180 [04:42<1:02:44, 22.54s/it]  8%|â–Š         | 14/180 [05:00<58:42, 21.22s/it]    8%|â–Š         | 15/180 [05:19<55:59, 20.36s/it]  9%|â–‰         | 16/180 [05:37<53:33, 19.59s/it]  9%|â–‰         | 17/180 [05:56<52:43, 19.41s/it] 10%|â–ˆ         | 18/180 [06:13<50:34, 18.73s/it]
  0%|          | 0/9 [00:00<?, ?it/s][A
 22%|â–ˆâ–ˆâ–       | 2/9 [00:01<00:03,  1.84it/s][A
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 3/9 [00:03<00:07,  1.22s/it][A
 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 4/9 [00:04<00:05,  1.17s/it][A
 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 5/9 [00:07<00:07,  1.98s/it][A
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 6/9 [00:08<00:05,  1.68s/it][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 7/9 [00:12<00:04,  2.40s/it][A
 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 8/9 [00:13<00:01,  1.99s/it][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 9/9 [00:18<00:00,  2.68s/it][A                                                
                                             [A 10%|â–ˆ         | 18/180 [06:46<50:34, 18.73s/it]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 9/9 [00:23<00:00,  2.68s/it][A
                                             [A 11%|â–ˆ         | 19/180 [07:13<1:23:34, 31.15s/it] 11%|â–ˆ         | 20/180 [07:31<1:12:37, 27.23s/it]                                                   11%|â–ˆ         | 20/180 [07:31<1:12:37, 27.23s/it] 12%|â–ˆâ–        | 21/180 [07:49<1:04:50, 24.47s/it] 12%|â–ˆâ–        | 22/180 [08:07<59:27, 22.58s/it]   13%|â–ˆâ–Ž        | 23/180 [08:25<55:13, 21.10s/it] 13%|â–ˆâ–Ž        | 24/180 [08:43<52:23, 20.15s/it] 14%|â–ˆâ–        | 25/180 [09:02<51:23, 19.89s/it] 14%|â–ˆâ–        | 26/180 [09:19<48:44, 18.99s/it] 15%|â–ˆâ–Œ        | 27/180 [09:37<47:57, 18.80s/it]
  0%|          | 0/9 [00:00<?, ?it/s][A
 22%|â–ˆâ–ˆâ–       | 2/9 [00:01<00:03,  1.83it/s][A
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 3/9 [00:03<00:07,  1.23s/it][A
 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 4/9 [00:04<00:05,  1.18s/it][A
 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 5/9 [00:07<00:07,  1.99s/it][A
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 6/9 [00:08<00:05,  1.69s/it][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 7/9 [00:12<00:04,  2.42s/it][A
 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 8/9 [00:14<00:02,  2.01s/it][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 9/9 [00:18<00:00,  2.68s/it][A                                                
                                             [A 15%|â–ˆâ–Œ        | 27/180 [10:10<47:57, 18.80s/it]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 9/9 [00:23<00:00,  2.68s/it][A
                                             [A 16%|â–ˆâ–Œ        | 28/180 [10:37<1:18:26, 30.96s/it] 16%|â–ˆâ–Œ        | 29/180 [10:54<1:07:18, 26.74s/it] 17%|â–ˆâ–‹        | 30/180 [11:11<1:00:02, 24.02s/it]                                                   17%|â–ˆâ–‹        | 30/180 [11:11<1:00:02, 24.02s/it] 17%|â–ˆâ–‹        | 31/180 [11:29<54:40, 22.01s/it]   18%|â–ˆâ–Š        | 32/180 [11:47<51:20, 20.81s/it] 18%|â–ˆâ–Š        | 33/180 [12:04<48:33, 19.82s/it] 19%|â–ˆâ–‰        | 34/180 [12:23<47:41, 19.60s/it] 19%|â–ˆâ–‰        | 35/180 [12:42<46:47, 19.37s/it] 20%|â–ˆâ–ˆ        | 36/180 [13:01<46:24, 19.33s/it]
  0%|          | 0/9 [00:00<?, ?it/s][A
 22%|â–ˆâ–ˆâ–       | 2/9 [00:01<00:03,  1.83it/s][A
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 3/9 [00:03<00:07,  1.22s/it][A
 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 4/9 [00:04<00:05,  1.17s/it][A
 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 5/9 [00:07<00:07,  2.00s/it][A
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 6/9 [00:09<00:05,  1.71s/it][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 7/9 [00:12<00:04,  2.43s/it][A
 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 8/9 [00:14<00:02,  2.02s/it][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 9/9 [00:18<00:00,  2.70s/it][A                                                
                                             [A 20%|â–ˆâ–ˆ        | 36/180 [13:35<46:24, 19.33s/it]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 9/9 [00:23<00:00,  2.70s/it][A
                                             [A 21%|â–ˆâ–ˆ        | 37/180 [14:00<1:14:29, 31.25s/it] 21%|â–ˆâ–ˆ        | 38/180 [14:20<1:05:28, 27.67s/it] 22%|â–ˆâ–ˆâ–       | 39/180 [14:37<57:50, 24.62s/it]   22%|â–ˆâ–ˆâ–       | 40/180 [14:56<53:32, 22.94s/it]                                                 22%|â–ˆâ–ˆâ–       | 40/180 [14:57<53:32, 22.94s/it] 23%|â–ˆâ–ˆâ–Ž       | 41/180 [15:16<50:41, 21.88s/it] 23%|â–ˆâ–ˆâ–Ž       | 42/180 [15:33<47:00, 20.44s/it] 24%|â–ˆâ–ˆâ–       | 43/180 [15:50<44:25, 19.45s/it] 24%|â–ˆâ–ˆâ–       | 44/180 [16:07<42:45, 18.87s/it] 25%|â–ˆâ–ˆâ–Œ       | 45/180 [16:26<42:37, 18.94s/it]
  0%|          | 0/9 [00:00<?, ?it/s][A
 22%|â–ˆâ–ˆâ–       | 2/9 [00:01<00:03,  1.84it/s][A
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 3/9 [00:03<00:07,  1.23s/it][A
 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 4/9 [00:04<00:05,  1.19s/it][A
 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 5/9 [00:07<00:07,  1.99s/it][A
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 6/9 [00:09<00:05,  1.70s/it][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 7/9 [00:13<00:04,  2.45s/it][A
 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 8/9 [00:14<00:02,  2.02s/it][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 9/9 [00:18<00:00,  2.71s/it][A                                                
                                             [A 25%|â–ˆâ–ˆâ–Œ       | 45/180 [17:00<42:37, 18.94s/it]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 9/9 [00:23<00:00,  2.71s/it][A
                                             [A 26%|â–ˆâ–ˆâ–Œ       | 46/180 [17:25<1:09:09, 30.97s/it] 26%|â–ˆâ–ˆâ–Œ       | 47/180 [17:44<1:00:19, 27.22s/it] 27%|â–ˆâ–ˆâ–‹       | 48/180 [18:00<52:46, 23.99s/it]   27%|â–ˆâ–ˆâ–‹       | 49/180 [18:18<48:17, 22.12s/it] 28%|â–ˆâ–ˆâ–Š       | 50/180 [18:37<45:36, 21.05s/it]                                                 28%|â–ˆâ–ˆâ–Š       | 50/180 [18:37<45:36, 21.05s/it] 28%|â–ˆâ–ˆâ–Š       | 51/180 [18:54<42:34, 19.80s/it] 29%|â–ˆâ–ˆâ–‰       | 52/180 [19:13<41:53, 19.63s/it] 29%|â–ˆâ–ˆâ–‰       | 53/180 [19:31<40:37, 19.20s/it] 30%|â–ˆâ–ˆâ–ˆ       | 54/180 [19:50<40:21, 19.22s/it]
  0%|          | 0/9 [00:00<?, ?it/s][A
 22%|â–ˆâ–ˆâ–       | 2/9 [00:01<00:03,  1.84it/s][A
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 3/9 [00:03<00:07,  1.23s/it][A
 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 4/9 [00:04<00:05,  1.18s/it][A
 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 5/9 [00:07<00:07,  1.98s/it][A
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 6/9 [00:08<00:05,  1.69s/it][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 7/9 [00:12<00:04,  2.42s/it][A
 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 8/9 [00:14<00:02,  2.01s/it][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 9/9 [00:18<00:00,  2.68s/it][A                                                
                                             [A 30%|â–ˆâ–ˆâ–ˆ       | 54/180 [20:24<40:21, 19.22s/it]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 9/9 [00:23<00:00,  2.68s/it][A
                                             [A                                                 30%|â–ˆâ–ˆâ–ˆ       | 54/180 [20:31<40:21, 19.22s/it] 30%|â–ˆâ–ˆâ–ˆ       | 54/180 [20:31<47:53, 22.81s/it]
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Unsloth: Merging weights into 16bit:   0%|          | 0/5 [00:00<?, ?it/s]Unsloth: Merging weights into 16bit:  20%|â–ˆâ–ˆ        | 1/5 [00:29<01:59, 29.82s/it]Unsloth: Merging weights into 16bit:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [02:27<04:05, 81.71s/it]Unsloth: Merging weights into 16bit:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [04:51<03:40, 110.14s/it]Unsloth: Merging weights into 16bit:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [07:12<02:02, 122.07s/it]Unsloth: Merging weights into 16bit: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [09:32<00:00, 128.82s/it]Unsloth: Merging weights into 16bit: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [09:32<00:00, 114.60s/it]
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Unsloth: Merging weights into 16bit:   0%|          | 0/5 [00:00<?, ?it/s]Unsloth: Merging weights into 16bit:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:34, 38.60s/it]Unsloth: Merging weights into 16bit:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [03:11<05:16, 105.65s/it]Unsloth: Merging weights into 16bit:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [06:18<04:46, 143.09s/it]Unsloth: Merging weights into 16bit:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [09:04<02:32, 152.20s/it]Unsloth: Merging weights into 16bit: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [12:16<00:00, 166.49s/it]Unsloth: Merging weights into 16bit: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [12:16<00:00, 147.37s/it]
/home/hpc/iwi5/iwi5298h/Uddipan-Thesis/qwen/finetune/stair_finetune_fewshot.py:500: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.inference_mode(), torch.cuda.amp.autocast(dtype=torch.bfloat16):
