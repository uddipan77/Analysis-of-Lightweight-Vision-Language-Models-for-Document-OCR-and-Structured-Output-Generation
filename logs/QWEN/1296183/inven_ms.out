### Starting TaskPrologue of job 1296183 on tg071 at Tue Nov  4 03:30:30 AM CET 2025
Running on cores 0-1,8-9,17-18,24-25 with governor ondemand
Tue Nov  4 03:30:30 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.195.03             Driver Version: 570.195.03     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-PCIE-32GB           Off |   00000000:18:00.0 Off |                    0 |
| N/A   29C    P0             26W /  250W |       0MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
### Finished TaskPrologue

ðŸ¦¥ Unsloth: Will patch your computer to enable 2x faster free finetuning.
ðŸ¦¥ Unsloth Zoo will now patch everything to make training faster!
Created run directory: /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251104_040019
Loading Qwen2.5-VL model with Unsloth...
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Qwen2_5_Vl patching. Transformers: 4.51.3.
   \\   /|    Tesla V100-PCIE-32GB. Num GPUs = 1. Max memory: 31.733 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 7.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = FALSE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Qwen2_5_Vl does not support SDPA - switching to eager!
Unsloth: Making `model.base_model.model.visual` require gradients
Model loaded successfully with optimized LoRA adapters!
============================================================
STARTING MULTI-STAGE TRAINING WITH TEACHER FORCING + CER SELECTION
============================================================
Preparing training and validation datasets...
Training: 213 samples, Validation: 47 samples

===== STAGE 1: Warm-up training (no eval, teacher forcing) =====

Unsloth: Model does not have a default image size - using 512
Unsloth: Will smartly offload gradients to save VRAM!
{'loss': 3.6081, 'grad_norm': 13.715106010437012, 'learning_rate': 7.2000000000000005e-06, 'epoch': 0.37}
{'loss': 2.5933, 'grad_norm': 11.264676094055176, 'learning_rate': 1.9200000000000003e-05, 'epoch': 0.75}
{'loss': 1.7656, 'grad_norm': nan, 'learning_rate': 3.1200000000000006e-05, 'epoch': 1.15}
{'loss': 1.1224, 'grad_norm': 3.07965087890625, 'learning_rate': 4.2000000000000004e-05, 'epoch': 1.52}
{'loss': 1.1393, 'grad_norm': 15.016824722290039, 'learning_rate': 5.400000000000001e-05, 'epoch': 1.9}
{'loss': 0.9488, 'grad_norm': 2.3247716426849365, 'learning_rate': 5.942355841209692e-05, 'epoch': 2.3}
{'loss': 0.8668, 'grad_norm': 4.491177558898926, 'learning_rate': 5.494408836907637e-05, 'epoch': 2.67}
{'loss': 0.9237, 'grad_norm': 4.4334893226623535, 'learning_rate': 4.666710699058807e-05, 'epoch': 3.07}
{'loss': 0.6608, 'grad_norm': 3.920008659362793, 'learning_rate': 3.5852709660483855e-05, 'epoch': 3.45}
{'loss': 0.6698, 'grad_norm': 2.7301104068756104, 'learning_rate': 2.4147290339516156e-05, 'epoch': 3.82}
{'loss': 0.6085, 'grad_norm': 5.192864418029785, 'learning_rate': 1.3332893009411944e-05, 'epoch': 4.22}
{'loss': 0.5364, 'grad_norm': 3.1432838439941406, 'learning_rate': 5.0559116309236405e-06, 'epoch': 4.6}
{'loss': 0.5162, 'grad_norm': 10.631197929382324, 'learning_rate': 5.764415879030871e-07, 'epoch': 4.97}
{'train_runtime': 1550.5228, 'train_samples_per_second': 0.687, 'train_steps_per_second': 0.084, 'train_loss': 1.2276762008666993, 'epoch': 4.97}

===== STAGE 2: Main training (eval each epoch, CER-based best model) =====

Unsloth: Model does not have a default image size - using 512
GPU = Tesla V100-PCIE-32GB. Max memory = 31.733 GB.
9.631 GB of memory reserved.
{'loss': 0.4596, 'grad_norm': 3.1578104496002197, 'learning_rate': 2.8000000000000003e-06, 'epoch': 0.37}
{'loss': 0.4892, 'grad_norm': 2.5783674716949463, 'learning_rate': 6.800000000000001e-06, 'epoch': 0.75}
{'eval_loss': 1.10740065574646, 'eval_runtime': 26.2141, 'eval_samples_per_second': 1.793, 'eval_steps_per_second': 0.916, 'epoch': 0.97}

[ValidationCERCallback] Computing CER on 47 validation samples...

[ValidationCERCallback] Epoch 0.97 CER: 0.2356 (23.56%)
[ValidationCERCallback] New best CER: 0.2356 (improved by inf)
[ValidationCERCallback] Saving best CER model to /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251104_040019/best_model_cer
{'loss': 0.4753, 'grad_norm': 2.6195929050445557, 'learning_rate': 1.04e-05, 'epoch': 1.15}
{'loss': 0.4153, 'grad_norm': 3.7685210704803467, 'learning_rate': 1.4400000000000001e-05, 'epoch': 1.52}
{'loss': 0.4462, 'grad_norm': 4.530428886413574, 'learning_rate': 1.8400000000000003e-05, 'epoch': 1.9}
{'eval_loss': 1.1495829820632935, 'eval_runtime': 24.3995, 'eval_samples_per_second': 1.926, 'eval_steps_per_second': 0.984, 'epoch': 1.97}

[ValidationCERCallback] Computing CER on 47 validation samples...

[ValidationCERCallback] Epoch 1.97 CER: 0.2338 (23.38%)
[ValidationCERCallback] New best CER: 0.2338 (improved by 0.0018)
[ValidationCERCallback] Saving best CER model to /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251104_040019/best_model_cer
{'loss': 0.3381, 'grad_norm': 4.55064582824707, 'learning_rate': 1.9991958847061786e-05, 'epoch': 2.3}
{'loss': 0.2931, 'grad_norm': 4.140737533569336, 'learning_rate': 1.9942865292219837e-05, 'epoch': 2.67}
{'eval_loss': 1.2551593780517578, 'eval_runtime': 24.851, 'eval_samples_per_second': 1.891, 'eval_steps_per_second': 0.966, 'epoch': 2.97}

[ValidationCERCallback] Computing CER on 47 validation samples...

[ValidationCERCallback] Epoch 2.97 CER: 0.2373 (23.73%)
[ValidationCERCallback] No improvement. Best CER remains 0.2338
{'loss': 0.3394, 'grad_norm': 2.978062629699707, 'learning_rate': 1.9860702539900288e-05, 'epoch': 3.07}
{'loss': 0.1825, 'grad_norm': 3.6746175289154053, 'learning_rate': 1.9727586637650373e-05, 'epoch': 3.45}
{'loss': 0.2067, 'grad_norm': 4.678861618041992, 'learning_rate': 1.9551024972069127e-05, 'epoch': 3.82}
{'eval_loss': 1.3181321620941162, 'eval_runtime': 23.375, 'eval_samples_per_second': 2.011, 'eval_steps_per_second': 1.027, 'epoch': 3.97}

[ValidationCERCallback] Computing CER on 47 validation samples...

[ValidationCERCallback] Epoch 3.97 CER: 0.2605 (26.05%)
[ValidationCERCallback] No improvement. Best CER remains 0.2338
{'loss': 0.1777, 'grad_norm': 2.5284006595611572, 'learning_rate': 1.9355621141132022e-05, 'epoch': 4.22}
{'loss': 0.121, 'grad_norm': 2.6744375228881836, 'learning_rate': 1.9098842577186315e-05, 'epoch': 4.6}
{'loss': 0.1416, 'grad_norm': 2.735877275466919, 'learning_rate': 1.880142637351325e-05, 'epoch': 4.97}
{'eval_loss': 1.408134937286377, 'eval_runtime': 23.925, 'eval_samples_per_second': 1.964, 'eval_steps_per_second': 1.003, 'epoch': 4.97}

[ValidationCERCallback] Computing CER on 47 validation samples...

[ValidationCERCallback] Epoch 4.97 CER: 0.2517 (25.17%)
[ValidationCERCallback] No improvement. Best CER remains 0.2338
{'train_runtime': 7757.7236, 'train_samples_per_second': 0.549, 'train_steps_per_second': 0.067, 'train_loss': 0.31450581275499784, 'epoch': 4.97}
7757.7236 seconds used for training.
129.3 minutes used for training.
Peak reserved memory = 10.062 GB.
Peak reserved memory for training = 0.431 GB.
Peak reserved memory % of max memory = 31.708 %.
Peak reserved memory for training % of max memory = 1.358 %.

[train_model] Best CER model saved at /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251104_040019/best_model_cer (CER=0.2338).
Saving final trainer model to /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251104_040019...
Final trainer model saved. Best-CER model (if found) is under: /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251104_040019/best_model_cer

============================================================
STARTING EVALUATION ON TEST.JSONL (USING IN-MEMORY MODEL)
============================================================
Starting evaluation on test.jsonl...
Loaded 48 test samples
Processing test image 1/48: inventarbuch-022.jpg
  Processed successfully. CER: 0.259
Processing test image 2/48: inventarbuch-099.jpg
  Processed successfully. CER: 0.161
Processing test image 3/48: inventarbuch-245.jpg
  Processed successfully. CER: 0.290
Processing test image 4/48: inventarbuch-263.jpg
  Processed successfully. CER: 0.187
Processing test image 5/48: inventarbuch-033.jpg
  Processed successfully. CER: 0.330
Processing test image 6/48: inventarbuch-143.jpg
  Processed successfully. CER: 0.140
Processing test image 7/48: inventarbuch-244.jpg
  Processed successfully. CER: 0.455
Processing test image 8/48: inventarbuch-024.jpg
  Processed successfully. CER: 0.070
Processing test image 9/48: inventarbuch-141.jpg
  Processed successfully. CER: 0.118
Processing test image 10/48: inventarbuch-183.jpg
  Processed successfully. CER: 0.469
Processing test image 11/48: inventarbuch-191.jpg
  Processed successfully. CER: 0.239
Processing test image 12/48: inventarbuch-051.jpg
  Processed successfully. CER: 0.065
Processing test image 13/48: inventarbuch-203.jpg
  Processed successfully. CER: 0.175
Processing test image 14/48: inventarbuch-296.jpg
  Processed successfully. CER: 0.427
Processing test image 15/48: inventarbuch-302.jpg
  Processed successfully. CER: 0.024
Processing test image 16/48: inventarbuch-179.jpg
  Processed successfully. CER: 0.232
Processing test image 17/48: inventarbuch-114.jpg
  Processed successfully. CER: 0.245
Processing test image 18/48: inventarbuch-082.jpg
  Processed successfully. CER: 0.285
Processing test image 19/48: inventarbuch-287.jpg
  Processed successfully. CER: 0.352
Processing test image 20/48: inventarbuch-181.jpg
  Processed successfully. CER: 0.265
Processing test image 21/48: inventarbuch-299.jpg
  Processed successfully. CER: 0.270
Processing test image 22/48: inventarbuch-084.jpg
  Processed successfully. CER: 0.399
Processing test image 23/48: inventarbuch-004.jpg
  Processed successfully. CER: 0.176
Processing test image 24/48: inventarbuch-148.jpg
  Processed successfully. CER: 0.093
Processing test image 25/48: inventarbuch-238.jpg
  Processed successfully. CER: 0.261
Processing test image 26/48: inventarbuch-116.jpg
  Processed successfully. CER: 0.148
Processing test image 27/48: inventarbuch-223.jpg
  Processed successfully. CER: 0.186
Processing test image 28/48: inventarbuch-104.jpg
  Processed successfully. CER: 0.282
Processing test image 29/48: inventarbuch-015.jpg
  Processed successfully. CER: 0.209
Processing test image 30/48: inventarbuch-272.jpg
  Processed successfully. CER: 0.221
Processing test image 31/48: inventarbuch-124.jpg
  Processed successfully. CER: 0.158
Processing test image 32/48: inventarbuch-115.jpg
  Processed successfully. CER: 1.000
Processing test image 33/48: inventarbuch-049.jpg
  Processed successfully. CER: 0.022
Processing test image 34/48: inventarbuch-017.jpg
  Processed successfully. CER: 0.052
Processing test image 35/48: inventarbuch-018.jpg
  Processed successfully. CER: 0.204
Processing test image 36/48: inventarbuch-225.jpg
  Processed successfully. CER: 0.388
Processing test image 37/48: inventarbuch-046.jpg
  Processed successfully. CER: 0.264
Processing test image 38/48: inventarbuch-294.jpg
  Processed successfully. CER: 0.161
Processing test image 39/48: inventarbuch-054.jpg
  Processed successfully. CER: 0.328
Processing test image 40/48: inventarbuch-073.jpg
  Processed successfully. CER: 0.327
Processing test image 41/48: inventarbuch-118.jpg
  Processed successfully. CER: 0.213
Processing test image 42/48: inventarbuch-130.jpg
  Processed successfully. CER: 0.195
Processing test image 43/48: inventarbuch-146.jpg
  Processed successfully. CER: 0.245
Processing test image 44/48: inventarbuch-014.jpg
  Processed successfully. CER: 0.255
Processing test image 45/48: inventarbuch-059.jpg
  Processed successfully. CER: 0.223
Processing test image 46/48: inventarbuch-256.jpg
  Processed successfully. CER: 0.149
Processing test image 47/48: inventarbuch-260.jpg
  Processed successfully. CER: 0.202
Processing test image 48/48: inventarbuch-279.jpg
  Processed successfully. CER: 0.274
CER evaluation results saved to: /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251104_040019/cer_evaluation_results.txt

Evaluation completed!
Predictions saved to: /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251104_040019/test_predictions.jsonl
CER results saved to: /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251104_040019/cer_evaluation_results.txt
All files saved in: /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251104_040019

============================================================
FINAL RESULTS SUMMARY
============================================================
Average CER: 0.2436 (24.36%)
Median CER: 0.2271 (22.71%)
Perfect matches: 0/48 (0.00%)
Total images processed: 48

Training and evaluation completed successfully!
All outputs saved to: /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251104_040019
=== JOB_STATISTICS ===
=== current date     : Tue Nov  4 07:05:00 AM CET 2025
= Job-ID             : 1296183 on tinygpu
= Job-Name           : qwen_inven_ms
= Job-Command        : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles/job_qwen.sh
= Initial workdir    : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles
= Queue/Partition    : v100
= Slurm account      : iwi5 with QOS=normal
= Requested resources:  for 1-00:00:00
= Elapsed runtime    : 03:34:37
= Total RAM usage    : 17.4 GiB of requested  GiB (%)   
= Node list          : tg071
= Subm/Elig/Start/End: 2025-11-04T03:29:56 / 2025-11-04T03:29:56 / 2025-11-04T03:29:57 / 2025-11-04T07:04:34
======================
=== Quota infos ======
    Path                 Used     SoftQ    HardQ    Gracetime  Filec    FileQ    FiHaQ    FileGrace    
    /home/hpc             102.1G   104.9G   209.7G        N/A  30,563      500K   1,000K        N/A    
    /home/woody           184.1G  1000.0G  1500.0G        N/A     841K   5,000K   7,500K        N/A    
    /home/vault           871.9G  1048.6G  2097.2G        N/A   5,160      200K     400K        N/A    
======================
=== GPU utilization ==
gpu_name, gpu_bus_id, pid, gpu_utilization [%], mem_utilization [%], max_memory_usage [MiB], time [ms]
Tesla V100-PCIE-32GB, 00000000:18:00.0, 1790369, 93 %, 32 %, 8298 MiB, 86339696 ms
Tesla V100-PCIE-32GB, 00000000:18:00.0, 2265230, 25 %, 11 %, 10714 MiB, 12499681 ms
