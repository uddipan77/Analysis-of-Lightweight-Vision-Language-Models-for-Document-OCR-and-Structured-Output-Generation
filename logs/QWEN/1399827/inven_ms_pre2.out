### Starting TaskPrologue of job 1399827 on tg071 at Wed Nov 19 07:44:31 PM CET 2025
Running on cores 6-7,14-15,22-23,30-31 with governor ondemand
Wed Nov 19 19:44:31 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.195.03             Driver Version: 570.195.03     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-PCIE-32GB           Off |   00000000:AF:00.0 Off |                    0 |
| N/A   30C    P0             25W /  250W |       0MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
### Finished TaskPrologue

ðŸ¦¥ Unsloth: Will patch your computer to enable 2x faster free finetuning.
ðŸ¦¥ Unsloth Zoo will now patch everything to make training faster!
Created run directory: /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251119_194512
Loading Qwen2.5-VL model with Unsloth...
Unsloth: WARNING `trust_remote_code` is True.
Are you certain you want to do remote code execution?
==((====))==  Unsloth 2025.7.3: Fast Qwen2_5_Vl patching. Transformers: 4.51.3.
   \\   /|    Tesla V100-PCIE-32GB. Num GPUs = 1. Max memory: 31.733 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.7.1+cu126. CUDA: 7.0. CUDA Toolkit: 12.6. Triton: 3.3.1
\        /    Bfloat16 = FALSE. FA [Xformers = 0.0.31.post1. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: Qwen2_5_Vl does not support SDPA - switching to eager!
Unsloth: Making `model.base_model.model.visual` require gradients
Model loaded successfully with optimized LoRA adapters!
============================================================
STARTING MULTI-STAGE TRAINING WITH TEACHER FORCING + CER SELECTION (PREPROCESSED)
============================================================
Preparing training and validation datasets...
Training: 213 samples, Validation: 47 samples

===== STAGE 1: Warm-up training (no eval, teacher forcing) =====

Unsloth: Model does not have a default image size - using 512
Unsloth: Will smartly offload gradients to save VRAM!
{'loss': 4.467, 'grad_norm': 18.031021118164062, 'learning_rate': 3.6000000000000003e-06, 'epoch': 0.37}
{'loss': 3.8076, 'grad_norm': 26.766536712646484, 'learning_rate': 1.3200000000000002e-05, 'epoch': 0.75}
{'loss': 2.8376, 'grad_norm': 6.779544830322266, 'learning_rate': 2.5200000000000003e-05, 'epoch': 1.15}
{'loss': 1.8139, 'grad_norm': 5.792287349700928, 'learning_rate': 3.72e-05, 'epoch': 1.52}
{'loss': 1.6419, 'grad_norm': 120.80255889892578, 'learning_rate': 4.800000000000001e-05, 'epoch': 1.9}
{'loss': 1.4042, 'grad_norm': 3.6155128479003906, 'learning_rate': 6.000000000000001e-05, 'epoch': 2.3}
{'loss': 1.259, 'grad_norm': 8.399311065673828, 'learning_rate': 5.771638597533861e-05, 'epoch': 2.67}
{'loss': 1.3317, 'grad_norm': 2.6265499591827393, 'learning_rate': 5.121320343559643e-05, 'epoch': 3.07}
{'loss': 1.0157, 'grad_norm': 3.765831708908081, 'learning_rate': 4.14805029709527e-05, 'epoch': 3.45}
{'loss': 1.0627, 'grad_norm': 4.762628555297852, 'learning_rate': 3.0000000000000004e-05, 'epoch': 3.82}
{'loss': 0.9438, 'grad_norm': 3.1380956172943115, 'learning_rate': 1.851949702904731e-05, 'epoch': 4.22}
{'loss': 0.8339, 'grad_norm': 4.167435169219971, 'learning_rate': 8.786796564403577e-06, 'epoch': 4.6}
{'loss': 0.8013, 'grad_norm': 3.138981819152832, 'learning_rate': 2.283614024661398e-06, 'epoch': 4.97}
{'train_runtime': 1690.8243, 'train_samples_per_second': 0.63, 'train_steps_per_second': 0.077, 'train_loss': 1.7861689127408542, 'epoch': 4.97}

===== STAGE 2: Main training (eval each epoch, CER-based best model) =====

Unsloth: Model does not have a default image size - using 512
GPU = Tesla V100-PCIE-32GB. Max memory = 31.733 GB.
9.996 GB of memory reserved.
{'loss': 0.6948, 'grad_norm': nan, 'learning_rate': 2.0000000000000003e-06, 'epoch': 0.37}
{'loss': 0.734, 'grad_norm': 4.710355758666992, 'learning_rate': 5.600000000000001e-06, 'epoch': 0.75}
{'eval_loss': 1.4080133438110352, 'eval_runtime': 24.0003, 'eval_samples_per_second': 1.958, 'eval_steps_per_second': 1.0, 'epoch': 0.97}

[ValidationCERCallback] Computing CER on 47 validation samples...

[ValidationCERCallback] Epoch 0.97 CER: 0.3797 (37.97%)
[ValidationCERCallback] New best CER: 0.3797 (improved by inf)
[ValidationCERCallback] Saving best CER model to /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251119_194512/best_model_cer
{'loss': 0.7702, 'grad_norm': 3.6994636058807373, 'learning_rate': 9.200000000000002e-06, 'epoch': 1.15}
{'loss': 0.6347, 'grad_norm': 3.6897690296173096, 'learning_rate': 1.3200000000000002e-05, 'epoch': 1.52}
{'loss': 0.7181, 'grad_norm': 4.8459930419921875, 'learning_rate': 1.72e-05, 'epoch': 1.9}
{'eval_loss': 1.4431097507476807, 'eval_runtime': 24.8445, 'eval_samples_per_second': 1.892, 'eval_steps_per_second': 0.966, 'epoch': 1.97}

[ValidationCERCallback] Computing CER on 47 validation samples...

[ValidationCERCallback] Epoch 1.97 CER: 0.3981 (39.81%)
[ValidationCERCallback] No improvement. Best CER remains 0.3797
{'loss': 0.5923, 'grad_norm': 4.2305474281311035, 'learning_rate': 1.9999106432103785e-05, 'epoch': 2.3}
{'loss': 0.5498, 'grad_norm': 4.732068061828613, 'learning_rate': 1.9967848320275253e-05, 'epoch': 2.67}
{'eval_loss': 1.5259459018707275, 'eval_runtime': 24.794, 'eval_samples_per_second': 1.896, 'eval_steps_per_second': 0.968, 'epoch': 2.97}

[ValidationCERCallback] Computing CER on 47 validation samples...

[ValidationCERCallback] Epoch 2.97 CER: 0.3792 (37.92%)
[ValidationCERCallback] New best CER: 0.3792 (improved by 0.0005)
[ValidationCERCallback] Saving best CER model to /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251119_194512/best_model_cer
{'loss': 0.586, 'grad_norm': 4.166841506958008, 'learning_rate': 1.9901644327090063e-05, 'epoch': 3.07}
{'loss': 0.3737, 'grad_norm': 4.923120498657227, 'learning_rate': 1.9786084162813735e-05, 'epoch': 3.45}
{'loss': 0.4493, 'grad_norm': 5.352949142456055, 'learning_rate': 1.9626816971058205e-05, 'epoch': 3.82}
{'eval_loss': 1.6021103858947754, 'eval_runtime': 25.0649, 'eval_samples_per_second': 1.875, 'eval_steps_per_second': 0.958, 'epoch': 3.97}

[ValidationCERCallback] Computing CER on 47 validation samples...

[ValidationCERCallback] Epoch 3.97 CER: 0.3693 (36.93%)
[ValidationCERCallback] New best CER: 0.3693 (improved by 0.0099)
[ValidationCERCallback] Saving best CER model to /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251119_194512/best_model_cer
{'loss': 0.3798, 'grad_norm': 6.101163864135742, 'learning_rate': 1.9424554077764548e-05, 'epoch': 4.22}
{'loss': 0.3045, 'grad_norm': 4.516968250274658, 'learning_rate': 1.9180198838114284e-05, 'epoch': 4.6}
{'loss': 0.3279, 'grad_norm': 6.600427627563477, 'learning_rate': 1.8925188358598815e-05, 'epoch': 4.97}
{'eval_loss': 1.7079542875289917, 'eval_runtime': 24.691, 'eval_samples_per_second': 1.904, 'eval_steps_per_second': 0.972, 'epoch': 4.97}

[ValidationCERCallback] Computing CER on 47 validation samples...

[ValidationCERCallback] Epoch 4.97 CER: 0.3952 (39.52%)
[ValidationCERCallback] No improvement. Best CER remains 0.3693
{'loss': 0.2035, 'grad_norm': 7.484851360321045, 'learning_rate': 1.8604015792601395e-05, 'epoch': 5.37}
{'loss': 0.1918, 'grad_norm': 4.67604923248291, 'learning_rate': 1.8244415603417603e-05, 'epoch': 5.75}
{'eval_loss': 1.838883638381958, 'eval_runtime': 23.9202, 'eval_samples_per_second': 1.965, 'eval_steps_per_second': 1.003, 'epoch': 5.97}

[ValidationCERCallback] Computing CER on 47 validation samples...

[ValidationCERCallback] Epoch 5.97 CER: 0.4278 (42.78%)
[ValidationCERCallback] No improvement. Best CER remains 0.3693
{'loss': 0.1736, 'grad_norm': 3.7567617893218994, 'learning_rate': 1.7847993852786612e-05, 'epoch': 6.15}
{'loss': 0.1113, 'grad_norm': 7.096591949462891, 'learning_rate': 1.7416521056479577e-05, 'epoch': 6.52}
{'loss': 0.1249, 'grad_norm': 4.182330131530762, 'learning_rate': 1.6951924276746425e-05, 'epoch': 6.9}
{'eval_loss': 1.9456195831298828, 'eval_runtime': 24.166, 'eval_samples_per_second': 1.945, 'eval_steps_per_second': 0.993, 'epoch': 6.97}

[ValidationCERCallback] Computing CER on 47 validation samples...

[ValidationCERCallback] Epoch 6.97 CER: 0.4110 (41.10%)
[ValidationCERCallback] No improvement. Best CER remains 0.3693
{'train_runtime': 11016.1005, 'train_samples_per_second': 0.387, 'train_steps_per_second': 0.047, 'train_loss': 0.4368230729967683, 'epoch': 6.97}
11016.1005 seconds used for training.
183.6 minutes used for training.
Peak reserved memory = 10.27 GB.
Peak reserved memory for training = 0.274 GB.
Peak reserved memory % of max memory = 32.364 %.
Peak reserved memory for training % of max memory = 0.863 %.

[train_model] Best CER model saved at /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251119_194512/best_model_cer (CER=0.3693).
Saving final trainer model to /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251119_194512...
Final trainer model saved. Best-CER model (if found) is under: /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251119_194512/best_model_cer

============================================================
STARTING EVALUATION ON TEST.JSONL (USING IN-MEMORY MODEL)
============================================================
Starting evaluation on test.jsonl...
Loaded 48 test samples
Processing test image 1/48: inventarbuch-022.jpg
  Processed successfully. CER: 0.438
Processing test image 2/48: inventarbuch-099.jpg
  Processed successfully. CER: 0.178
Processing test image 3/48: inventarbuch-245.jpg
  Processed successfully. CER: 0.345
Processing test image 4/48: inventarbuch-263.jpg
  Processed successfully. CER: 0.295
Processing test image 5/48: inventarbuch-033.jpg
  Processed successfully. CER: 0.472
Processing test image 6/48: inventarbuch-143.jpg
  Processed successfully. CER: 0.334
Processing test image 7/48: inventarbuch-244.jpg
  Processed successfully. CER: 0.428
Processing test image 8/48: inventarbuch-024.jpg
  Processed successfully. CER: 0.169
Processing test image 9/48: inventarbuch-141.jpg
  Processed successfully. CER: 0.229
Processing test image 10/48: inventarbuch-183.jpg
  Processed successfully. CER: 0.448
Processing test image 11/48: inventarbuch-191.jpg
  Processed successfully. CER: 0.326
Processing test image 12/48: inventarbuch-051.jpg
  Processed successfully. CER: 0.412
Processing test image 13/48: inventarbuch-203.jpg
  Processed successfully. CER: 0.330
Processing test image 14/48: inventarbuch-296.jpg
  Processed successfully. CER: 0.521
Processing test image 15/48: inventarbuch-302.jpg
  Processed successfully. CER: 0.165
Processing test image 16/48: inventarbuch-179.jpg
  Processed successfully. CER: 0.338
Processing test image 17/48: inventarbuch-114.jpg
  Processed successfully. CER: 0.411
Processing test image 18/48: inventarbuch-082.jpg
  Processed successfully. CER: 0.422
Processing test image 19/48: inventarbuch-287.jpg
  Processed successfully. CER: 0.526
Processing test image 20/48: inventarbuch-181.jpg
  Processed successfully. CER: 0.528
Processing test image 21/48: inventarbuch-299.jpg
  Processed successfully. CER: 0.370
Processing test image 22/48: inventarbuch-084.jpg
  Processed successfully. CER: 0.510
Processing test image 23/48: inventarbuch-004.jpg
  Processed successfully. CER: 0.394
Processing test image 24/48: inventarbuch-148.jpg
  Processed successfully. CER: 0.176
Processing test image 25/48: inventarbuch-238.jpg
  Processed successfully. CER: 0.380
Processing test image 26/48: inventarbuch-116.jpg
  Processed successfully. CER: 0.708
Processing test image 27/48: inventarbuch-223.jpg
  Processed successfully. CER: 0.363
Processing test image 28/48: inventarbuch-104.jpg
  Processed successfully. CER: 0.371
Processing test image 29/48: inventarbuch-015.jpg
  Processed successfully. CER: 0.370
Processing test image 30/48: inventarbuch-272.jpg
  Processed successfully. CER: 0.322
Processing test image 31/48: inventarbuch-124.jpg
  Processed successfully. CER: 0.264
Processing test image 32/48: inventarbuch-115.jpg
  Processed successfully. CER: 0.437
Processing test image 33/48: inventarbuch-049.jpg
  Processed successfully. CER: 0.116
Processing test image 34/48: inventarbuch-017.jpg
  Processed successfully. CER: 0.883
Processing test image 35/48: inventarbuch-018.jpg
  Processed successfully. CER: 0.249
Processing test image 36/48: inventarbuch-225.jpg
  Processed successfully. CER: 0.479
Processing test image 37/48: inventarbuch-046.jpg
  Processed successfully. CER: 0.364
Processing test image 38/48: inventarbuch-294.jpg
  Processed successfully. CER: 0.313
Processing test image 39/48: inventarbuch-054.jpg
  Processed successfully. CER: 0.457
Processing test image 40/48: inventarbuch-073.jpg
  Processed successfully. CER: 0.603
Processing test image 41/48: inventarbuch-118.jpg
  Processed successfully. CER: 0.415
Processing test image 42/48: inventarbuch-130.jpg
  Processed successfully. CER: 0.275
Processing test image 43/48: inventarbuch-146.jpg
  Processed successfully. CER: 0.461
Processing test image 44/48: inventarbuch-014.jpg
  Processed successfully. CER: 0.383
Processing test image 45/48: inventarbuch-059.jpg
  Processed successfully. CER: 0.419
Processing test image 46/48: inventarbuch-256.jpg
  Processed successfully. CER: 0.273
Processing test image 47/48: inventarbuch-260.jpg
  Processed successfully. CER: 0.274
Processing test image 48/48: inventarbuch-279.jpg
  Processed successfully. CER: 0.554
CER evaluation results saved to: /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251119_194512/cer_evaluation_results.txt

Evaluation completed!
Predictions saved to: /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251119_194512/test_predictions.jsonl
CER results saved to: /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251119_194512/cer_evaluation_results.txt
All files saved in: /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251119_194512

============================================================
FINAL RESULTS SUMMARY
============================================================
Average CER: 0.3854 (38.54%)
Median CER: 0.3756 (37.56%)
Perfect matches: 0/48 (0.00%)
Total images processed: 48

Training and evaluation completed successfully!
All outputs saved to: /home/vault/iwi5/iwi5298h/models_image_text/qwen/multi/inven/run_20251119_194512
=== JOB_STATISTICS ===
=== current date     : Wed Nov 19 11:44:53 PM CET 2025
= Job-ID             : 1399827 on tinygpu
= Job-Name           : qwen_inven_ms2
= Job-Command        : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles/job_qwen.sh
= Initial workdir    : /home/hpc/iwi5/iwi5298h/Uddipan-Thesis/jobfiles
= Queue/Partition    : v100
= Slurm account      : iwi5 with QOS=normal
= Requested resources:  for 1-00:00:00
= Elapsed runtime    : 04:00:22
= Total RAM usage    : 10.1 GiB of requested  GiB (%)   
= Node list          : tg071
= Subm/Elig/Start/End: 2025-11-19T14:51:07 / 2025-11-19T14:51:07 / 2025-11-19T19:44:31 / 2025-11-19T23:44:53
======================
=== Quota infos ======
    Path                 Used     SoftQ    HardQ    Gracetime  Filec    FileQ    FiHaQ    FileGrace    
    /home/woody           188.8G  1000.0G  1500.0G        N/A     872K   5,000K   7,500K        N/A    
!!! /home/hpc             109.1G   104.9G   209.7G  -29293days  31,769      500K   1,000K        N/A !!!
    /home/vault           778.9G  1048.6G  2097.2G        N/A   6,506      200K     400K        N/A    
======================
=== GPU utilization ==
gpu_name, gpu_bus_id, pid, gpu_utilization [%], mem_utilization [%], max_memory_usage [MiB], time [ms]
Tesla V100-PCIE-32GB, 00000000:AF:00.0, 2247357, 36 %, 15 %, 10926 MiB, 14409665 ms
